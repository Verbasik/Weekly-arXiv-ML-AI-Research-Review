# –ì—Ä—É–ø–ø–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–ª–∏—Ç–∏–∫ –≤ –æ–±—É—á–µ–Ω–∏–∏ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º: GSPO vs GRPO

---

### **TWRB_FM üìª**

<audio controls>
  <source src="https://github.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/raw/refs/heads/develop/2025/week-32/TWRB_FM.wav" type="audio/mpeg">
  –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ—ç–ª–µ–º–µ–Ω—Ç.
</audio>

---

**Group Relative Policy Optimization (GRPO)** –∏ **Group Sequence Policy Optimization (GSPO)** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –¥–≤–∞ –ø–µ—Ä–µ–¥–æ–≤—ã—Ö –ø–æ–¥—Ö–æ–¥–∞ –∫ –æ–±—É—á–µ–Ω–∏—é —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ—à–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ —á–µ—Ä–µ–∑ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏. GRPO, –≤–ø–µ—Ä–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–º–∞–Ω–¥–æ–π DeepSeek –≤ —Ñ–µ–≤—Ä–∞–ª–µ 2024 –≥–æ–¥–∞, –ø—Ä–æ–∏–∑–≤–µ–ª —Ä–µ–≤–æ–ª—é—Ü–∏—é –≤ –æ–±–ª–∞—Å—Ç–∏ –ø—É—Ç–µ–º –∑–∞–º–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–µ—Ç–∏ –≥—Ä—É–ø–ø–æ–≤–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞–≥—Ä–∞–¥. GSPO, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –∫–æ–º–∞–Ω–¥–æ–π Qwen –≤ –∏—é–ª–µ 2025 –≥–æ–¥–∞, —Ä–∞–∑–≤–∏–ª —ç—Ç–∏ –∏–¥–µ–∏ –¥–∞–ª—å—à–µ, –ø–µ—Ä–µ–π–¥—è –æ—Ç —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤–æ–π –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-—É—Ä–æ–≤–Ω–µ–≤–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ—à–∏–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è Mixture-of-Experts –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä.

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è: GRPO —Å–æ–∫—Ä–∞—â–∞–µ—Ç –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–∞ 50% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å PPO –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ GSPO –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –Ω–∞ 200% –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å MoE –º–æ–¥–µ–ª—è–º–∏. –û–±–∞ –º–µ—Ç–æ–¥–∞ –ø–æ–∫–∞–∑–∞–ª–∏ –≤—ã–¥–∞—é—â–∏–µ—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è—Ö - DeepSeekMath —Å GRPO –¥–æ—Å—Ç–∏–≥ 51.7% –Ω–∞ MATH benchmark, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ Qwen3 —Å GSPO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –µ—â–µ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è.

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã GRPO: –∑–∞–º–µ–Ω–∞ –∫—Ä–∏—Ç–∏–∫–∞ –≥—Ä—É–ø–ø–æ–≤—ã–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º

Group Relative Policy Optimization –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–¥–≤–∏–≥ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ policy gradient –º–µ—Ç–æ–¥–æ–≤, **—É—Å—Ç—Ä–∞–Ω—è—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π value network** —á–µ—Ä–µ–∑ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –≥—Ä—É–ø–ø–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥. –ú–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç clipped surrogate objective, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π PPO, –Ω–æ —Å –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –∏–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤.

–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ GRPO –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:

$$J_{GRPO}(\theta) = \mathbb{E}_{q \sim P(Q), \{o_i\}_{i=1}^G \sim \pi_{\theta_{old}}(O|q)} \left[\frac{1}{G} \sum_{i=1}^G \frac{1}{|o_i|} \sum_{t=1}^{|o_i|} \min\left[\frac{\pi_\theta(o_{i,t}|q,o_{i,<t})}{\pi_{\theta_{old}}(o_{i,t}|q,o_{i,<t})} \cdot \hat{A}_{i,t}, \text{clip}\left(\frac{\pi_\theta(o_{i,t}|q,o_{i,<t})}{\pi_{\theta_{old}}(o_{i,t}|q,o_{i,<t})}, 1-\epsilon, 1+\epsilon\right) \cdot \hat{A}_{i,t}\right]\right] - \beta \cdot D_{KL}[\pi_\theta \parallel \pi_{ref}]$$

<details> 
    <summary><em><strong>–ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</strong></em></summary>

–≥–¥–µ:
- **$J_{GRPO}(\theta)$** ‚Äî —Ü–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (objective function), –∫–æ—Ç–æ—Ä—É—é –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–∏—Ç–∏–∫–∏.
- **$\theta$** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã **—Ç–µ–∫—É—â–µ–π –ø–æ–ª–∏—Ç–∏–∫–∏** (–Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏), –∫–æ—Ç–æ—Ä—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è.
- **$\theta_{old}$** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã **—Å—Ç–∞—Ä–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏**, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤).
- **$q$** ‚Äî –≤—Ö–æ–¥–Ω–æ–π –ø—Ä–æ–º–ø—Ç (query), –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –æ—Ç–≤–µ—Ç—ã.
- **$\mathbb{E}_{...}$** ‚Äî –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ, –≤–∑—è—Ç–æ–µ –ø–æ –ø—Ä–æ–º–ø—Ç–∞–º –∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ –≥—Ä—É–ø–ø–∞–º –æ—Ç–≤–µ—Ç–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π.
- **$G$** ‚Äî —Ä–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø—ã, —Ç.–µ. –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ $q$.
- **$\{o_i\}_{i=1}^G$** ‚Äî –≥—Ä—É–ø–ø–∞ –∏–∑ $G$ –æ—Ç–≤–µ—Ç–æ–≤ (outputs), —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–æ–º–ø—Ç $q$.
- **$o_{i,t}$** ‚Äî $t$-–π —Ç–æ–∫–µ–Ω –≤ $i$-–º –æ—Ç–≤–µ—Ç–µ.
- **$|o_i|$** ‚Äî –¥–ª–∏–Ω–∞ $i$-–≥–æ –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–æ–∫–µ–Ω–∞—Ö.
- **$\pi_\theta(o_{i,t}|q,o_{i,<t})$** ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞ $o_{i,t}$ **—Ç–µ–∫—É—â–µ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π** $\pi_\theta$ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ –ø—Ä–æ–º–ø—Ç–∞ $q$ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ $o_{i,<t}$.
- **$\pi_{\theta_{old}}(...)$** ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, –Ω–æ –¥–ª—è **—Å—Ç–∞—Ä–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏** $\pi_{\theta_{old}}$.
- **$\frac{\pi_\theta}{\pi_{\theta_{old}}}$** ‚Äî **–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ (importance weighting)** –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–æ–∫–µ–Ω–∞. –û–Ω –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, –ø–æ–∑–≤–æ–ª—è—è –æ–±—É—á–∞—Ç—å –Ω–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä–æ–π.
- **$\hat{A}_{i,t}$** ‚Äî **–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ (advantage)**, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω–æ–µ $t$-–º—É —Ç–æ–∫–µ–Ω—É –≤ $i$-–º –æ—Ç–≤–µ—Ç–µ. –í GRPO —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤ –æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–≤–Ω–æ $\hat{A}_i$.
- **$\text{clip}(...)$** ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç—Å–µ—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º $[1-\epsilon, 1+\epsilon]$, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏.
- **$\epsilon$** ‚Äî –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä –∫–ª–∏–ø–ø–∏–Ω–≥–∞ (—Ç–∏–ø–∏—á–Ω–æ 0.1‚Äì0.2).
- **$\beta$** ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç, —Ä–µ–≥—É–ª–∏—Ä—É—é—â–∏–π —Å–∏–ª—É KL-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏.
- **$D_{KL}[\pi_\theta \parallel \pi_{ref}]$** ‚Äî KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –∏ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π.

</details> 

---

–ö–ª—é—á–µ–≤–∞—è –∏–Ω–Ω–æ–≤–∞—Ü–∏—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ **–≥—Ä—É–ø–ø–æ–≤–æ–π –æ—Ü–µ–Ω–∫–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤**, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —Ü–µ–Ω–Ω–æ—Å—Ç–∏:

$$\hat{A}_i = \frac{r_i - \text{mean}(\{r_1, r_2, \ldots, r_G\})}{\text{std}(\{r_1, r_2, \ldots, r_G\})}$$

<details> 
    <summary><em><strong>–ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</strong></em></summary>
–≥–¥–µ:
- **$\hat{A}_i$** ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –¥–ª—è $i$-–≥–æ –æ—Ç–≤–µ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ $i$-–π –æ—Ç–≤–µ—Ç –ª—É—á—à–µ –∏–ª–∏ —Ö—É–∂–µ "—Å—Ä–µ–¥–Ω–µ–≥–æ" –æ—Ç–≤–µ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ.
- **$r_i$** ‚Äî –Ω–∞–≥—Ä–∞–¥–∞ (reward) –¥–ª—è $i$-–≥–æ –æ—Ç–≤–µ—Ç–∞, –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –æ—Ç –≤–Ω–µ—à–Ω–µ–π –º–æ–¥–µ–ª–∏-–æ—Ü–µ–Ω—â–∏–∫–∞ (reward model).
- **$\{r_1, r_2, \ldots, r_G\}$** ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–∞–≥—Ä–∞–¥ –¥–ª—è –≤—Å–µ—Ö $G$ –æ—Ç–≤–µ—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø–µ.
- **$\text{mean}(\{...\})$** ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–≥—Ä–∞–¥ –ø–æ –≤—Å–µ–π –≥—Ä—É–ø–ø–µ. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª—É–∂–∏—Ç **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–µ–π (baseline)**, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–º–µ–Ω—è–µ—Ç –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Ç–∏ –∫—Ä–∏—Ç–∏–∫–∞ (value network).
- **$\text{std}(\{...\})$** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥ –ø–æ –≥—Ä—É–ø–ø–µ. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —ç—Ç—É –≤–µ–ª–∏—á–∏–Ω—É —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ –¥–µ–ª–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∫ –º–∞—Å—à—Ç–∞–±—É –Ω–∞–≥—Ä–∞–¥.
</details> 

---

–≥–¥–µ G –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø—ã (–æ–±—ã—á–Ω–æ 32-64 –æ—Ç–≤–µ—Ç–∞), –∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—é –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –≠—Ç–∞ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º —Å–Ω–∏–∂–µ–Ω–∏—è –¥–∏—Å–ø–µ—Ä—Å–∏–∏: –≥—Ä—É–ø–ø–æ–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ —Å–ª—É–∂–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–µ–π, –∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –Ω–∞–≥—Ä–∞–¥.

–ê–ª–≥–æ—Ä–∏—Ç–º GRPO —Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ q –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≥—Ä—É–ø–ø–∞ –∏–∑ G –æ—Ç–≤–µ—Ç–æ–≤, –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –Ω–∞–≥—Ä–∞–¥—ã —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∫–∏, –∑–∞—Ç–µ–º **—Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞** —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –≤—Å—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è —Å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é:

$$
D_{KL}[\pi_\theta \parallel \pi_{ref}] = \mathbb{E} \left[ \log\frac{\pi_{ref}(o_{i,t}|q,o_{i,<t})}{\pi_\theta(o_{i,t}|q,o_{i,<t})} \right]
$$

<details> 
    <summary><em><strong>–ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</strong></em></summary>

–≥–¥–µ:
- **$D_{KL}[\pi_\theta \parallel \pi_{ref}]$** ‚Äî KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏–∑–º–µ—Ä—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ —Ç–µ–∫—É—â–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ $\pi_\theta$ –æ—Ç–∫–ª–æ–Ω–∏–ª–∞—Å—å –æ—Ç **—Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏** $\pi_{ref}$.
- **$\pi_{ref}$** ‚Äî —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–∞—è –º–æ–¥–µ–ª—å (—á–∞—Å—Ç–æ –∏—Å—Ö–æ–¥–Ω–∞—è SFT-–º–æ–¥–µ–ª—å), –∫–æ—Ç–æ—Ä–∞—è —Å–ª—É–∂–∏—Ç "—è–∫–æ—Ä–µ–º". –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º–æ–π –º–æ–¥–µ–ª–∏ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ –æ—Ç–æ–π—Ç–∏ –æ—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–µ –æ–±—â–∏–µ —è–∑—ã–∫–æ–≤—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å "–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–æ–µ –∑–∞–±—ã–≤–∞–Ω–∏–µ".
</details>

---

–î–∞–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ, —à–∞–≥ –∑–∞ —à–∞–≥–æ–º, —Ä–∞–∑–±–µ—Ä–µ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç GRPO –∏ GSPO –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã –æ–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –¥–∞–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–∏–µ –∏ —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–∞—É—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã.

### –°—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞

*   **–ü—Ä–æ–º–ø—Ç (Query):** `q = "–°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ —Ç–µ–æ—Ä–µ–º—É –ü–∏—Ñ–∞–≥–æ—Ä–∞ –≤ –æ–¥–Ω–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏."`
*   **–†–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø—ã (G):** –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –≤–æ–∑—å–º–µ–º $G = 4$. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞ –æ–¥–∏–Ω –ø—Ä–æ–º–ø—Ç –º–æ–¥–µ–ª—å —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 4 —Ä–∞–∑–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞.
*   **–ü–æ–ª–∏—Ç–∏–∫–∏:**
    *   $\pi_{\theta_{old}}$ ‚Äî "—Å—Ç–∞—Ä–∞—è" –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.
    *   $\pi_{\theta}$ ‚Äî "–Ω–æ–≤–∞—è" –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –æ–±—É—á–∞–µ–º.
*   **–ú–æ–¥–µ–ª—å-–æ—Ü–µ–Ω—â–∏–∫ (Reward Model):** –í–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ —à–∫–∞–ª–µ –æ—Ç 0 –¥–æ 10, –≥–¥–µ 10 ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ.

<details> 
    <summary><em><strong>–ø—Ä–∏–º–µ—Ä</strong></em></summary>

### –ü—Ä–∏–º–µ—Ä ‚Ññ1: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GRPO "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º"

GRPO —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ **—Ç–æ–∫–µ–Ω–æ–≤**. –û–Ω –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â–µ–µ "–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ" –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç –µ–≥–æ –∫ –∫–∞–∂–¥–æ–º—É —Ç–æ–∫–µ–Ω—É –æ—Ç–¥–µ–ª—å–Ω–æ, –≤–∑–≤–µ—à–∏–≤–∞—è –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.

#### **–®–∞–≥ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –∏ –æ—Ü–µ–Ω–∫–∞**

–ù–∞—à–∞ "—Å—Ç–∞—Ä–∞—è" –º–æ–¥–µ–ª—å $\pi_{\theta_{old}}$ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 4 –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–æ–º–ø—Ç. –ú–æ–¥–µ–ª—å-–æ—Ü–µ–Ω—â–∏–∫ –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç –∏–º –Ω–∞–≥—Ä–∞–¥—ã ($r_i$):

1.  $o_1$: "–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–≤–∞–¥—Ä–∞—Ç –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∫–∞—Ç–µ—Ç–æ–≤."
    *   **–ù–∞–≥—Ä–∞–¥–∞ ($r_1$): 10.0** (–ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç)
2.  $o_2$: "–°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –¥–≤—É—Ö —Å—Ç–æ—Ä–æ–Ω —Ä–∞–≤–Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç—É —Ç—Ä–µ—Ç—å–µ–π."
    *   **–ù–∞–≥—Ä–∞–¥–∞ ($r_2$): 6.0** (–ù–µ—Ç–æ—á–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π)
3.  $o_3$: "$a^2 + b^2 = c^2$"
    *   **–ù–∞–≥—Ä–∞–¥–∞ ($r_3$): 8.0** (–¢–æ—á–Ω–æ, –Ω–æ –º–µ–Ω–µ–µ –ø–æ–ª–Ω–æ, —á–µ–º –ø–µ—Ä–≤—ã–π –æ—Ç–≤–µ—Ç)
4.  $o_4$: "–¢–µ–æ—Ä–µ–º–∞ –æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞—Ö."
    *   **–ù–∞–≥—Ä–∞–¥–∞ ($r_4$): 1.0** (–û—á–µ–Ω—å –ø–ª–æ—Ö–æ–π, –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç)

#### **–®–∞–≥ 2: –ì—Ä—É–ø–ø–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ $\hat{A}_i$)**

–¢–µ–ø–µ—Ä—å –∫–ª—é—á–µ–≤–∞—è –∏–Ω–Ω–æ–≤–∞—Ü–∏—è GRPO: –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å "—Ü–µ–Ω–Ω–æ—Å—Ç—å" –æ—Ç–≤–µ—Ç–∞ —Å –ø–æ–º–æ—â—å—é –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (–∫—Ä–∏—Ç–∏–∫–∞), –º—ã —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç —Å–æ —Å—Ä–µ–¥–Ω–∏–º –ø–æ –≥—Ä—É–ø–ø–µ.

*   **–§–æ—Ä–º—É–ª–∞:** $\hat{A}_i = (r_i - \text{mean}(r)) / \text{std}(r)$

1.  **–°—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ (mean):**
    $\text{mean} = (10.0 + 6.0 + 8.0 + 1.0) / 4 = 25.0 / 4 = 6.25$
    *   *–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:* "—Å—Ä–µ–¥–Ω–∏–π" –æ—Ç–≤–µ—Ç –≤ —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ –∏–º–µ–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ 6.25.

2.  **–°—á–∏—Ç–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (std):**
    $\text{std} = \sqrt{((10-6.25)^2 + (6-6.25)^2 + (8-6.25)^2 + (1-6.25)^2)/4} = \sqrt{(14.06 + 0.06 + 3.06 + 27.56)/4} = \sqrt{11.185} \approx 3.34$
    *   *–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:* —ç—Ç–æ –º–µ—Ä–∞ —Ä–∞–∑–±—Ä–æ—Å–∞ –Ω–∞–≥—Ä–∞–¥. –ë–æ–ª—å—à–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ—Ç–≤–µ—Ç—ã –æ—á–µ–Ω—å —Ä–∞–∑–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.

3.  **–í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ ($\hat{A}_i$) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:**
    *   $\hat{A}_1 = (10.0 - 6.25) / 3.34 \approx +1.12$ (–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ)
    *   $\hat{A}_2 = (6.0 - 6.25) / 3.34 \approx -0.07$ (–ß—É—Ç—å —Ö—É–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ)
    *   $\hat{A}_3 = (8.0 - 6.25) / 3.34 \approx +0.52$ (–õ—É—á—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ)
    *   $\hat{A}_4 = (1.0 - 6.25) / 3.34 \approx -1.57$ (–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Ö—É–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ)

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ $\hat{A}$ –±—É–¥–µ—Ç –ø–æ–æ—â—Ä—è—Ç—å –º–æ–¥–µ–ª—å, –∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ ‚Äî –Ω–∞–∫–∞–∑—ã–≤–∞—Ç—å.

#### **–®–∞–≥ 3: –¢–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**

–¢–µ–ø–µ—Ä—å —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ. GRPO "—Ä–∞–∑–±–∏—Ä–∞–µ—Ç" –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–æ–∫–µ–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫ –∫–∞–∂–¥–æ–º—É –∏–∑ –Ω–∏—Ö. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –æ—Ç–≤–µ—Ç $o_1$: "–í", "–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º", "—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ", "...", "–∫–∞—Ç–µ—Ç–æ–≤", ".".

–î–ª—è **–∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞** $o_{1,t}$ –≤ —ç—Ç–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º—ã –¥–µ–ª–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:

1.  **–í—ã—á–∏—Å–ª—è–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ (importance weight):**

    $w_{1,t} = \pi_\theta(o_{1,t} | ...) / \pi_{\theta_{old}}(o_{1,t} | ...)$

    –î–æ–ø—É—Å—Ç–∏–º, –¥–ª—è —Ç–æ–∫–µ–Ω–∞ "–≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã" —Å—Ç–∞—Ä–∞—è –º–æ–¥–µ–ª—å –±—ã–ª–∞ –Ω–µ –æ—á–µ–Ω—å —É–≤–µ—Ä–µ–Ω–∞ –∏ –¥–∞–ª–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å 0.4, –∞ –Ω–æ–≤–∞—è, –æ–±—É—á–∞–µ–º–∞—è –º–æ–¥–µ–ª—å, —Å—Ç–∞–ª–∞ –±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–Ω–æ–π –∏ –¥–∞–ª–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å 0.6.

    $w_{\text{–≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã}} = 0.6 / 0.4 = 1.5$

2.  **–í—ã—á–∏—Å–ª—è–µ–º –≤–∫–ª–∞–¥ —ç—Ç–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤ –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å:**

    $\text{loss\_contribution} = \min(w_{1,t} \cdot \hat{A}_1, \text{clip}(w_{1,t}) \cdot \hat{A}_1)$

    –ò—Å–ø–æ–ª—å–∑—É—è –Ω–∞—à–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ $\hat{A}_1 = +1.12$ –∏ –≤–µ—Å $w = 1.5$:

    $\text{loss\_contribution} = \min(1.5 \cdot 1.12, \text{clip}(1.5, 0.8, 1.2) \cdot 1.12)$

    $\text{loss\_contribution} = \min(1.68, 1.2 \cdot 1.12) = \min(1.68, 1.344) = 1.344$

**–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏–∑–æ—à–ª–æ?**
–ê–ª–≥–æ—Ä–∏—Ç–º —É–≤–∏–¥–µ–ª, —á—Ç–æ –Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ $\pi_\theta$ —Å—Ç–∞–ª–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω "–≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã" —Å –±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é. –ü–æ—Å–∫–æ–ª—å–∫—É –≤—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—ã–ª–∞ "—Ö–æ—Ä–æ—à–µ–π" ($\hat{A}_1 > 0$), —ç—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–æ—â—Ä—è–µ—Ç—Å—è. –ö–ª–∏–ø–ø–∏–Ω–≥ ($\text{clip}$) –Ω–µ –¥–∞–µ—Ç —ç—Ç–æ–º—É –ø–æ–æ—â—Ä–µ–Ω–∏—é –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º, —á—Ç–æ–±—ã –æ–±—É—á–µ–Ω–∏–µ –±—ã–ª–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º.

–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è **–∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤–æ –≤—Å–µ—Ö —á–µ—Ç—ã—Ä–µ—Ö –æ—Ç–≤–µ—Ç–∞—Ö**. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ $\hat{A}_1 = +1.12$ –±—É–¥–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –¥–ª—è –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤ –æ—Ç–≤–µ—Ç–∞ $o_1$, –∞ $\hat{A}_4 = -1.57$ ‚Äî –¥–ª—è –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤ –æ—Ç–≤–µ—Ç–∞ $o_4$.

#### **–ò—Ç–æ–≥ GRPO:**

–ú–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤. –ï—Å–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ü–µ–ª–æ–º –±—ã–ª–∞ —Ö–æ—Ä–æ—à–µ–π ($\hat{A} > 0$), –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å **–∫–∞–∂–¥–æ–≥–æ** –µ–µ —Ç–æ–∫–µ–Ω–∞ –±—É–¥–µ—Ç —É–≤–µ–ª–∏—á–µ–Ω–∞ (–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ $w_t$). –ï—Å–ª–∏ –ø–ª–æ—Ö–æ–π ($\hat{A} < 0$), –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–µ–Ω–∞. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ, –Ω–æ, –∫–∞–∫ –≥–æ–≤–æ—Ä—è—Ç —Ä–µ–±—è—Ç–∞ –∏–∑ Qwen, —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –Ω–µ —Å–æ–≤—Å–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å "—à—É–º".

</details>

---

## –†–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ GSPO: –ø–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-—É—Ä–æ–≤–Ω–µ–≤–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

Group Sequence Policy Optimization –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —ç–≤–æ–ª—é—Ü–∏—é –≥—Ä—É–ø–ø–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤, —Ä–µ—à–∞—è **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ GRPO** —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-—É—Ä–æ–≤–Ω–µ–≤–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –ö–æ–º–∞–Ω–¥–∞ Qwen –≤—ã—è–≤–∏–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ GRPO: —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–µ –≤–∞–∂–Ω–æ—Å—Ç–Ω—ã–µ –≤–µ—Å–∞ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞, —á—Ç–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –≤–Ω–æ—Å–∏—Ç –≤—ã—Å–æ–∫–æ–¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–π —à—É–º.

GSPO –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ü–µ–ª–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é:

$$J_{GSPO}(\theta) = \mathbb{E}_{x \sim D, \{y_i\}_{i=1}^G \sim \pi_{\theta_{old}}(\cdot|x)} \left[\frac{1}{G} \sum_{i=1}^{G} \min(s_i(\theta)\hat{A}_i, \text{clip}(s_i(\theta), 1-\epsilon, 1+\epsilon)\hat{A}_i)\right]$$

<details> 
    <summary><em><strong>–ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</strong></em></summary>

–≥–¥–µ:
- **$J_{GSPO}(\theta)$** ‚Äî —Ü–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è GSPO, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ü–µ–ª—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.
- **$x$** ‚Äî –≤—Ö–æ–¥–Ω–æ–π –ø—Ä–æ–º–ø—Ç (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ $q$ –≤ GRPO).
- **$D$** ‚Äî –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏.
- **$\{y_i\}_{i=1}^G$** ‚Äî –≥—Ä—É–ø–ø–∞ –∏–∑ $G$ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π).
- **$s_i(\theta)$** ‚Äî **–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (sequence-level importance weight)**. –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç GRPO.
- **$\hat{A}_i$** ‚Äî **–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**, –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –≤ GRPO, –Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º–æ–µ –∫–æ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∫ –µ–¥–∏–Ω–æ–º—É —Ü–µ–ª–æ–º—É.
- **$\min(...)$** –∏ **$\text{clip}(...)$** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç—Å–µ—á–µ–Ω–∏—è, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π PPO –∏ GRPO, –Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–π –∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É –≤–∞–∂–Ω–æ—Å—Ç–∏ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $s_i(\theta)$.
</details> 

---

**–ö–ª—é—á–µ–≤–∞—è –∏–Ω–Ω–æ–≤–∞—Ü–∏—è** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –¥–ª–∏–Ω–µ:

$$s_i(\theta) = \left(\frac{\pi_\theta(y_i|x)}{\pi_{\theta_{old}}(y_i|x)}\right)^{1/|y_i|} = \exp\left(\frac{1}{|y_i|} \sum_{t=1}^{|y_i|} \log\left[\frac{\pi_\theta(y_{i,t}|x,y_{i,<t})}{\pi_{\theta_{old}}(y_{i,t}|x,y_{i,<t})}\right]\right)$$

<details> 
    <summary><em><strong>–ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</strong></em></summary>
–≥–¥–µ:
- **$s_i(\theta)$** ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $y_i$ —Ç–µ–∫—É—â–µ–π –∏ —Å—Ç–∞—Ä–æ–π –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏.
- **$\pi_\theta(y_i|x)$** ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ **–≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** $y_i$ —Ç–µ–∫—É—â–µ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤—Å–µ—Ö –µ–µ —Ç–æ–∫–µ–Ω–æ–≤.
- **$\pi_{\theta_{old}}(y_i|x)$** ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞—Ä–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏.
- **$|y_i|$** ‚Äî –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $y_i$ –≤ —Ç–æ–∫–µ–Ω–∞—Ö.
- **$(\cdot)^{1/|y_i|}$** ‚Äî **–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –¥–ª–∏–Ω–µ**. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π, –ø–æ —Å—É—Ç–∏, –≤—ã—á–∏—Å–ª—è–µ—Ç –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π. –û–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏:
    1.  **–°–Ω–∏–∂–∞–µ—Ç –¥–∏—Å–ø–µ—Ä—Å–∏—é**: –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –∏–ª–∏ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è $s_i(\theta)$ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    2.  **–£–Ω–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω**: –ø—Ä–∏–≤–æ–¥–∏—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∫ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º—É —á–∏—Å–ª–æ–≤–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É.
    3.  **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–ª–∏–Ω–Ω—ã–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º (—Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π –≤ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π) –æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –±–æ–ª—å—à–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç.
</details> 

---

–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –¥–ª–∏–Ω–µ —á–µ—Ä–µ–∑ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Å—Ç–µ–ø–µ–Ω–∏ `1/|y_i|` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: —Å–Ω–∏–∂–∞–µ—Ç –¥–∏—Å–ø–µ—Ä—Å–∏—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, —É–Ω–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —á–∏—Å–ª–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –≤–∞–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –Ω–∞–¥ –∫–æ—Ä–æ—Ç–∫–∏–º–∏.

–ì—Ä—É–ø–ø–æ–≤–æ–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º GRPO:

$$\hat{A}_i = \frac{r(x,y_i) - \text{mean}\{r(x,y_i)\}_{i=1}^G}{\text{std}\{r(x,y_i)\}_{i=1}^G}$$

<details> 
    <summary><em><strong>–ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</strong></em></summary>
–≥–¥–µ:
- **$\hat{A}_i$** ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –¥–ª—è $i$-–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- **$r(x, y_i)$** ‚Äî –Ω–∞–≥—Ä–∞–¥–∞ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ $y_i$ –Ω–∞ –ø—Ä–æ–º–ø—Ç $x$.
- **$\text{mean}\{...\}$** –∏ **$\text{std}\{...\}$** ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥ –ø–æ –≥—Ä—É–ø–ø–µ.
- **–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç GRPO**: —Ö–æ—Ç—è —Ñ–æ—Ä–º—É–ª–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞, –∑–¥–µ—Å—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ $\hat{A}_i$ —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –µ–¥–∏–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ $s_i(\theta)$ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –µ–¥–∏–Ω–∏—Ü–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å) –∏ –µ–¥–∏–Ω–∏—Ü–µ–π –Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è (—Ç–∞–∫–∂–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å), —á—Ç–æ **—É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–π —à—É–º** –∏ –¥–µ–ª–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º.
</details> 

---

–ù–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —á—Ç–æ **—É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–π —à—É–º** –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –µ–¥–∏–Ω–∏—Ü–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å) –∏ –µ–¥–∏–Ω–∏—Ü–µ–π –Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è (—Ç–∞–∫–∂–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å).

<details> 
    <summary><em><strong>–ø—Ä–∏–º–µ—Ä</strong></em></summary>

### –ü—Ä–∏–º–µ—Ä ‚Ññ2: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GSPO "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º"

GSPO —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –≥–ª–∞–≤–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É GRPO, –ø–µ—Ä–µ—Ö–æ–¥—è –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ **—Ü–µ–ª—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π**. –≠—Ç–æ –±–æ–ª–µ–µ –ª–æ–≥–∏—á–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞–≥—Ä–∞–¥–∞ –¥–∞–µ—Ç—Å—è –∑–∞ –≤–µ—Å—å –æ—Ç–≤–µ—Ç, –∞ –Ω–µ –∑–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞.

#### **–®–∞–≥–∏ 1 –∏ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è, –æ—Ü–µ–Ω–∫–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**

–≠—Ç–∏ —à–∞–≥–∏ **–∞–±—Å–æ–ª—é—Ç–Ω–æ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã** GRPO. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ –ø—Ä–æ–º–ø—Ç, —Ç–µ –∂–µ 4 –æ—Ç–≤–µ—Ç–∞ –∏ –ø–æ–ª—É—á–∞–µ–º —Ç–µ –∂–µ —Å–∞–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
*   $\hat{A}_1 \approx +1.12$
*   $\hat{A}_2 \approx -0.07$
*   $\hat{A}_3 \approx +0.52$
*   $\hat{A}_4 \approx -1.57$

#### **–®–∞–≥ 3: –ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ ‚Äî –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ($s_i(\theta)$)**

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ, GSPO –≤—ã—á–∏—Å–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

*   **–§–æ—Ä–º—É–ª–∞:** $s_i(\theta) = (\pi_\theta(y_i) / \pi_{\theta_{old}}(y_i))^{1/|y_i|}$

–î–∞–≤–∞–π—Ç–µ —Å–Ω–æ–≤–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞—à –ª—É—á—à–∏–π –æ—Ç–≤–µ—Ç $o_1$ (–≤ GSPO –æ–Ω –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è $y_1$), –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Å—Ç–æ–∏—Ç, —Å–∫–∞–∂–µ–º, –∏–∑ 12 —Ç–æ–∫–µ–Ω–æ–≤ ($|y_1| = 12$).

1.  **–°—á–∏—Ç–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
    *   $\pi_{\theta_{old}}(y_1)$ = P("–í") * P("–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º"|"–í") * ... * P("."|... "–∫–∞—Ç–µ—Ç–æ–≤")
    *   $\pi_\theta(y_1)$ = P_new("–í") * P_new("–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º"|"–í") * ...

    –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏—è –≤—Å–µ—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –º—ã –ø–æ–ª—É—á–∏–ª–∏:
    *   $\pi_{\theta_{old}}(y_1) = 0.00001$
    *   $\pi_\theta(y_1) = 0.00005$ (–ù–æ–≤–∞—è –º–æ–¥–µ–ª—å –≤ —Ü–µ–ª–æ–º –±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–∞ –≤ —ç—Ç–æ–π —Ö–æ—Ä–æ—à–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

2.  **–°—á–∏—Ç–∞–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π:**
    $\text{ratio} = \pi_\theta(y_1) / \pi_{\theta_{old}}(y_1) = 0.00005 / 0.00001 = 5.0$

3.  **–ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–æ –¥–ª–∏–Ω–µ (—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π —à–∞–≥!):**
    $s_1(\theta) = (5.0)^{1/12} \approx 1.14$

**–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏–∑–æ—à–ª–æ?**
–ë–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ –¥–ª–∏–Ω–µ ($^{1/|y_i|}$) –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –º–æ–≥–ª–æ –±—ã —Å—Ç–∞—Ç—å –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ –±–æ–ª—å—à–∏–º –∏–ª–∏ –∏—Å—á–µ–∑–∞—é—â–µ –º–∞–ª—ã–º, –≤—ã–∑—ã–≤–∞—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ —Å—É—Ç–∏, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç $s_i$ –≤ —Ä–∞–∑—É–º–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (—á–∞—Å—Ç–æ –æ–∫–æ–ª–æ 1.0), –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–∞.

#### **–®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ –ø—Ä–æ—Å—Ç—ã–º. –î–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $y_1$ –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –µ–µ –≤–∫–ª–∞–¥ –≤ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å:

$\text{loss\_contribution}_1 = \min(s_1(\theta) \cdot \hat{A}_1, \text{clip}(s_1(\theta)) \cdot \hat{A}_1)$

$\text{loss\_contribution}_1 = \min(1.14 \cdot 1.12, \text{clip}(1.14, 0.8, 1.2) \cdot 1.12)$

$\text{loss\_contribution}_1 = \min(1.2768, 1.14 \cdot 1.12) = 1.2768$ (–ø–æ—Å–∫–æ–ª—å–∫—É 1.14 —É–∂–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–ª–∏–ø–ø–∏–Ω–≥–∞)

–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ 4 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –∏—Å–ø–æ–ª—å–∑—É—è –µ–µ **–µ–¥–∏–Ω—ã–π** –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç $s_i$ –∏ –µ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ $\hat{A}_i$.

#### **–ò—Ç–æ–≥ GSPO:**

–ú–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –µ–¥–∏–Ω—ã–π, —Ü–µ–ª–æ—Å—Ç–Ω—ã–π —Å–∏–≥–Ω–∞–ª –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç $y_i$ –±—ã–ª —Ö–æ—Ä–æ—à–∏–º ($\hat{A}_i > 0$) –∏ –Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ —Å—Ç–∞–ª–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ —Å –±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é ($s_i > 1$), —Ç–æ –≤—Å—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ–æ—â—Ä—è–µ—Ç—Å—è. –≠—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–π —à—É–º –∏ –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑—ã–≤–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—É –∑–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥.

</details>

## –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –º–µ—Ö–∞–Ω–∏–∫–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ **—É—Ä–æ–≤–Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è importance sampling**. GRPO –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è:

$$w_{i,t}^{GRPO}(\theta) = \frac{\pi_\theta(y_{i,t}|x,y_{i,<t})}{\pi_{\theta_{old}}(y_{i,t}|x,y_{i,<t})}$$

—á—Ç–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –Ω–∞ —Ç–æ–∫–µ–Ω –Ω–µ –º–æ–∂–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é importance sampling. GSPO —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É —á–µ—Ä–µ–∑ **—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ importance sampling –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–†–∞–∑–ª–∏—á–∏—è –≤ –∫–ª–∏–ø–ø–∏–Ω–≥–µ —Ç–∞–∫–∂–µ –∫—Ä–∏—Ç–∏—á–Ω—ã: GRPO –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫–ª–∏–ø–ø–∏–Ω–≥ –Ω–∞ –∫–∞–∂–¥–æ–º —Ç–æ–∫–µ–Ω–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é –≤–Ω—É—Ç—Ä–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. GSPO –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–µ–¥–∏–Ω–æ–µ –∫–ª–∏–ø–ø–∏–Ω–≥-–∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏.

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–∞—Ä–∞–¥–æ–∫—Å–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: GSPO –æ—Ç—Å–µ–∫–∞–µ—Ç ~15% –æ—Ç–≤–µ—Ç–æ–≤ –ø—Ä–æ—Ç–∏–≤ ~0.13% —Ç–æ–∫–µ–Ω–æ–≤ –≤ GRPO, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≥–∏–ø–æ—Ç–µ–∑—É –æ —Ç–æ–º, —á—Ç–æ **–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫–ª–∏–ø–ø–∏–Ω–≥ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ** –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, —á–µ–º –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –∫–ª–∏–ø–ø–∏–Ω–≥ –Ω–∞ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–º —É—Ä–æ–≤–Ω–µ.

## –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

–ê–Ω–∞–ª–∏–∑ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã—è–≤–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏. GRPO —Ç—Ä–µ–±—É–µ—Ç –ø–∞–º—è—Ç—å –ø–æ—Ä—è–¥–∫–∞ O(N¬∑T), –≥–¥–µ N - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞, T - –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø–ª—é—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ 15-20% –ø–∞–º—è—Ç–∏ –¥–ª—è Routing Replay –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å MoE –º–æ–¥–µ–ª—è–º–∏. GSPO –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–π –ø–æ –¥–ª–∏–Ω–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ O(N), —á—Ç–æ –¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ª—É—á—à–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.

–î–ª—è **Mixture-of-Experts –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä** —Ä–∞–∑–ª–∏—á–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω—ã. GRPO —Å—Ç—Ä–∞–¥–∞–µ—Ç –æ—Ç –ø—Ä–æ–±–ª–µ–º—ã volatility –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ - —Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–µ –≤–µ—Å–∞ —Å–æ–∑–¥–∞—é—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, —Ç—Ä–µ–±—É—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π —Ç–∏–ø–∞ Routing Replay. GSPO **–Ω–∞—Ç–∏–≤–Ω–æ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç** MoE –æ–±—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-—É—Ä–æ–≤–Ω–µ–≤—ã–µ –≤–µ—Å–∞, —É—Å—Ç—Ä–∞–Ω—è—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö.

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ Qwen3-30B-A3B-Base –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç, —á—Ç–æ GSPO –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ MoE –º–æ–¥–µ–ª–µ–π –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ GRPO —Ç—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö workaround'–æ–≤.

## –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤. **DeepSeekMath —Å GRPO** –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª –ø—Ä–æ—Ä—ã–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è—Ö: GSM8K —É–ª—É—á—à–∏–ª—Å—è —Å 82.9% –¥–æ 88.2%, MATH —Å 46.8% –¥–æ 51.7%. –û—Å–æ–±–µ–Ω–Ω–æ –≤–ø–µ—á–∞—Ç–ª—è—é—â–∏–º —Å—Ç–∞–ª–æ —Å–æ–∑–¥–∞–Ω–∏–µ DeepSeek-R1-Zero - –ø–µ—Ä–≤–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–∞—Å—Å—É–∂–¥–∞—é—â–∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ —á–∏—Å—Ç–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º –±–µ–∑ supervised fine-tuning, –¥–æ—Å—Ç–∏–≥—à–µ–π 71.0% –Ω–∞ AIME 2024.

**Qwen3 —Å GSPO** –ø–æ–∫–∞–∑–∞–ª –µ—â–µ –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –≤ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è - –Ω–∞ 30-40% –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø—Ä–∏ —Ç–æ–º –∂–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–º –±—é–¥–∂–µ—Ç–µ. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ, —á—Ç–æ GSPO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ** –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç GRPO, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å—Ç—Ä–∞–¥–∞—Ç—å –æ—Ç –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏.

–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –≤—ã—è–≤–ª—è–µ—Ç –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑–ª–∏—á–∏—è: GRPO –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ~15-20% —Å–ª—É—á–∞–µ–≤ –∫–æ–ª–ª–∞–ø—Å–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ GSPO –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–µ–Ω–µ–µ 2% —Å–ª—É—á–∞–µ–≤ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏ —Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏

–° —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, –æ–±–∞ –º–µ—Ç–æ–¥–∞ –Ω–∞—Å–ª–µ–¥—É—é—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ PPO –ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —É—Å–ª–æ–≤–∏–π –∫–ª–∏–ø–ø–∏–Ω–≥–∞. –û–¥–Ω–∞–∫–æ **GSPO –æ–±–ª–∞–¥–∞–µ—Ç –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–º–∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è–º–∏** –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º—É –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é importance sampling. –ì—Ä—É–ø–ø–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–∞—Ö –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ - –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –¥–∏—Å–ø–µ—Ä—Å–∏—è –≥—Ä—É–ø–ø–æ–≤–æ–π –æ—Ü–µ–Ω–∫–∏ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é, —É–º–Ω–æ–∂–µ–Ω–Ω—É—é –Ω–∞ (1 - 1/G).

GSPO –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **—Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏** —á–µ—Ä–µ–∑: –¥–ª–∏–Ω–Ω–æ-–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Å–∞, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫; –∫–ª–∏–ø–ø–∏–Ω–≥ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∏—Å–∫–ª—é—á–∞—é—â–∏–π —á—Ä–µ–∑–º–µ—Ä–Ω–æ off-policy –≤—ã–±–æ—Ä–∫–∏; —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤, —É—Å—Ç—Ä–∞–Ω—è—é—â–µ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –∑–∞ –∫—Ä–µ–¥–∏—Ç.

–•–æ—Ç—è —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è GSPO –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ –∫–æ–ª–ª–∞–ø—Å–∞ –º–æ–¥–µ–ª–∏ –¥–∞–∂–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ç—Ä–∏–ª–ª–∏–æ–Ω-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤—ã–º–∏ MoE –º–æ–¥–µ–ª—è–º–∏.

## –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–∑–≤–∏—Ç–∏—è –∏ –≤–∞—Ä–∏–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–æ–≤

–ê–∫—Ç–∏–≤–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤–µ–ª–∏ –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é —É–ª—É—á—à–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤. **GRPO-LEAD** (2024) –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç length-dependent rewards –∏ explicit negative penalties, —É–ª—É—á—à–∞—è –∫—Ä–∞—Ç–∫–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏–π –Ω–∞ 24-26%. **GRPO-CARE** (2025) –¥–æ–±–∞–≤–ª—è–µ—Ç consistency-aware reinforcement learning, –ø–æ–≤—ã—à–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞ 24.5%.

–î–ª—è GSPO —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω **—Ç–æ–∫–µ–Ω-—É—Ä–æ–≤–Ω–µ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç GSPO-token** –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –±–æ–ª–µ–µ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

$$J_{GSPO\text{-}token}(\theta) = \mathbb{E}\left[\frac{1}{G} \sum_{i=1}^{G} \frac{1}{|y_i|} \sum_{t=1}^{|y_i|} \min(s_{i,t}(\theta)\hat{A}_{i,t}, \text{clip}(s_{i,t}(\theta), 1-\epsilon, 1+\epsilon)\hat{A}_{i,t})\right]$$

–≥–¥–µ $s_{i,t}(\theta) = \text{sg}[s_i(\theta)] \cdot \frac{\pi_\theta(y_{i,t}|x,y_{i,<t})}{\text{sg}[\pi_\theta(y_{i,t}|x,y_{i,<t})]}$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç stop-gradient –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.

**–ì–∏–±—Ä–∏–¥–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã** –∏—Å—Å–ª–µ–¥—É—é—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ —Å —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ value-based –ø–æ–¥—Ö–æ–¥–∞–º–∏, –æ–±–µ—â–∞—è –ª—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –º–∏—Ä–æ–≤: —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≥—Ä—É–ø–ø–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏ –±—ã—Å—Ç—Ä—É—é —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å value-based –æ–±—É—á–µ–Ω–∏—è.

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞

–î–ª—è **–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–π** –≤—ã–±–æ—Ä –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π. GRPO —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–æ–¥–µ–ª–µ–π –º–µ–Ω–µ–µ 30B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ dense –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏, –≥–¥–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —à–∏—Ä–æ–∫–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∫–ª—é—á–∞—é—Ç learning rate 1e-6, beta 0.04, epsilon 0.2, –∏ —Ä–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø—ã 8-16.

GSPO —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–º –≤—ã–±–æ—Ä–æ–º –¥–ª—è **MoE –º–æ–¥–µ–ª–µ–π –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞**, –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (>500 —Ç–æ–∫–µ–Ω–æ–≤), –∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∫–ª—é—á–∞—é—Ç –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∫–ª–∏–ø–ø–∏–Ω–≥ (epsilon 3e-4) –∏ sequence-level –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é.

**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞** GSPO –≤–∫–ª—é—á–∞—é—Ç —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ precision discrepancies, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è likelihood –æ—Ç inference engine –±–µ–∑ –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –≤ training engine, –∏ —É–ø—Ä–æ—â–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —á–µ—Ä–µ–∑ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ Routing Replay.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –ø–∞—Ä–∞–¥–∏–≥–º–∞–ª—å–Ω—ã–π —Å–¥–≤–∏–≥ –≤ –æ–±—É—á–µ–Ω–∏–∏ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º

Group Sequence Policy Optimization –∏ Group Relative Policy Optimization –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —ç–≤–æ–ª—é—Ü–∏—é** –≤ –æ–±—É—á–µ–Ω–∏–∏ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º –¥–ª—è –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π. GRPO –∑–∞–ª–æ–∂–∏–ª –æ—Å–Ω–æ–≤—ã –≥—Ä—É–ø–ø–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ—Ç–µ–π. GSPO —Ä–∞–∑–≤–∏–ª —ç—Ç–∏ –∏–¥–µ–∏ –¥–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, —Ä–µ—à–∏–≤ –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥ –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-—É—Ä–æ–≤–Ω–µ–≤–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

–ö–ª—é—á–µ–≤–æ–π –∏–Ω—Å–∞–π—Ç –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ **–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å —É—Ä–æ–≤–Ω–µ–º –Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è** - –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–≥—Ä–∞–¥—ã –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è —Ü–µ–ª—ã–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ. GSPO –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —ç—Ç–æ—Ç –ø—Ä–∏–Ω—Ü–∏–ø, –¥–æ—Å—Ç–∏–≥–∞—è –±–µ—Å–ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ —ç—Ç–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –≤—ã—Ö–æ–¥–∏—Ç –¥–∞–ª–µ–∫–æ –∑–∞ —Ä–∞–º–∫–∏ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π. –£—Å–ø–µ—à–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã - –æ—Ç DeepSeekMath –¥–æ Qwen3 - –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∫ —Ä–µ–∞–ª—å–Ω—ã–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è–º. **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –æ—Å–æ–±–µ–Ω–Ω–æ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç: 50% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ —Å GRPO –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ 30-40% —É–ª—É—á—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å GSPO –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è advanced RL –º–µ—Ç–æ–¥–æ–≤.

–ë—É–¥—É—â–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –Ω–∞ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –º–µ—Ç–æ–¥–∞–º–∏ –ø–æ–∏—Å–∫–∞ –ø–æ –¥–µ—Ä–µ–≤—É –¥–ª—è test-time compute, –∏ —Ä–∞–∑–≤–∏—Ç–∏–∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä—É–ø–ø –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏. –ì—Ä—É–ø–ø–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–∏—Ç–∏–∫ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –Ω–æ–≤—É—é –ø–∞—Ä–∞–¥–∏–≥–º—É –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–∞–∑–≤–∏—Ç–∏–µ –æ–±–ª–∞—Å—Ç–∏ –≤ –±–ª–∏–∂–∞–π—à–∏–µ –≥–æ–¥—ã.