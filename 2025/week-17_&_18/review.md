# **Mamba 2 + Transformer = Nemotron H**

## **–í–≤–µ–¥–µ–Ω–∏–µ**

–ë–æ–ª—å—à–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (LLM) –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö, –Ω–æ –∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞ –æ—Å—Ç–∞—é—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –°–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π Nemotron-H —Ä–µ—à–∞–µ—Ç —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –≥–∏–±—Ä–∏–¥–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã Transformer —Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é —Å–ª–æ–µ–≤ Mamba.

![Figure_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/Figure_01.jpeg)
*–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏–†–∏—Å—É–Ω–æ–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Nemotron-H —Å –¥—Ä—É–≥–∏–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ LLM —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (—Ç–æ–∫–µ–Ω–æ–≤/—Å/GPU) –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ —ç—Ç–∞–ª–æ–Ω–Ω–æ–º —Ç–µ—Å—Ç–µ MMLU. Nemotron-H-56B –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤ 2,4 —Ä–∞–∑–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, —á–µ–º Llama-3.1-70B, –ø—Ä–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö —Ç–æ—á–Ω–æ—Å—Ç–∏.*

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ NVIDIA –º–æ–¥–µ–ª–∏ Nemotron-H —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è—é—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Å–ª–æ–µ–≤ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è –≤ Transformer —Å–ª–æ—è–º–∏ Mamba, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –º–æ–¥–µ–ª—è—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (SSM). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∏ –æ–±—ä–µ–º–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ —Å –¥–ª–∏–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–ª–æ–∏ Mamba –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é –∏ –æ–±—ä–µ–º–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ —Ç–æ–∫–µ–Ω, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

–ö–ª—é—á–µ–≤–æ–µ –Ω–æ–≤—à–µ—Å—Ç–≤–æ Nemotron-H –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–∏—Ö –¥–≤—É—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ä–∞–¥–∏–≥–º –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ—Ç–≤–µ—á–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ LLM –≤ –º–æ–¥–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –±–µ–∑ —É—â–µ—Ä–±–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

# –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Mamba

Mamba ‚Äî —ç—Ç–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π (SSM). –û–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ —Å–µ—Ä—å–µ–∑–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç Transformer. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (RNN) –∏ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (CNN), –¥–æ—Å—Ç–∏–≥–∞—è –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∏–ª–∏ –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Mamba

1. **–ú–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞**  
   - –í–≤–µ–¥–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.  
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ SSM.

2. **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º**  
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.  
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ 3 —Ä–∞–∑ –Ω–∞ GPU A100.

3. **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è**  
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—É—é —Å Transformer.  
   - –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Mamba

Mamba –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã–¥–∞—é—â—É—é—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö:  
- **–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ**:  
  –ú–æ–¥–µ–ª—å Vim, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ Mamba, –≤ 2,8 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ DeiT –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –≤—ã—Å–æ–∫–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –∏ —ç–∫–æ–Ω–æ–º–∏—Ç 86,8% –ø–∞–º—è—Ç–∏ GPU.  
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (NLP)**:  
  –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SSM –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 2‚Äì8 —Ä–∞–∑.
- **–ö–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è (Text-to-Code)**:  
  Mistral —Å–¥–µ–ª–∞–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SSM –º–æ–¥–µ–ª—å Codestral, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –º–µ—Ç—Ä–∏–∫–∞—Ö —Ä–∞–∑–±–∏–ª–∞ –ø–æ—á—Ç–∏ –≤—Å–µ –¥—Ä—É–≥–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–µ–ª–∏. 

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–æ–≥—Ä—É–∑–∏—Ç—Å—è –≤ –≥–ª—É–±–æ–∫–∏–π –æ–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ–π—Å—Ç–µ–π Mamba, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ —Ç–∞–∫–æ–µ RNN, LSTM, CNN, GRU, SSM üëá

<details> 
    <summary><em><strong>–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (RNN)</strong></em></summary>

## 1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è  

### 1.1¬†–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–µ—Ç–∏  
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: —è–∑—ã–∫, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã, –∞—É–¥–∏–æ, –î–ù–ö‚Äë–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.  
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–µ—Ç–∏ —Å—á–∏—Ç–∞—é—Ç –≤—Ö–æ–¥—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏; RNN —Ö—Ä–∞–Ω—è—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ —Å–∫—Ä—ã—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ $h_t$.

### 1.2¬†–ò—Å—Ç–æ—Ä–∏—è   

- **1982¬†–≥.¬†‚Äî Hopfield‚Äë—Å–µ—Ç—å.**  
  –ü–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å —Å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –ø–∞–º—è—Ç–∏‚Äë–∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π. –†–∞–±–æ—Ç–∞ –î–∂.¬†–•–æ–ø—Ñ–∏–ª–¥–∞ —Å—Ç–∞–ª–∞ –ø–µ—Ä–≤–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π —Ç—Ä–µ–Ω–∏—Ä—É–µ–º—ã—Ö —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π –≤ –Ω–µ–π—Ä–æ‚Äë–≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.

- **1986¬†–≥.¬†‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º BPTT (Rumelhart¬†&¬†McClelland).**  
  –ê–≤—Ç–æ—Ä—ã –æ–±–æ–±—â–∏–ª–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π back‚Äëpropagation –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ –≥—Ä–∞—Ñ—ã, —á—Ç–æ –æ—Ç–∫—Ä—ã–ª–æ –ø—É—Ç—å –∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –ö–Ω–∏–≥–∞ *Parallel Distributed Processing* –∑–∞–∫—Ä–µ–ø–∏–ª–∞ –∏–¥–µ—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π.

- **1990¬†–≥.¬†‚Äî ¬´Simple¬†RNN¬ª (Elman).**  
  –î.¬†–≠–ª–º–∞–Ω –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π ¬´–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π¬ª —Å–ª–æ–π —Å–ø–æ—Å–æ–±–µ–Ω –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ. –¢–∞–∫ –ø–æ—è–≤–∏–ª–∞—Å—å –±–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Elman‚Äënet, —Å—Ç–∞–≤—à–∞—è —É—á–µ–±–Ω—ã–º —ç—Ç–∞–ª–æ–Ω–æ–º RNN.

- **1997¬†–≥.¬†‚Äî LSTM (Hochreiter¬†&¬†Schmidhuber).**  
  –í–≤–µ–¥–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –ø–∞–º—è—Ç–∏ –∏ –≤–µ–Ω—Ç–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—à–∏–ª–æ –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, –ø–æ–∑–≤–æ–ª–∏–≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ —Å–æ—Ç–Ω–∏ —à–∞–≥–æ–≤ –Ω–∞–∑–∞–¥. LSTM –≤—Å–∫–æ—Ä–µ —Å—Ç–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–ª—è —Ä–µ—á–∏ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.

- **2014¬†–≥.¬†‚Äî GRU (Cho¬†–∏¬†–¥—Ä.).**  
  –°–æ–∫—Ä–∞—Ç–∏–≤ —á–∏—Å–ª–æ –≤–µ–Ω—Ç–∏–ª–µ–π –¥–æ –¥–≤—É—Ö, GRU –ø—Ä–µ–¥–ª–æ–∂–∏–ª –±–æ–ª–µ–µ –ª—ë–≥–∫—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É LSTM –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏. –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–≤–ø–∞–ª–∞ —Å –±—É–º–æ–º seq2seq‚Äë–º–æ–¥–µ–ª–µ–π –≤ –ø–µ—Ä–µ–≤–æ–¥–µ –∏ –¥–∏–∞–ª–æ–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

- **2020‚Äë–µ¬†‚Äî –≥–∏–±—Ä–∏–¥—ã RNN¬†+¬†Attention (RWKV,¬†S4,¬†Mamba).**  
  –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –ª–∏–Ω–µ–π–Ω—ã–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å–æ —Å–ª–æ–µ–º –≤–Ω–∏–º–∞–Ω–∏—è, –¥–æ—Å—Ç–∏–≥–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –ø—Ä–∏ –ø–∞–º—è—Ç–∏ $O(1)$. –¢–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞.

---

### 2. Simple RNN (–Ø—á–µ–π–∫–∞ –≠–ª–º–∞–Ω–∞): –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

#### 2.1 –ò–Ω—Ç—É–∏—Ü–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–ª–æ–≤–æ –∑–∞ —Å–ª–æ–≤–æ–º. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–æ–≤–∞, –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∞–º–æ —Å–ª–æ–≤–æ, –Ω–æ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–ª–æ–≤. Simple RNN —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º:

*   –ù–∞ –∫–∞–∂–¥–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ $t$ –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:
    1.  **–ù–æ–≤—ã–π –≤—Ö–æ–¥** $x_t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞).
    2.  **–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞** $h_{t-1}$ (–∫–æ–Ω—Ç–µ–∫—Å—Ç, "–ø–∞–º—è—Ç—å").
*   –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –¥–≤—É—Ö –≤—Ö–æ–¥–æ–≤ –æ–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç:
    1.  **–ù–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** $h_t$, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥.
    2.  **–í—ã—Ö–æ–¥** $y_t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞ –∏–ª–∏ –º–µ—Ç–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞).

#### 2.2 –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è

–î–∞–≤–∞–π—Ç–µ –æ–ø–∏—à–µ–º —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏. –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º—Å—è —Å –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤ (–≤–µ–∫—Ç–æ—Ä–æ–≤/–º–∞—Ç—Ä–∏—Ü):

| **–û–±—ä–µ–∫—Ç** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å**        | **–°–º—ã—Å–ª**                                    |
| :--------- | :--------------------- | :------------------------------------------- |
| $x_t$      | $\mathbb{R}^{d_x}$     | –í–µ–∫—Ç–æ—Ä –≤—Ö–æ–¥–∞ –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ $t$            |
| $h_t$      | $\mathbb{R}^{d_h}$     | –í–µ–∫—Ç–æ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –º–æ–º–µ–Ω—Ç $t$       |
| $y_t$      | $\mathbb{R}^{d_y}$     | –í–µ–∫—Ç–æ—Ä –≤—ã—Ö–æ–¥–∞ –º–æ–¥–µ–ª–∏ –≤ –º–æ–º–µ–Ω—Ç $t$            |
| $W_{xh}$   | $\mathbb{R}^{d_x \times d_h}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "–≤—Ö–æ–¥ ‚Üí —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"   |
| $W_{hh}$   | $\mathbb{R}^{d_h \times d_h}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "–ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ" (—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å) |
| $W_{hy}$   | $\mathbb{R}^{d_h \times d_y}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí –≤—ã—Ö–æ–¥" |
| $b_h$      | $\mathbb{R}^{d_h}$     | –í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è            |
| $b_y$      | $\mathbb{R}^{d_y}$     | –í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è           |

> **–ó–∞—á–µ–º —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º–∏?** –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏ –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ —Å broadcast'–∏–Ω–≥–æ–º –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö —Ç–∏–ø–∞ NumPy/PyTorch).

#### 2.3 –î–∏–Ω–∞–º–∏–∫–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞

–¢–µ–ø–µ—Ä—å –∑–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—ã, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç —à–∞–≥–∞ $t-1$ –∫ —à–∞–≥—É $t$:

$$
\boxed{%
\begin{aligned}
h_t &= \sigma_h\!\bigl(W_{xh}x_t + W_{hh}h_{t-1} + b_h\bigr), & h_0&=\mathbf0,\\[4pt]
y_t &= \sigma_y\!\bigl(W_{hy}h_t + b_y\bigr).
\end{aligned}}
$$

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**

1.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$:**
    *   $W_{xh}x_t$: –í–ª–∏—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ö–æ–¥–∞ $x_t$ –Ω–∞ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
    *   $W_{hh}h_{t-1}$: –í–ª–∏—è–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$ (–ø–∞–º—è—Ç–∏) –Ω–∞ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –≠—Ç–æ **–∫–ª—é—á–µ–≤–∞—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å**.
    *   $b_h$: –°–º–µ—â–µ–Ω–∏–µ (bias).
    *   $\sigma_h$: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **tanh** –∏–ª–∏ **—Å–∏–≥–º–æ–∏–¥—É**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ "—Å–∂–∏–º–∞—é—Ç" –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω ([-1, 1] –¥–ª—è tanh, [0, 1] –¥–ª—è —Å–∏–≥–º–æ–∏–¥—ã), —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.
    *   $h_0 = \mathbf{0}$: –ù–∞—á–∏–Ω–∞–µ–º —Å –Ω—É–ª–µ–≤–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

2.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ $y_t$:**
    *   $W_{hy}h_t$: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$ –≤ –≤—ã—Ö–æ–¥–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
    *   $b_y$: –°–º–µ—â–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è.
    *   $\sigma_y$: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è. –ï—ë –≤—ã–±–æ—Ä **–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏**:
        *   `softmax`: –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞/—Å–ª–æ–≤–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è).
        *   `sigmoid`: –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π).
        *   `id` (–ª–∏–Ω–µ–π–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è, —Ç.–µ. –µ—ë –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ): –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è).

![Image_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_01.webp)

**–í–∞–∂–Ω–µ–π—à–∏–π –∞—Å–ø–µ–∫—Ç RNN:** –ú–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤ ($W_{xh}, W_{hh}, W_{hy}$) –∏ –≤–µ–∫—Ç–æ—Ä—ã —Å–º–µ—â–µ–Ω–∏–π ($b_h, b_y$) **–æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –Ω–∞ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–∞—Ö $t$**. –°–µ—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç RNN –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $T$.

---

### 3. –û–±—É—á–µ–Ω–∏–µ RNN: Backpropagation Through Time (BPTT)

–ú—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏, –∫–∞–∫ RNN –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–ø—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥). –ù–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ—ë –≤–µ—Å–∞ $W_{xh}, W_{hh}, W_{hy}, b_h, b_y$, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±—ã–ª–∏ —Ç–æ—á–Ω—ã–º–∏? –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚Äî **Backpropagation Through Time (BPTT)**.

#### 3.1 –ò–¥–µ—è: –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –≤–æ –≤—Ä–µ–º–µ–Ω–∏

–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫, –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å $L$ –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º–æ–¥–µ–ª–∏. –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –≤—ã—Ö–æ–¥ $y_t$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_t$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_{t-1}$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_{t-2}$, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –≤–ø–ª–æ—Ç—å –¥–æ $h_0$. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤—Å–µ $h_k$ (–¥–ª—è $k < t$) –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –≤–µ—Å–æ–≤ $W_{hh}$ –∏ $W_{xh}$.

–ò–¥–µ—è BPTT –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã **–º—ã—Å–ª–µ–Ω–Ω–æ "—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å" RNN –≤–æ –≤—Ä–µ–º–µ–Ω–∏** –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª–∏–Ω–æ–π $T$. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å $T$ –∫–æ–ø–∏–π –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —è—á–µ–π–∫–∏ RNN, —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ. –í—Ö–æ–¥ $x_t$ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_{t-1}$ –ø–æ–¥–∞—é—Ç—Å—è –≤ $t$-—é –∫–æ–ø–∏—é, –æ–Ω–∞ –≤—ã–¥–∞–µ—Ç $h_t$ –∏ $y_t$, –∏ $h_t$ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ $(t+1)$-—é –∫–æ–ø–∏—é.

![Image_02](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_02.png)

–•–æ—Ç—è –º—ã —Å–æ–∑–¥–∞–µ–º $T$ –∫–æ–ø–∏–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å: **–≤–µ—Å–∞ $W_{xh}, W_{hh}, W_{hy}$ –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –∫–æ–ø–∏–π**.

#### 3.2 –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å

–û–±—ã—á–Ω–æ –æ–±—â–∞—è –ø–æ—Ç–µ—Ä—è $L$ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å $\ell$ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

$$
L \;=\;\sum_{t=1}^{T}\,\ell\bigl(y_t,\widehat y_t\bigr),
$$

–≥–¥–µ $y_t$ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —à–∞–≥–µ $t$, –∞ $\widehat y_t$ ‚Äî –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Ü–µ–ª—å) –Ω–∞ —à–∞–≥–µ $t$. –§—É–Ω–∫—Ü–∏—è $\ell$ –º–æ–∂–µ—Ç –±—ã—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–µ–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–æ–π (MSE) –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

#### 3.3 –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (–ü—Ä–∏–º–µ—Ä –¥–ª—è $W_{hh}$)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ–±—â–µ–π –ø–æ—Ç–µ—Ä–∏ $L$ –ø–æ –æ–¥–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É $w$ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã $W_{hh}$. –ò—Å–ø–æ–ª—å–∑—É—è —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –≥—Ä–∞–¥–∏–µ–Ω—Ç $L$ –ø–æ $w$ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –∏–∑ –≤–∫–ª–∞–¥–æ–≤ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —à–∞–≥–∞ $t$:

$$
\frac{\partial L}{\partial w}\;=\; \sum_{t=1}^{T}\,\frac{\partial \ell(y_t, \widehat y_t)}{\partial w}
$$

–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ $\frac{\partial \ell(y_t, \widehat y_t)}{\partial w}$, –Ω–∞–º –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å, –∫–∞–∫ $w$ –≤–ª–∏—è–µ—Ç –Ω–∞ $y_t$. –≠—Ç–æ –≤–ª–∏—è–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$:

$$
\frac{\partial \ell(y_t, \widehat y_t)}{\partial w} = \frac{\partial \ell}{\partial y_t} \frac{\partial y_t}{\partial h_t} \frac{\partial h_t}{\partial w}
$$

–°–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å ‚Äî —ç—Ç–æ $\frac{\partial h_t}{\partial w}$. –°–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $w$ –Ω–∞–ø—Ä—è–º—É—é (—á–µ—Ä–µ–∑ —á–ª–µ–Ω $W_{hh}h_{t-1}$ –≤ —Ñ–æ—Ä–º—É–ª–µ –¥–ª—è $h_t$) –∏ –∫–æ—Å–≤–µ–Ω–Ω–æ, —á–µ—Ä–µ–∑ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}, h_{t-2}, \dots, h_1$, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Ç–æ–∂–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç $w$.

$$
\frac{\partial h_t}{\partial w} = \underbrace{\frac{\partial h_t}{\partial h_{t-1}}\frac{\partial h_{t-1}}{\partial w}}_{\text{—á–µ—Ä–µ–∑ } h_{t-1}} + \underbrace{\frac{\partial h_t}{\partial w}}_{\text{–ø—Ä—è–º–æ–µ –≤–ª–∏—è–Ω–∏–µ}}
$$

–†–∞—Å–∫—Ä—ã–≤–∞—è —ç—Ç—É —Ä–µ–∫—É—Ä—Å–∏—é –¥–∞–ª—å—à–µ, –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è **—Å—É–º–º—É –ø—É—Ç–µ–π** —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ. –ö–∞–∂–¥—ã–π —Ç–∞–∫–æ–π –ø—É—Ç—å –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ø–∫–æ–±–∏–∞–Ω–æ–≤ $\frac{\partial h_k}{\partial h_{k-1}}$.

$$
\frac{\partial h_k}{\partial h_{k-1}} = \frac{\partial}{\partial h_{k-1}} \sigma_h(W_{xh}x_k + W_{hh}h_{k-1} + b_h) = \operatorname{diag}\!\bigl[\sigma_h'(a_k)\bigr]\,W_{hh}
$$
–≥–¥–µ $a_k = W_{xh}x_k + W_{hh}h_{k-1} + b_h$ ‚Äî –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ $\sigma_h$ –Ω–∞ —à–∞–≥–µ $k$. –û–±–æ–∑–Ω–∞—á–∏–º —ç—Ç–æ—Ç –Ø–∫–æ–±–∏–∞–Ω –∫–∞–∫ $J_k$.

–¢–æ–≥–¥–∞ –≤–∫–ª–∞–¥ –≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ—Ç –ø—É—Ç–∏ –¥–ª–∏–Ω–æ–π $k$ (–æ—Ç $h_{t-k}$ –∫ $h_t$) –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ $k$ —Ç–∞–∫–∏—Ö –Ø–∫–æ–±–∏–∞–Ω–æ–≤: $J_t J_{t-1} \dots J_{t-k+1}$.

#### 3.4 –ü—Ä–æ–±–ª–µ–º—ã: –ó–∞—Ç—É—Ö–∞–Ω–∏–µ –∏ –í–∑—Ä—ã–≤ –ì—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤

–ò–º–µ–Ω–Ω–æ —ç—Ç–∏ **–¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ø–∫–æ–±–∏–∞–Ω–æ–≤** $J_k = \operatorname{diag}[\sigma_h'(a_k)] W_{hh}$ —è–≤–ª—è—é—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ RNN:

1.  **–ó–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (Vanishing Gradient):** –ï—Å–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã $W_{hh}$ (–∏–ª–∏ –Ω–æ—Ä–º—ã –Ø–∫–æ–±–∏–∞–Ω–æ–≤ $J_k$) –ø–æ –º–æ–¥—É–ª—é **–º–µ–Ω—å—à–µ 1**, —Ç–æ –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏ –º–Ω–æ–≥–∏—Ö —Ç–∞–∫–∏—Ö –º–∞—Ç—Ä–∏—Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ –Ω—É–ª—é —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ —Å —Ä–æ—Å—Ç–æ–º $k$. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ—Ç –¥–∞–ª–µ–∫–∏—Ö –ø—Ä–æ—à–ª—ã—Ö —à–∞–≥–æ–≤ ($t-k$ –¥–ª—è –±–æ–ª—å—à–∏—Ö $k$) –ø–æ—á—Ç–∏ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ $W_{hh}$, –∏ —Å–µ—Ç—å –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è **–¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º**. Simple RNN –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω—ã —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–µ.
2.  **–í–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (Exploding Gradient):** –ï—Å–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è $W_{hh}$ (–∏–ª–∏ –Ω–æ—Ä–º—ã $J_k$) –ø–æ –º–æ–¥—É–ª—é **–±–æ–ª—å—à–µ 1**, —Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ø–∫–æ–±–∏–∞–Ω–æ–≤ –±—É–¥–µ—Ç —Ä–∞—Å—Ç–∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ–≥—Ä–æ–º–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —à–∞–≥–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—é –æ–±—É—á–µ–Ω–∏—è (NaN/Inf –≤ –ø–æ—Ç–µ—Ä—è—Ö –∏–ª–∏ –≤–µ—Å–∞—Ö).

#### 3.5 –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –†–µ—à–µ–Ω–∏—è

*   **Gradient Clipping:** –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–æ—Ä–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞. –ï—Å–ª–∏ $\|\nabla\theta\| > \tau$ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ä–æ–≥), —Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è: $\nabla\theta \leftarrow \frac{\tau}{\|\nabla\theta\|} \nabla\theta$. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å–æ *–≤–∑—Ä—ã–≤–æ–º*, –Ω–æ –Ω–µ —Å *–∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º*.
*   **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤:** –ù–∞–ø—Ä–∏–º–µ—Ä, –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è $W_{hh}$ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –¥–µ—Ä–∂–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏–º–∏ –∫ 1.
*   **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —è—á–µ–µ–∫:** **LSTM (Long Short-Term Memory)** –∏ **GRU (Gated Recurrent Unit)** –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –±–æ—Ä—å–±—ã —Å –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –û–Ω–∏ –≤–≤–æ–¥—è—Ç "–≤–µ–Ω—Ç–∏–ª–∏" (gates), –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –ø–æ—Ç–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ —è—á–µ–π–∫—É, –ø–æ–∑–≤–æ–ª—è—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ –¥–æ–ª–≥–∏–µ –ø–µ—Ä–∏–æ–¥—ã.
*   **–§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ReLU –º–æ–∂–µ—Ç —É—Å—É–≥—É–±–∏—Ç—å –≤–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, –Ω–æ –º–µ–Ω–µ–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –∑–∞—Ç—É—Ö–∞–Ω–∏—é, —á–µ–º —Å–∏–≥–º–æ–∏–¥–∞/tanh (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ –Ω—É–ª–µ–≤–∞—è). –û–¥–Ω–∞–∫–æ –≤ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —á–∞—Å—Ç–∏ —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç tanh.

---

### 4. BPTT –Ω–∞ –ü—Ä–∞–∫—Ç–∏–∫–µ: –ö–≤–∞–∑–∏-–∫–æ–¥ –∏ PyTorch

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (PyTorch, TensorFlow/Keras) —Ä–µ–∞–ª–∏–∑—É—é—Ç BPTT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í–∞–º –Ω—É–∂–Ω–æ –ª–∏—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É RNN –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (`loss.backward()` –≤ PyTorch).

–í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∏–ø–∏—á–Ω—ã–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BPTT –≤ PyTorch (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `tanh` –∫–∞–∫ $\sigma_h$ –∏ –ª–∏–Ω–µ–π–Ω–æ–π $\sigma_y$):

```python
import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F

# --- –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ) ---
T = 10      # –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
batch_size = 32
d_x = 20    # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞
d_h = 50    # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
d_y = 5     # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–∞

# --- –ú–æ–¥–µ–ª—å (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) ---
W_xh = torch.randn(d_x, d_h, requires_grad=True)
W_hh = torch.randn(d_h, d_h, requires_grad=True)
W_hy = torch.randn(d_h, d_y, requires_grad=True)
b_h  = torch.zeros(d_h, requires_grad=True)
b_y  = torch.zeros(d_y, requires_grad=True)
params = [W_xh, W_hh, W_hy, b_h, b_y]

# --- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö ---
x_sequence = torch.randn(T, batch_size, d_x) # [–í—Ä–µ–º—è, –ë–∞—Ç—á, –ü—Ä–∏–∑–Ω–∞–∫–∏]
y_true_sequence = torch.randn(T, batch_size, d_y)

# --- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ---
optimizer = optim.Adam(params, lr=0.001)

# --- –¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è (–æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è) ---
optimizer.zero_grad()

# == Forward pass (—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –≤—Ä—É—á–Ω—É—é –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏) ==
h_t = torch.zeros(batch_size, d_h) # –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ h_0
outputs = []
for t in range(T):
    # –§–æ—Ä–º—É–ª–∞ Simple RNN
    h_t = torch.tanh(x_sequence[t] @ W_xh + h_t @ W_hh + b_h)
    y_t = h_t @ W_hy + b_y # –õ–∏–Ω–µ–π–Ω—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
    outputs.append(y_t)

# –°–æ–±–∏—Ä–∞–µ–º –≤—ã—Ö–æ–¥—ã –≤ –æ–¥–∏–Ω —Ç–µ–Ω–∑–æ—Ä [T, Batch, d_y]
y_pred_sequence = torch.stack(outputs)

# == –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å ==
# –ü—Ä–∏–º–µ—Ä: MSE –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∑–∞—Ç–µ–º —É—Å—Ä–µ–¥–Ω—è–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –±–∞—Ç—á—É
loss = F.mse_loss(y_pred_sequence, y_true_sequence)

# == Backward pass (BPTT) ==
loss.backward() # PyTorch –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã ‚àÇL/‚àÇparams —á–µ—Ä–µ–∑ BPTT

# == –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Gradient Clipping ==
torch.nn.utils.clip_grad_norm_(params, max_norm=1.0) # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞

# == –®–∞–≥ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ ==
optimizer.step()

print(f"Loss: {loss.item()}")
# print(f"Gradient norm for W_hh: {W_hh.grad.norm().item()}") # –ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

*   PyTorch —Å—Ç—Ä–æ–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ –≤–æ –≤—Ä–µ–º—è forward pass.
*   –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `loss.backward()`, PyTorch –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ —ç—Ç–æ–º—É –≥—Ä–∞—Ñ—É –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –ø—Ä–∏–º–µ–Ω—è—è —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ (—Ä–µ–∞–ª–∏–∑—É—è BPTT) –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`requires_grad=True`), –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤–∏—Å–∏—Ç `loss`.
*   `torch.nn.utils.clip_grad_norm_` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤–∑—Ä—ã–≤–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

---

### 5. –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ BPTT (–¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è)

–ß—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º—ã –ø–æ–Ω–∏–º–∞–µ–º –º–µ—Ö–∞–Ω–∏–∫—É BPTT, –ø–æ–ª–µ–∑–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ "–≤—Ä—É—á–Ω—É—é" (–ø–æ —Ñ–æ—Ä–º—É–ª–∞–º), —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º. –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∞–ª –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–ª—è —ç—Ç–æ–≥–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NumPy –∏ PyTorch. –î–∞–≤–∞–π—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–º –µ–≥–æ —Å—É—Ç—å –∑–¥–µ—Å—å:

```python
import numpy as np
import torch
import torch.nn.functional as F

# --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ---
np.random.seed(0)
torch.manual_seed(0)
T, d_x, d_h, d_y = 4, 3, 2, 1 # –ú–∞–ª–µ–Ω—å–∫–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã

# --- –î–∞–Ω–Ω—ã–µ ---
x = torch.randn(T, d_x, requires_grad=False)
y_true = torch.randn(T, d_y)

# --- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ---
W_xh = torch.randn(d_x, d_h, requires_grad=True)
W_hh = torch.randn(d_h, d_h, requires_grad=True)
W_hy = torch.randn(d_h, d_y, requires_grad=True)
b_h  = torch.zeros(d_h,  requires_grad=True)
b_y  = torch.zeros(d_y,  requires_grad=True)

# --- Forward pass –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å (–∫–∞–∫ –≤ PyTorch) ---
h_prev = torch.zeros(d_h)
h_states = [] # –°–æ—Ö—Ä–∞–Ω–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ backward pass
y_preds = []
loss = 0
for t in range(T):
    h = torch.tanh(x[t] @ W_xh + h_prev @ W_hh + b_h)
    y = h @ W_hy + b_y
    loss += F.mse_loss(y.squeeze(), y_true[t].squeeze()) # –ò—Å–ø–æ–ª—å–∑—É–µ–º MSE
    h_states.append(h)
    y_preds.append(y)
    h_prev = h

# --- Backward pass —Å –ø–æ–º–æ—â—å—é PyTorch (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π BPTT) ---
loss.backward()
W_hh_grad_pytorch = W_hh.grad.clone() # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ—Ç PyTorch

# --- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –†—É—á–Ω–æ–π Backward Pass (—Å–ª–æ–∂–Ω–æ, –Ω–æ –ø–æ—É—á–∏—Ç–µ–ª—å–Ω–æ) ---
# –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –±—ã–ª–æ –±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã BPTT –≤—Ä—É—á–Ω—É—é,
# –ø—Ä–æ—Ö–æ–¥—è –ø–æ —à–∞–≥–∞–º t –æ—Ç T-1 –¥–æ 0 –∏ –∞–∫–∫—É–º—É–ª–∏—Ä—É—è –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è W_hh, W_xh –∏ —Ç.–¥.,
# –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ h_states –∏ —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ.
# –≠—Ç–æ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç—É—Ç–æ—Ä–∏–∞–ª–∞, –Ω–æ –∫–æ–¥ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 6 –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
# –∫–∞–∫ —Ä–∞–∑ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç PyTorch, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã
# —Å—Ä–∞–≤–Ω–∏—Ç—å —Å —Ä—É—á–Ω—ã–º (–µ—Å–ª–∏ –±—ã –æ–Ω –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω).

print(f"–ù–æ—Ä–º–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ ‚àÇL/‚àÇW_hh (PyTorch BPTT): {W_hh_grad_pytorch.norm().item()}")

# --- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã ---
# 1. –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ torch.tanh -> –≥—Ä–∞–¥–∏–µ–Ω—Ç W_hh, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, "–≤–∑–æ—Ä–≤–µ—Ç—Å—è" (—Å—Ç–∞–Ω–µ—Ç –±–æ–ª—å—à–∏–º).
# 2. –ó–∞–º–µ–Ω–∏—Ç–µ torch.tanh –Ω–∞ —Å–ª–∞–±—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, lambda u: 0.1 * u) -> –≥—Ä–∞–¥–∏–µ–Ω—Ç W_hh "–∑–∞—Ç—É—Ö–Ω–µ—Ç" (—Å—Ç–∞–Ω–µ—Ç –º–∞–ª–µ–Ω—å–∫–∏–º).
```

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫–∞–∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –æ–Ω–∏ –∫ –≤—ã–±–æ—Ä—É —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.

---

### 6. –ü—Ä–∏–º–µ—Ä—ã –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è (—Å LSTM/GRU)

–•–æ—Ç—è –º—ã —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ Simple RNN, –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ—ë –±–æ–ª–µ–µ –º–æ—â–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã ‚Äî LSTM –∏ GRU, –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –¥–æ–ª–≥–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏. –ò–¥–µ—è BPTT –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–π –∂–µ, –Ω–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —è—á–µ–π–∫–∏ —Å–ª–æ–∂–Ω–µ–µ.

#### 6.1 –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ (PyTorch + LSTM)

–ó–∞–¥–∞—á–∞: –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–∑—ã–≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º.

```python
import torch
import torch.nn as nn

class SentimentRNN(nn.Module):
    def __init__(self, vocab_size, embedding_dim=128, hidden_dim=256, output_dim=1):
        super().__init__()
        # 1. –°–ª–æ–π —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤: –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã —Å–ª–æ–≤ –≤ –ø–ª–æ—Ç–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã
        self.embedding = nn.Embedding(vocab_size, embedding_dim, padding_idx=0) # padding_idx –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è <pad> —Ç–æ–∫–µ–Ω–æ–≤

        # 2. –°–ª–æ–π LSTM: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
        # batch_first=True –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Ö–æ–¥ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å [–ë–∞—Ç—á, –î–ª–∏–Ω–∞_–ø–æ—Å–ª, –†–∞–∑–º–µ—Ä_—ç–º–±–µ–¥–¥–∏–Ω–≥–∞]
        self.rnn = nn.LSTM(embedding_dim, hidden_dim, num_layers=1,
                           batch_first=True, dropout=0.3 if 1>1 else 0) # Dropout –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ LSTM

        # 3. –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π: –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –≤—ã—Ö–æ–¥
        self.fc = nn.Linear(hidden_dim, output_dim)

        # 4. –°–∏–≥–º–æ–∏–¥–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (0-1)
        self.sigmoid = nn.Sigmoid()

    def forward(self, text_indices): # text_indices: [–ë–∞—Ç—á, –î–ª–∏–Ω–∞_–ø–æ—Å–ª]
        embedded = self.embedding(text_indices) # -> [–ë–∞—Ç—á, –î–ª–∏–Ω–∞_–ø–æ—Å–ª, –†–∞–∑–º–µ—Ä_—ç–º–±–µ–¥–¥–∏–Ω–≥–∞]

        # output —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—ã—Ö–æ–¥—ã LSTM –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ: [–ë–∞—Ç—á, –î–ª–∏–Ω–∞_–ø–æ—Å–ª, –†–∞–∑–º–µ—Ä_—Å–∫—Ä—ã—Ç–æ–≥–æ]
        # hidden —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ h_n: [–ß–∏—Å–ª–æ_—Å–ª–æ–µ–≤, –ë–∞—Ç—á, –†–∞–∑–º–µ—Ä_—Å–∫—Ä—ã—Ç–æ–≥–æ]
        # cell —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ c_n: [–ß–∏—Å–ª–æ_—Å–ª–æ–µ–≤, –ë–∞—Ç—á, –†–∞–∑–º–µ—Ä_—Å–∫—Ä—ã—Ç–æ–≥–æ]
        output, (hidden, cell) = self.rnn(embedded)

        # –ù–∞–º –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ—è
        # hidden[-1] –∏–ª–∏ hidden.squeeze(0) –µ—Å–ª–∏ num_layers=1
        last_hidden_state = hidden.squeeze(0) # -> [–ë–∞—Ç—á, –†–∞–∑–º–µ—Ä_—Å–∫—Ä—ã—Ç–æ–≥–æ]

        # –ü–æ–¥–∞–µ–º –µ–≥–æ –Ω–∞ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π
        logit = self.fc(last_hidden_state) # -> [–ë–∞—Ç—á, 1]

        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–∏–≥–º–æ–∏–¥—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
        probability = self.sigmoid(logit) # -> [–ë–∞—Ç—á, 1]
        return probability

# –í–∞–∂–Ω—ã–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ RNN:
# - Padding: –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º <pad> —Ç–æ–∫–µ–Ω–æ–º –¥–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã –≤ –±–∞—Ç—á–µ.
# - Packing: `torch.nn.utils.rnn.pack_padded_sequence` –ø–æ–∑–≤–æ–ª—è–µ—Ç RNN —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞–¥–¥–∏–Ω–≥–∏.
# - Gradient Clipping: –ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (`clip_grad_norm_`).
# - Dropout: –ü–æ–º–æ–≥–∞–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º.
# - Early Stopping: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—É—á–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –ø–µ—Ä–µ—Å—Ç–∞–µ—Ç —É–ª—É—á—à–∞—Ç—å—Å—è.
```

#### 6.2 –°–∏–º–≤–æ–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (Keras + GRU)

–ó–∞–¥–∞—á–∞: –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Å–∏–º–≤–æ–ª –≤ —Ç–µ–∫—Å—Ç–µ, –æ–±—É—á–∏–≤—à–∏—Å—å –Ω–∞ –±–æ–ª—å—à–æ–º –∫–æ—Ä–ø—É—Å–µ.

```python
import tensorflow as tf
from tensorflow.keras import layers

vocab_size = 100 # –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
embedding_dim = 256
rnn_units = 512

model = tf.keras.Sequential([
    # 1. –≠–º–±–µ–¥–¥–∏–Ω–≥: –ò–Ω–¥–µ–∫—Å —Å–∏–º–≤–æ–ª–∞ -> –í–µ–∫—Ç–æ—Ä
    layers.Embedding(vocab_size, embedding_dim, batch_input_shape=[None, None]), # None –¥–ª—è –±–∞—Ç—á–∞ –∏ –¥–ª–∏–Ω—ã –ø–æ—Å–ª.

    # 2. –°–ª–æ–π GRU (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ LSTM)
    # return_sequences=True: –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –≤—ã—Ö–æ–¥ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ (–Ω—É–∂–Ω–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ—è GRU)
    # stateful=True: –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –±–∞—Ç—á–∞–º–∏ (–ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –Ω–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö)
    layers.GRU(rnn_units, return_sequences=True, stateful=True, recurrent_initializer='glorot_uniform'),

    # 3. –ï—â–µ –æ–¥–∏–Ω —Å–ª–æ–π GRU (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å return_sequences, –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π RNN —Å–ª–æ–π)
    # layers.GRU(rnn_units, stateful=True, recurrent_initializer='glorot_uniform'), # –ï—Å–ª–∏ –±—ã –æ–Ω –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–º

    # 4. –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ GRU –≤ –ª–æ–≥–∏—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ —Å–ª–æ–≤–∞—Ä—è
    layers.Dense(vocab_size) # –ê–∫—Ç–∏–≤–∞—Ü–∏—è softmax –±—É–¥–µ—Ç –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å
])

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–∏
model.compile(optimizer='adam',
              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True)) # –ò—Å–ø–æ–ª—å–∑—É–µ–º Sparse —Ç.–∫. –º–µ—Ç–∫–∏ - –∏–Ω–¥–µ–∫—Å—ã

# –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–∏):
# 1. –ü–æ–ª—É—á–∞–µ–º –ª–æ–≥–∏—Ç—ã z_t –æ—Ç –º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∏–º–≤–æ–ª–∞.
# 2. –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É œÑ: softmax(z_t / œÑ).
#    - –ú–∞–ª–∞—è œÑ (~0.2): –î–µ–ª–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "–æ—Å—Ç—Ä—ã–º", –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã -> –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ç–µ–∫—Å—Ç.
#    - œÑ = 1: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π softmax.
#    - –ë–æ–ª—å—à–∞—è œÑ (~1.0+): –î–µ–ª–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ "–ø–ª–æ—Å–∫–∏–º" -> –±–æ–ª—å—à–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –∏ "–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏".
# 3. –°—ç–º–ø–ª–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Å–∏–º–≤–æ–ª x_{t+1} –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
# 4. –ü–æ–¥–∞–µ–º x_{t+1} –Ω–∞ –≤—Ö–æ–¥ –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞.
```

---

### 7. –ö—É–¥–∞ –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ?

Simple RNN ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è:

| –ü—Ä–æ–±–ª–µ–º–∞                     | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ/–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ                               |
| :--------------------------- | :------------------------------------------------------------- |
| **–î–æ–ª–≥–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**       | LSTM, GRU (–∫–ª–∞—Å—Å–∏–∫–∞); **State-Space Models (SSM)** –∫–∞–∫ S4, Mamba (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ RNN-–ø–æ–¥–æ–±–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã) |
| **–í–∑—Ä—ã–≤/–ó–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞** | Gradient Clipping, LSTM/GRU, –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è          |
| **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**              | RNN –ø–ª–æ—Ö–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑—É—é—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏; **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã** –∑–¥–µ—Å—å –≤—ã–∏–≥—Ä—ã–≤–∞—é—Ç (–Ω–æ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏) |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª.**  | –£—Å–µ—á–µ–Ω–Ω—ã–π BPTT (TBPTT), stateful RNN, LSTM/GRU, SSM, –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã —Å –æ–∫–Ω–æ–º –≤–Ω–∏–º–∞–Ω–∏—è |
| **–ë–æ–ª—å—à–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞** | –ü—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ —Å–ª–æ–∏ –ø–µ—Ä–µ–¥ RNN (—É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $d_x$)     |
| **–ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**      | RNN/LSTM/GRU –∏–¥–µ–∞–ª—å–Ω—ã –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ –æ–¥–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É); CTC Loss, RNN-Transducer –¥–ª—è —Ä–µ—á–∏ |

---

### 8. –í—ã–≤–æ–¥—ã

*   **Simple RNN** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º, –∏—Å–ø–æ–ª—å–∑—É—è **—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ.
*   –ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å ‚Äî **–æ–±—â–∏–µ –≤–µ—Å–∞** –Ω–∞ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–∞—Ö.
*   –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –ø–æ–º–æ—â—å—é **Backpropagation Through Time (BPTT)**, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Å–µ—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ.
*   –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã BPTT ‚Äî **–∑–∞—Ç—É—Ö–∞–Ω–∏–µ –∏ –≤–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤**, –≤—ã–∑–≤–∞–Ω–Ω—ã–µ –¥–ª–∏–Ω–Ω—ã–º–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è–º–∏ –Ø–∫–æ–±–∏–∞–Ω–æ–≤ –ø—Ä–∏ –æ–±—Ä–∞—Ç–Ω–æ–º –ø—Ä–æ—Ö–æ–¥–µ.
*   **LSTM** –∏ **GRU** ‚Äî –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —è—á–µ–π–∫–∏, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–ª—è —Å–º—è–≥—á–µ–Ω–∏—è —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–º–æ—â—å—é **–≤–µ–Ω—Ç–∏–ª—å–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤**.
*   –ü–æ–Ω–∏–º–∞–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ RNN –∏ BPTT –ø–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ–¥ –±–µ–∑ –æ—à–∏–±–æ–∫, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.
*   –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤, RNN-–ø–æ–¥—Ö–æ–¥—ã –æ—Å—Ç–∞—é—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –≤ –∑–∞–¥–∞—á–∞—Ö, –≥–¥–µ –≤–∞–∂–Ω–∞ **–∫–∞—É–∑–∞–ª—å–Ω–æ—Å—Ç—å**, **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –ø–∞–º—è—Ç–∏** –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã—Ö –∏–ª–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (—Å—Ç—Ä–∏–º–∏–Ω–≥), –∏ –≥–¥–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ä–∞–∑—É.

---

## 7. –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–æ–≤–µ—Ç—ã  

| –ó–∞–¥–∞—á–∞ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
|--------|--------------|
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | Orthogonal init, AdamW, clipping $\le 5$ |
| –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è | Dropout, Zoneout, —Ä–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ |
| –î–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | Truncated BPTT, –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ RNN |
| –û–Ω–ª–∞–π–Ω‚ÄëASR | GRU¬†/¬†LSTM¬†+¬†RNN‚ÄëT —Å –∫–∞—É–∑–∞–ª—å–Ω–æ–π –º–∞—Å–∫–æ–π |
| –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è | Integrated Gradients, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è $h_t$ |

---

## 8. –û–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è  

- **NLP**: PoS‚Äëtagging, NER, —á–∞—Ç‚Äë–±–æ—Ç—ã.  
- **–ê—É–¥–∏–æ**: speech‚Äëto‚Äëtext, –º—É–∑—ã–∫–∞.  
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã**: —Å–ø—Ä–æ—Å, IoT‚Äë—Å–µ–Ω—Å–æ—Ä—ã.  
- **–ë–∏–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞**: –≤—Ç–æ—Ä–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –†–ù–ö, —ç–ø–∏–≥–µ–Ω–µ—Ç–∏–∫–∞.

---

## 9. RNN vs¬†Transformer  

| –ö—Ä–∏—Ç–µ—Ä–∏–π | RNN | Transformer |
|----------|-----|-------------|
| –ü–∞–º—è—Ç—å | $O(1)$ | $O(T^2)$ (–æ–±—ã—á–Ω–æ) |
| –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º | –û–≥—Ä–∞–Ω–∏—á–µ–Ω | –í—ã—Å–æ–∫–∏–π |
| –°—Ç—Ä–∏–º–∏–Ω–≥ | –ü—Ä–∏—Ä–æ–¥–Ω—ã–π | –¢—Ä–µ–±—É–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π |

---

## 10. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è  

- **RWKV** ‚Äî –ª–∏–Ω–µ–π–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å, —è–∑—ã–∫–æ–≤—ã–µ –∑–∞–¥–∞—á–∏.  
- **S4, Mamba** ‚Äî state‚Äëspace‚Äë–º–æ–¥–µ–ª–∏, –¥–ª–∏–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã.  
- **Neural ODE** ‚Äî –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –≤—Ä–µ–º—è.

---

## 11. –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è  

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ¬´Simple RNN¬ª –Ω–∞ NumPy –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å PyTorch‚ÄëLSTM.  
2. TBPTT: –≤–ª–∏—è–Ω–∏–µ –¥–ª–∏–Ω—ã —É—Å–µ—á–µ–Ω–∏—è –Ω–∞ perplexity.  
3. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–æ—Ä–º—ã $\lVert h_t\rVert$ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ $\lVert\partial L/\partial h_t\rVert$.  
4. –°—Ä–∞–≤–Ω–∏—Ç—å LSTM –∏ GRU –Ω–∞ IMDb: —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å.

---

## 12. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ  

–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏, –æ–±–ª–∞–¥–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –ø–∞–º—è—Ç—å—é –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–∞—É–∑–∞–ª—å–Ω–æ—Å—Ç—å—é, –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º–∏ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–¥–∞—á –∏ —Å–∏—Ç—É–∞—Ü–∏–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –±–∞–∑—ã, –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏—ë–º–æ–≤ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π –¥–∞—ë—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ –¥–æ–ø–æ–ª–Ω—è–µ—Ç ¬´—Å–µ–º–µ–π—Å—Ç–≤–æ¬ª Transformer‚Äë–ø–æ–¥–æ–±–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞  

1. I.¬†Goodfellow, Y.¬†Bengio, A.¬†Courville ‚Äî *Deep¬†Learning*, –≥–ª.¬†10.  
2. S.¬†Pascanu, T.¬†Mikolov, Y.¬†Bengio ‚Äî *On the difficulty of training RNN* (ICML¬†2013).  
3. S.¬†Hochreiter, J.¬†Schmidhuber ‚Äî *Long Short‚ÄëTerm Memory* (1997).  
4. A.¬†Graves ‚Äî *Sequence Transduction with RNN‚ÄëTransducer* (2012).  
5. P.¬†Poli ‚Äî *RWKV: Reinventing RNNs* (arXiv¬†2024).

</details>

<details> 
    <summary><em><strong>LSTM</strong></em></summary>

</details>

<details> 
    <summary><em><strong>GRU</strong></em></summary>

</details>

<details> 
    <summary><em><strong>CNN</strong></em></summary>

</details>

<details> 
    <summary><em><strong>SSM</strong></em></summary>

</details>