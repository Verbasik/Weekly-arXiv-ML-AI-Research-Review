# **Mamba 2 + Transformer = Nemotron H**

## **–í–≤–µ–¥–µ–Ω–∏–µ**

–ë–æ–ª—å—à–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (LLM) –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö, –Ω–æ –∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞ –æ—Å—Ç–∞—é—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –°–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π Nemotron-H —Ä–µ—à–∞–µ—Ç —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –≥–∏–±—Ä–∏–¥–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã Transformer —Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é —Å–ª–æ–µ–≤ Mamba.

![Figure_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/Figure_01.jpeg)
*–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏–†–∏—Å—É–Ω–æ–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Nemotron-H —Å –¥—Ä—É–≥–∏–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ LLM —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (—Ç–æ–∫–µ–Ω–æ–≤/—Å/GPU) –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ —ç—Ç–∞–ª–æ–Ω–Ω–æ–º —Ç–µ—Å—Ç–µ MMLU. Nemotron-H-56B –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤ 2,4 —Ä–∞–∑–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, —á–µ–º Llama-3.1-70B, –ø—Ä–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö —Ç–æ—á–Ω–æ—Å—Ç–∏.*

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ NVIDIA –º–æ–¥–µ–ª–∏ Nemotron-H —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è—é—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Å–ª–æ–µ–≤ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è –≤ Transformer —Å–ª–æ—è–º–∏ Mamba, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –º–æ–¥–µ–ª—è—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (SSM). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∏ –æ–±—ä–µ–º–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ —Å –¥–ª–∏–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–ª–æ–∏ Mamba –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é –∏ –æ–±—ä–µ–º–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ —Ç–æ–∫–µ–Ω, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

–ö–ª—é—á–µ–≤–æ–µ –Ω–æ–≤—à–µ—Å—Ç–≤–æ Nemotron-H –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–∏—Ö –¥–≤—É—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ä–∞–¥–∏–≥–º –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ—Ç–≤–µ—á–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ LLM –≤ –º–æ–¥–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –±–µ–∑ —É—â–µ—Ä–±–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

# –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Mamba

Mamba ‚Äî —ç—Ç–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π (SSM). –û–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ —Å–µ—Ä—å–µ–∑–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç Transformer. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (RNN) –∏ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (CNN), –¥–æ—Å—Ç–∏–≥–∞—è –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∏–ª–∏ –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Mamba

1. **–ú–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞**  
   - –í–≤–µ–¥–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.  
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ SSM.

2. **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º**  
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.  
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ 3 —Ä–∞–∑ –Ω–∞ GPU A100.

3. **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è**  
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—É—é —Å Transformer.  
   - –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Mamba

Mamba –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã–¥–∞—é—â—É—é—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö:  
- **–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ**:  
  –ú–æ–¥–µ–ª—å Vim, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ Mamba, –≤ 2,8 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ DeiT –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –≤—ã—Å–æ–∫–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –∏ —ç–∫–æ–Ω–æ–º–∏—Ç 86,8% –ø–∞–º—è—Ç–∏ GPU.  
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (NLP)**:  
  –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SSM –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 2‚Äì8 —Ä–∞–∑.
- **–ö–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è (Text-to-Code)**:  
  Mistral —Å–¥–µ–ª–∞–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SSM –º–æ–¥–µ–ª—å Codestral, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –º–µ—Ç—Ä–∏–∫–∞—Ö —Ä–∞–∑–±–∏–ª–∞ –ø–æ—á—Ç–∏ –≤—Å–µ –¥—Ä—É–≥–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–µ–ª–∏. 

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–æ–≥—Ä—É–∑–∏—Ç—Å—è –≤ –≥–ª—É–±–æ–∫–∏–π –æ–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ–π—Å—Ç–µ–π Mamba, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ —Ç–∞–∫–æ–µ RNN, LSTM, CNN, GRU, SSM üëá

<details> 
    <summary><em><strong>–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (RNN)</strong></em></summary>

## **1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è**

### **1.1¬†–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–µ—Ç–∏**
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: —è–∑—ã–∫, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã, –∞—É–¥–∏–æ, –î–ù–ö‚Äë–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.  
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–µ—Ç–∏ —Å—á–∏—Ç–∞—é—Ç –≤—Ö–æ–¥—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏; RNN —Ö—Ä–∞–Ω—è—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ —Å–∫—Ä—ã—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ $h_t$.

### **1.2¬†–ò—Å—Ç–æ—Ä–∏—è**   

- **1982¬†–≥.¬†‚Äî Hopfield‚Äë—Å–µ—Ç—å.**  
  –ü–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å —Å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –ø–∞–º—è—Ç–∏‚Äë–∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π. –†–∞–±–æ—Ç–∞ –î–∂.¬†–•–æ–ø—Ñ–∏–ª–¥–∞ —Å—Ç–∞–ª–∞ –ø–µ—Ä–≤–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π —Ç—Ä–µ–Ω–∏—Ä—É–µ–º—ã—Ö —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π –≤ –Ω–µ–π—Ä–æ‚Äë–≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.

- **1986¬†–≥.¬†‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º BPTT (Rumelhart¬†&¬†McClelland).**  
  –ê–≤—Ç–æ—Ä—ã –æ–±–æ–±—â–∏–ª–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π back‚Äëpropagation –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ –≥—Ä–∞—Ñ—ã, —á—Ç–æ –æ—Ç–∫—Ä—ã–ª–æ –ø—É—Ç—å –∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –ö–Ω–∏–≥–∞ *Parallel Distributed Processing* –∑–∞–∫—Ä–µ–ø–∏–ª–∞ –∏–¥–µ—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π.

- **1990¬†–≥.¬†‚Äî ¬´Simple¬†RNN¬ª (Elman).**  
  –î.¬†–≠–ª–º–∞–Ω –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π ¬´–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π¬ª —Å–ª–æ–π —Å–ø–æ—Å–æ–±–µ–Ω –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ. –¢–∞–∫ –ø–æ—è–≤–∏–ª–∞—Å—å –±–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Elman‚Äënet, —Å—Ç–∞–≤—à–∞—è —É—á–µ–±–Ω—ã–º —ç—Ç–∞–ª–æ–Ω–æ–º RNN.

- **1997¬†–≥.¬†‚Äî LSTM (Hochreiter¬†&¬†Schmidhuber).**  
  –í–≤–µ–¥–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –ø–∞–º—è—Ç–∏ –∏ –≤–µ–Ω—Ç–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—à–∏–ª–æ –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, –ø–æ–∑–≤–æ–ª–∏–≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ —Å–æ—Ç–Ω–∏ —à–∞–≥–æ–≤ –Ω–∞–∑–∞–¥. LSTM –≤—Å–∫–æ—Ä–µ —Å—Ç–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–ª—è —Ä–µ—á–∏ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.

- **2014¬†–≥.¬†‚Äî GRU (Cho¬†–∏¬†–¥—Ä.).**  
  –°–æ–∫—Ä–∞—Ç–∏–≤ —á–∏—Å–ª–æ –≤–µ–Ω—Ç–∏–ª–µ–π –¥–æ –¥–≤—É—Ö, GRU –ø—Ä–µ–¥–ª–æ–∂–∏–ª –±–æ–ª–µ–µ –ª—ë–≥–∫—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É LSTM –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏. –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–≤–ø–∞–ª–∞ —Å –±—É–º–æ–º seq2seq‚Äë–º–æ–¥–µ–ª–µ–π –≤ –ø–µ—Ä–µ–≤–æ–¥–µ –∏ –¥–∏–∞–ª–æ–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

- **2020‚Äë–µ¬†‚Äî –≥–∏–±—Ä–∏–¥—ã RNN¬†+¬†Attention (RWKV,¬†S4,¬†Mamba).**  
  –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –ª–∏–Ω–µ–π–Ω—ã–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å–æ —Å–ª–æ–µ–º –≤–Ω–∏–º–∞–Ω–∏—è, –¥–æ—Å—Ç–∏–≥–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –ø—Ä–∏ –ø–∞–º—è—Ç–∏ $O(1)$. –¢–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞.


## **2. Simple RNN (–Ø—á–µ–π–∫–∞ –≠–ª–º–∞–Ω–∞): –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**

### **2.1 –ò–Ω—Ç—É–∏—Ü–∏—è**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–ª–æ–≤–æ –∑–∞ —Å–ª–æ–≤–æ–º. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–æ–≤–∞, –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∞–º–æ —Å–ª–æ–≤–æ, –Ω–æ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–ª–æ–≤. Simple RNN —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º:

*   –ù–∞ –∫–∞–∂–¥–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ $t$ –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:
    1.  **–ù–æ–≤—ã–π –≤—Ö–æ–¥** $x_t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞).
    2.  **–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞** $h_{t-1}$ (–∫–æ–Ω—Ç–µ–∫—Å—Ç, "–ø–∞–º—è—Ç—å").
*   –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –¥–≤—É—Ö –≤—Ö–æ–¥–æ–≤ –æ–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç:
    1.  **–ù–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** $h_t$, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥.
    2.  **–í—ã—Ö–æ–¥** $y_t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞ –∏–ª–∏ –º–µ—Ç–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞).

### **2.2 –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è**

–î–∞–≤–∞–π—Ç–µ –æ–ø–∏—à–µ–º —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏. –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º—Å—è —Å –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤ (–≤–µ–∫—Ç–æ—Ä–æ–≤/–º–∞—Ç—Ä–∏—Ü):

| **–û–±—ä–µ–∫—Ç** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å**        | **–°–º—ã—Å–ª**                                    |
| :--------- | :--------------------- | :------------------------------------------- |
| $x_t$      | $\mathbb{R}^{d_x}$     | –í–µ–∫—Ç–æ—Ä –≤—Ö–æ–¥–∞ –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ $t$            |
| $h_t$      | $\mathbb{R}^{d_h}$     | –í–µ–∫—Ç–æ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –º–æ–º–µ–Ω—Ç $t$       |
| $y_t$      | $\mathbb{R}^{d_y}$     | –í–µ–∫—Ç–æ—Ä –≤—ã—Ö–æ–¥–∞ –º–æ–¥–µ–ª–∏ –≤ –º–æ–º–µ–Ω—Ç $t$            |
| $W_{xh}$   | $\mathbb{R}^{d_x \times d_h}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "–≤—Ö–æ–¥ ‚Üí —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"   |
| $W_{hh}$   | $\mathbb{R}^{d_h \times d_h}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "–ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ" (—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å) |
| $W_{hy}$   | $\mathbb{R}^{d_h \times d_y}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí –≤—ã—Ö–æ–¥" |
| $b_h$      | $\mathbb{R}^{d_h}$     | –í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è            |
| $b_y$      | $\mathbb{R}^{d_y}$     | –í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è           |

> **–ó–∞—á–µ–º —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º–∏?** –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏ –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ —Å broadcast'–∏–Ω–≥–æ–º –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö —Ç–∏–ø–∞ NumPy/PyTorch).

### **2.3 –î–∏–Ω–∞–º–∏–∫–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞**

–¢–µ–ø–µ—Ä—å –∑–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—ã, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç —à–∞–≥–∞ $t-1$ –∫ —à–∞–≥—É $t$:

$$
\boxed{%
\begin{aligned}
h_t &= \sigma_h\!\bigl(W_{xh}x_t + W_{hh}h_{t-1} + b_h\bigr), & h_0&=\mathbf0,\\[4pt]
y_t &= \sigma_y\!\bigl(W_{hy}h_t + b_y\bigr).
\end{aligned}}
$$

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**

1.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$:**
    *   $W_{xh}x_t$: –í–ª–∏—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ö–æ–¥–∞ $x_t$ –Ω–∞ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
    *   $W_{hh}h_{t-1}$: –í–ª–∏—è–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$ (–ø–∞–º—è—Ç–∏) –Ω–∞ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –≠—Ç–æ **–∫–ª—é—á–µ–≤–∞—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å**.
    *   $b_h$: –°–º–µ—â–µ–Ω–∏–µ (bias).
    *   $\sigma_h$: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **tanh** –∏–ª–∏ **—Å–∏–≥–º–æ–∏–¥—É**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ "—Å–∂–∏–º–∞—é—Ç" –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω ([-1, 1] –¥–ª—è tanh, [0, 1] –¥–ª—è —Å–∏–≥–º–æ–∏–¥—ã), —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.
    *   $h_0 = \mathbf{0}$: –ù–∞—á–∏–Ω–∞–µ–º —Å –Ω—É–ª–µ–≤–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

2.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ $y_t$:**
    *   $W_{hy}h_t$: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$ –≤ –≤—ã—Ö–æ–¥–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
    *   $b_y$: –°–º–µ—â–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è.
    *   $\sigma_y$: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è. –ï—ë –≤—ã–±–æ—Ä **–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏**:
        *   `softmax`: –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞/—Å–ª–æ–≤–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è).
        *   `sigmoid`: –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π).
        *   `id` (–ª–∏–Ω–µ–π–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è, —Ç.–µ. –µ—ë –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ): –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è).

![Image_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_01.webp)

```python
"""
–≠—Ç–æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (RNN) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å–ª–æ–≤. 
–ö–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏, —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è softmax, –∞ —Ç–∞–∫–∂–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª RNN, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 
–≤—Ö–æ–¥–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ–≤ –∏ –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–æ–≥–Ω–æ–∑—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–ö–æ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É RNN –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Å–∞ –∏ —Å–º–µ—â–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ 
–æ–ø–µ—Ä–∞—Ü–∏–∏ (one-hot encoding, embedding, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, softmax), –∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–æ–ø-2 –ø—Ä–æ–≥–Ω–æ–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
"""

import numpy as np
import pandas as pd

def softmax(x: np.ndarray) -> np.ndarray:
    """
    Description:
    ---------------
        –í—ã—á–∏—Å–ª—è–µ—Ç softmax –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.

    Args:
    ---------------
        x: –í—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å softmax.

    Returns:
    ---------------
        –ú–∞—Å—Å–∏–≤ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π softmax.

    Raises:
    ---------------
        ValueError: –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç.

    Examples:
    ---------------
        >>> softmax(np.array([1, 2, 3]))
        array([0.09003057, 0.24472847, 0.66524096])
    """
    if x.size == 0:
        raise ValueError("–í—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")

    e = np.exp(x - np.max(x, axis=0, keepdims=True))
    return e / e.sum(axis=0, keepdims=True)

# ---------------- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ ----------------
vocab = ["the", "students", "opened", "their", "books", "laptops", "zoo"]
V = len(vocab)
d_e, d_h = 8, 16  # —Ä–∞–∑–º–µ—Ä—ã embedding –∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

# –°–ª–æ–≤–∞—Ä—å: —Å–ª–æ–≤–æ ‚Üí –∏–Ω–¥–µ–∫—Å
word2idx = {w: i for i, w in enumerate(vocab)}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤
np.random.seed(0)
E = np.random.randn(d_e, V) * 0.1      # —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
W_e = np.random.randn(d_h, d_e) * 0.1  # —Å–∫—Ä—ã—Ç–æ–µ ‚Üê —ç–º–±–µ–¥–¥–∏–Ω–≥
W_h = np.random.randn(d_h, d_h) * 0.1  # —Å–∫—Ä—ã—Ç–æ–µ ‚Üê —Å–∫—Ä—ã—Ç–æ–µ
b1 = np.zeros((d_h, 1))                # —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è
U = np.random.randn(V, d_h) * 0.1      # –ø—Ä–æ–µ–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–æ–≥–æ ‚Üí –ª–æ–≥–∏—Ç—ã
b2 = np.zeros((V, 1))                  # —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è

# --------------- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü ----------------
df_E = pd.DataFrame(
    E, index=[f"e{i}" for i in range(d_e)], columns=vocab
)
df_We = pd.DataFrame(
    W_e, index=[f"h{i}" for i in range(d_h)], columns=[f"e{j}" for j in range(d_e)]
)
df_Wh = pd.DataFrame(
    W_h, index=[f"h{i}" for i in range(d_h)], columns=[f"h{j}" for j in range(d_h)]
)
df_U = pd.DataFrame(
    U, index=vocab, columns=[f"h{j}" for j in range(d_h)]
)

print("\n–ú–∞—Ç—Ä–∏—Ü–∞ E (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏):")
print(df_E)
print("\n–ú–∞—Ç—Ä–∏—Ü–∞ W_e (—Å–∫—Ä—ã—Ç–æ–µ ‚Üê —ç–º–±–µ–¥–¥–∏–Ω–≥):")
print(df_We)
print("\n–ú–∞—Ç—Ä–∏—Ü–∞ W_h (—Å–∫—Ä—ã—Ç–æ–µ ‚Üê —Å–∫—Ä—ã—Ç–æ–µ):")
print(df_Wh)
print("\n–ú–∞—Ç—Ä–∏—Ü–∞ U (–ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –≤—ã—Ö–æ–¥):")
print(df_U)

# --------------- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª RNN ----------------
sequence = ["the", "students", "opened", "their"]
h_prev = np.zeros((d_h, 1))

print("\n–®–∞–≥  t    –°–ª–æ–≤–æ      –¢–æ–ø‚Äë2 (—Å–ª–æ–≤–æ, –≤–µ—Ä‚Äë—Ç—å)")
print("-" * 60)
for t, word in enumerate(sequence, 1):
    print(f"\n## –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–∞–∑–±–æ—Ä –¥–ª—è t={t}, —Å–ª–æ–≤–æ = '{word}'")

    # 1) One‚Äëhot
    x = np.zeros((V, 1))
    x[word2idx[word], 0] = 1.0
    print("1) One‚Äëhot –≤–µ–∫—Ç–æ—Ä x:")
    print(x.T)

    # 2) Embedding
    e = E @ x
    print("\n2) Embedding e = E @ x:")
    print(e.T)

    # 3) –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    h = np.tanh(W_h @ h_prev + W_e @ e + b1)
    print("\n3) –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ h:")
    print(h.T)

    # 4) –õ–æ–≥–∏—Ç—ã –∏ softmax
    o = U @ h + b2
    y = softmax(o)
    print("\n4) –õ–æ–≥–∏—Ç—ã o = U @ h + b2:")
    print(o.T)
    print("   Softmax y:")
    print(y.T)

    # –¢–æ–ø‚Äë2 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
    top2 = np.argsort(-y.flatten())[:2]
    probs = [(vocab[i], float(y[i])) for i in top2]
    print(f"\n–¢–æ–ø‚Äë2 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞: {probs}")

    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    h_prev = h
```

### **–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ —Å—Ö–µ–º–µ ¬´–ü—Ä–æ—Å—Ç–∞—è RNN‚Äë—è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å¬ª (step by step)**

1. **–ü–æ–¥–∞—á–∞ –≤—Ö–æ–¥–∞**  
   - –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ $t$ –º—ã –∏–º–µ–µ–º —Å–ª–æ–≤–æ –≤ –≤–∏–¥–µ one‚Äëhot –≤–µ–∫—Ç–æ—Ä–∞  
     $$x^{(t)} \in \mathbb{R}^{|V|}$$  
     –≥–¥–µ $|V|$¬†‚Äî —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è.
     
   - –ü—Ä–∏–º–µ—Ä: –¥–ª—è —Å–ª–æ–≤–∞—Ä—è $\{\text{the}, \text{students}, \text{opened}, \dots\}$ —Å–ª–æ–≤–æ ¬´students¬ª –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–æ–º, –≥–¥–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ ¬´students¬ª¬†—Å—Ç–æ–∏—Ç¬†1, –∞ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö¬†‚Äî¬†0.

2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ embedding**  
   - –£–º–Ω–æ–∂–∞–µ–º one‚Äëhot $x^{(t)}$ –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É –≤–ª–æ–∂–µ–Ω–∏–π  
     $$E \in \mathbb{R}^{d_e \times |V|}$$  
     —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–ª–æ—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä  
     $$e^{(t)} = E \, x^{(t)} \in \mathbb{R}^{d_e}$$

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è**  
   - –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:  

    $$
      h^{(t)} = \sigma\bigl(W_h \, h^{(t-1)} + W_e \, e^{(t)} + b_1\bigr)
    $$  
     
     –≥–¥–µ  
     - $h^{(t)} \in \mathbb{R}^{d_h}$¬†‚Äî —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —à–∞–≥–µ $t$,  
     - $W_h \in \mathbb{R}^{d_h \times d_h}$¬†‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å–∫—Ä—ã—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é,  
     - $W_e \in \mathbb{R}^{d_h \times d_e}$¬†‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ embedding,  
     - $b_1 \in \mathbb{R}^{d_h}$¬†‚Äî –≤–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏–π,  
     - $\sigma$¬†‚Äî –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å (–æ–±—ã—á–Ω–æ¬†$\tanh$ –∏–ª–∏¬†ReLU).

   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:  

     $$h^{(0)} = \mathbf{0}\quad(\text{–∏–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–π –≤–µ–∫—Ç–æ—Ä}).$$  
   - –ü—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –≤—ã—Ö–æ–¥–∞ –∫ $W_h\,h^{(t-1)} + W_e\,e^{(t)}$ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è —Å–º–µ—â–µ–Ω–∏–µ $b_1$, –∞ –∫ $U\,h^{(t)}$¬†‚Äî —Å–º–µ—â–µ–Ω–∏–µ¬†$b_2$, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–æ –ª–æ–≥–∏—Ç–∞–º –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è softmax.

4. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞**  
   - –°—Ç—Ä–æ–∏–º –ª–æ–≥–∏—Ç—ã –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Å–ª–æ–≤–∞—Ä—é:  
     $$
       o^{(t)} = U \, h^{(t)} + b_2,\qquad U\in\mathbb{R}^{|V|\times d_h},\;b_2\in\mathbb{R}^{|V|}.
     $$  
   - –ü—Ä–∏–º–µ–Ω—è–µ–º softmax, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:  
     $$
       \hat y^{(t)} = \mathrm{softmax}\bigl(o^{(t)}\bigr)\in[0,1]^{|V|},\quad\sum_i \hat y^{(t)}_i = 1.
     $$  
   - –í–µ–∫—Ç–æ—Ä $\hat y^{(t)}$ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–µ —Å–ª–æ–≤–æ –º–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º —Å–ª–µ–¥—É—é—â–∏–º –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ $t+1$.

5. **–ü–æ–≤—Ç–æ—Ä—è–µ–º –≤–æ –≤—Ä–µ–º–µ–Ω–∏**  
   - –ú–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤ ($W_{xh}, W_{hh}, W_{hy}$) –∏ –≤–µ–∫—Ç–æ—Ä—ã —Å–º–µ—â–µ–Ω–∏–π ($b_h, b_y$) **–æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –Ω–∞ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–∞—Ö $t$**. –°–µ—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç RNN –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $T$.

## **3. –û–±—É—á–µ–Ω–∏–µ RNN: Backpropagation Through Time (BPTT)**

–ú—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏, –∫–∞–∫ RNN –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–ø—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥). –ù–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ—ë –≤–µ—Å–∞ $W_{xh}, W_{hh}, W_{hy}, b_h, b_y$, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±—ã–ª–∏ —Ç–æ—á–Ω—ã–º–∏? –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚Äî **Backpropagation Through Time (BPTT)**.

### **3.1 –ò–¥–µ—è: –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**

–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫, –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å $L$ –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º–æ–¥–µ–ª–∏. –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –≤—ã—Ö–æ–¥ $y_t$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_t$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_{t-1}$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_{t-2}$, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –≤–ø–ª–æ—Ç—å –¥–æ $h_0$. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤—Å–µ $h_k$ (–¥–ª—è $k < t$) –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –≤–µ—Å–æ–≤ $W_{hh}$ –∏ $W_{xh}$.

–ò–¥–µ—è BPTT –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã **–º—ã—Å–ª–µ–Ω–Ω–æ "—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å" RNN –≤–æ –≤—Ä–µ–º–µ–Ω–∏** –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª–∏–Ω–æ–π $T$. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å $T$ –∫–æ–ø–∏–π –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —è—á–µ–π–∫–∏ RNN, —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ. –í—Ö–æ–¥ $x_t$ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_{t-1}$ –ø–æ–¥–∞—é—Ç—Å—è –≤ $t$-—é –∫–æ–ø–∏—é, –æ–Ω–∞ –≤—ã–¥–∞–µ—Ç $h_t$ –∏ $y_t$, –∏ $h_t$ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ $(t+1)$-—é –∫–æ–ø–∏—é.

![Image_02](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_02.png)

### **–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ —Å—Ö–µ–º–µ ¬´–ü—Ä–æ—Å—Ç–∞—è RNN‚Äë—è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å¬ª (step by step)**

–ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Ñ—Ä–∞–∑—ã ¬´the students opened their¬ª –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä—è–º–æ–π –∏ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥—ã (BPTT) –≤ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–π RNN-–º–æ–¥–µ–ª–∏.

#### **1. –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (Unrolling)**

- –ö–∞–∂–¥—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –Ω–∞ —Å—Ö–µ–º–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É —à–∞–≥—É $t=0,1,2,3$.  
- –í—Ö–æ–¥—ã: $x_0,x_1,x_2,x_3$ ‚Äî one‚Äëhot –≤–µ–∫—Ç–æ—Ä—ã —Å–ª–æ–≤ ¬´the¬ª, ¬´students¬ª, ¬´opened¬ª, ¬´their¬ª.  
- –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_{-1}$ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω—É–ª—è–º–∏.  
- –°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_0\ldots h_3$ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ —Ä–µ–±—Ä—É $W_{hh}$.  
- –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∏–∑ $h_t$ —á–µ—Ä–µ–∑ $W_{hy}$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤—ã—Ö–æ–¥ $\hat y_t$.

#### **2. –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ (Forward pass)**

#### **–®–∞–≥ 0 ($t=0$), —Å–ª–æ–≤–æ ¬´the¬ª**

1. **One-hot –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**:  
   $ x_0 $ ‚Äî –µ–¥–∏–Ω–∏—á–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –≥–¥–µ –µ–¥–∏–Ω–∏—Ü–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–æ–≤–∞ ¬´the¬ª.

2. **Embedding (–≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)**:  
   $ e_0 = E\,x_0 $,  
   –≥–¥–µ $ E $ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.

3. **–°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (hidden state)**:  
   $$
   h_0 = \tanh\bigl(W_{xh} e_0 + W_{hh} h_{-1} + b_1\bigr),
   $$  
   –≥–¥–µ:
   - $ W_{xh}, W_{hh} $ ‚Äî –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã,
   - $ b_1 $ ‚Äî —Å–º–µ—â–µ–Ω–∏–µ,
   - $ h_{-1} $ ‚Äî –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–æ–±—ã—á–Ω–æ –Ω—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä).

4. **–í—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏ –∏ softmax**:  
   $$
   o_0 = W_{hy}h_0 + b_2,\quad \hat{y}_0 = \mathrm{softmax}(o_0),
   $$  
   –≥–¥–µ:
   - $ W_{hy} $ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ª–æ–≥–∏—Ç—ã,
   - $ b_2 $ ‚Äî —Å–º–µ—â–µ–Ω–∏–µ,
   - $ \hat{y}_0 $ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–ª–æ–≤–∞—Ä—é.

5. **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Loss)**:  
   –¶–µ–ª–µ–≤–æ–µ —Å–ª–æ–≤–æ ‚Äî ¬´students¬ª. –ü–æ—Ç–µ—Ä—è –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫:  
   $$
   L_0 = -\log\hat{y}_0[\text{students}].
   $$

#### **–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å**

–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–π–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å** –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∑–∞–¥–∞—á–∏. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ—ë —ç—Ç–∞–ø—ã:

1. **–õ–æ–≥–∏—Ç—ã –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏**:  
   –ú–æ–¥–µ–ª—å –≤—ã–¥–∞—ë—Ç –≤–µ–∫—Ç–æ—Ä –ª–æ–≥–∏—Ç–æ–≤:  
   $$
   o_0 = W_{hy}h_0 + b_2,
   $$  
   –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ softmax:  
   $$
   \hat{y}_0 = \mathrm{softmax}(o_0) \in [0, 1]^{|V|}, \quad \sum_i \hat{y}_0[i] = 1.
   $$

2. **–¶–µ–ª–µ–≤–∞—è –º–µ—Ç–∫–∞**:  
   –¶–µ–ª–µ–≤–∞—è –º–µ—Ç–∫–∞ $ y^{(0)} $ ‚Äî one-hot –≤–µ–∫—Ç–æ—Ä, –≥–¥–µ –µ–¥–∏–Ω–∏—Ü–∞ —Å—Ç–æ–∏—Ç –≤ –ø–æ–∑–∏—Ü–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ ¬´students¬ª:  
   $$
   y^{(0)}_{\text{students}} = 1.
   $$

3. **–ö—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏—è**:  
   –§–æ—Ä–º—É–ª–∞ –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–∏:  
   $$
   L_0 = -\sum_{i=1}^{|V|} y^{(0)}_i \log\hat{y}_0[i] = -\log\hat{y}_0[\text{students}].
   $$

4. **–ò–Ω—Ç—É–∏—Ü–∏—è**:  
   –ß–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞ $ \hat{y}_0[\text{students}] $, —Ç–µ–º –≤—ã—à–µ —à—Ç—Ä–∞—Ñ (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏).

#### **–®–∞–≥ 1 ($t=1$), —Å–ª–æ–≤–æ ¬´students¬ª**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: $x_1$ ‚Üí $e_1$ ‚Üí  
  $$h_1 = \tanh(W_{xh}e_1 + W_{hh}h_0 + b_1).$$  
- –í—ã—Ö–æ–¥ $\hat y_1 = \mathrm{softmax}(W_{hy}h_1+b_2)$,  
  —Ü–µ–ª–µ–≤–æ–µ —Å–ª–æ–≤–æ ¬´opened¬ª, $L_1=-\log\hat y_1[opened]$.

#### **–®–∞–≥ 2 ($t=2$), —Å–ª–æ–≤–æ ¬´opened¬ª**
- $x_2$ ‚Üí $e_2$ ‚Üí  
  $$h_2 = \tanh(W_{xh}e_2 + W_{hh}h_1 + b_1).$$  
- $\hat y_2$, —Ü–µ–ª–µ–≤–æ–π ¬´their¬ª, $L_2=-\log\hat y_2[their]$.

#### **–®–∞–≥ 3 ($t=3$), —Å–ª–æ–≤–æ ¬´their¬ª**
- $x_3$ ‚Üí $e_3$ ‚Üí  
  $$h_3 = \tanh(W_{xh}e_3 + W_{hh}h_2 + b_1).$$  
- $\hat y_3$, —Ü–µ–ª–µ–≤–æ–π ¬´books¬ª, $L_3=-\log\hat y_3[books]$.

- **–°—É–º–º–∞—Ä–Ω–∞—è –ø–æ—Ç–µ—Ä—è**:  
  $$L = L_0 + L_1 + L_2 + L_3.$$  

#### **3. –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (Backward pass ‚Äî BPTT)**

- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ—Ç –∫–∞–∂–¥–æ–π $L_t$ (–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏) –ø—Ä–æ–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑:
  - –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π $W_{hy}$ –∫ —Å–∫—Ä—ã—Ç—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏—è–º,
  - —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–≤—è–∑–∏ $W_{hh}$ –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º $h_{t-1}$.
- –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∞–∫–∫—É–º—É–ª–∏—Ä—É—é—Ç—Å—è $
  \frac{\partial L}{\partial W_{xh}},
  \frac{\partial L}{\partial W_{hh}},
  \frac{\partial L}{\partial W_{hy}},
  \frac{\partial L}{\partial b_1},
  \frac{\partial L}{\partial b_2}$.
- –í –∏—Ç–æ–≥–µ –≤–µ—Å–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å —É—á—ë—Ç–æ–º –≤–∫–ª–∞–¥–∞ –æ—à–∏–±–æ–∫ —Å–æ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤.

**–í—ã–≤–æ–¥:** BPTT —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç RNN –≤–æ –≤—Ä–µ–º–µ–Ω–∏, –≤—ã—á–∏—Å–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ—à–∏–±–∫–∏ —Å–∫–≤–æ–∑—å –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –æ–±—É—á–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤.

–•–æ—Ç—è –º—ã —Å–æ–∑–¥–∞–µ–º $T$ –∫–æ–ø–∏–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å: **–≤–µ—Å–∞ $W_{xh}, W_{hh}, W_{hy}$ –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –∫–æ–ø–∏–π**.

#### **3.2 –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**

–û–±—ã—á–Ω–æ –æ–±—â–∞—è –ø–æ—Ç–µ—Ä—è $L$ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å $\ell$ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

$$
L \;=\;\sum_{t=1}^{T}\,\ell\bigl(y_t,\widehat y_t\bigr),
$$

–≥–¥–µ $y_t$ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —à–∞–≥–µ $t$, –∞ $\widehat y_t$ ‚Äî –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Ü–µ–ª—å) –Ω–∞ —à–∞–≥–µ $t$. –§—É–Ω–∫—Ü–∏—è $\ell$ –º–æ–∂–µ—Ç –±—ã—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–µ–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–æ–π (MSE) –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

#### **3.3 –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (–ü—Ä–∏–º–µ—Ä –¥–ª—è $W_{hh}$)**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ–±—â–µ–π –ø–æ—Ç–µ—Ä–∏ $L$ –ø–æ –æ–¥–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É $w$ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã $W_{hh}$. –ò—Å–ø–æ–ª—å–∑—É—è —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –≥—Ä–∞–¥–∏–µ–Ω—Ç $L$ –ø–æ $w$ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –∏–∑ –≤–∫–ª–∞–¥–æ–≤ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —à–∞–≥–∞ $t$:

$$
\frac{\partial L}{\partial w}\;=\; \sum_{t=1}^{T}\,\frac{\partial \ell(y_t, \widehat y_t)}{\partial w}
$$

–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ $\frac{\partial \ell(y_t, \widehat y_t)}{\partial w}$, –Ω–∞–º –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å, –∫–∞–∫ $w$ –≤–ª–∏—è–µ—Ç –Ω–∞ $y_t$. –≠—Ç–æ –≤–ª–∏—è–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$:

$$
\frac{\partial \ell(y_t, \widehat y_t)}{\partial w} = \frac{\partial \ell}{\partial y_t} \frac{\partial y_t}{\partial h_t} \frac{\partial h_t}{\partial w}
$$

–°–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å ‚Äî —ç—Ç–æ $\frac{\partial h_t}{\partial w}$. –°–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $w$ –Ω–∞–ø—Ä—è–º—É—é (—á–µ—Ä–µ–∑ —á–ª–µ–Ω $W_{hh}h_{t-1}$ –≤ —Ñ–æ—Ä–º—É–ª–µ –¥–ª—è $h_t$) –∏ –∫–æ—Å–≤–µ–Ω–Ω–æ, —á–µ—Ä–µ–∑ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}, h_{t-2}, \dots, h_1$, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Ç–æ–∂–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç $w$.

$$
\frac{\partial h_t}{\partial w} = \underbrace{\frac{\partial h_t}{\partial h_{t-1}}\frac{\partial h_{t-1}}{\partial w}}_{\text{—á–µ—Ä–µ–∑ } h_{t-1}} + \underbrace{\frac{\partial h_t}{\partial w}}_{\text{–ø—Ä—è–º–æ–µ –≤–ª–∏—è–Ω–∏–µ}}
$$

–†–∞—Å–∫—Ä—ã–≤–∞—è —ç—Ç—É —Ä–µ–∫—É—Ä—Å–∏—é –¥–∞–ª—å—à–µ, –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è **—Å—É–º–º—É –ø—É—Ç–µ–π** —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ. –ö–∞–∂–¥—ã–π —Ç–∞–∫–æ–π –ø—É—Ç—å –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ø–∫–æ–±–∏–∞–Ω–æ–≤ $\frac{\partial h_k}{\partial h_{k-1}}$.

$$
\frac{\partial h_k}{\partial h_{k-1}} = \frac{\partial}{\partial h_{k-1}} \sigma_h(W_{xh}x_k + W_{hh}h_{k-1} + b_h) = \operatorname{diag}\!\bigl[\sigma_h'(a_k)\bigr]\,W_{hh}
$$
–≥–¥–µ $a_k = W_{xh}x_k + W_{hh}h_{k-1} + b_h$ ‚Äî –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ $\sigma_h$ –Ω–∞ —à–∞–≥–µ $k$. –û–±–æ–∑–Ω–∞—á–∏–º —ç—Ç–æ—Ç –Ø–∫–æ–±–∏–∞–Ω –∫–∞–∫ $J_k$.

–¢–æ–≥–¥–∞ –≤–∫–ª–∞–¥ –≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ—Ç –ø—É—Ç–∏ –¥–ª–∏–Ω–æ–π $k$ (–æ—Ç $h_{t-k}$ –∫ $h_t$) –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ $k$ —Ç–∞–∫–∏—Ö –Ø–∫–æ–±–∏–∞–Ω–æ–≤: $J_t J_{t-1} \dots J_{t-k+1}$.

#### **3.4 –ü—Ä–æ–±–ª–µ–º—ã: –ó–∞—Ç—É—Ö–∞–Ω–∏–µ –∏ –í–∑—Ä—ã–≤ –ì—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤**

–ò–º–µ–Ω–Ω–æ —ç—Ç–∏ **–¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ø–∫–æ–±–∏–∞–Ω–æ–≤** $J_k = \operatorname{diag}[\sigma_h'(a_k)] W_{hh}$ —è–≤–ª—è—é—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ RNN:

1.  **–ó–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (Vanishing Gradient):** –ï—Å–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã $W_{hh}$ (–∏–ª–∏ –Ω–æ—Ä–º—ã –Ø–∫–æ–±–∏–∞–Ω–æ–≤ $J_k$) –ø–æ –º–æ–¥—É–ª—é **–º–µ–Ω—å—à–µ 1**, —Ç–æ –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏ –º–Ω–æ–≥–∏—Ö —Ç–∞–∫–∏—Ö –º–∞—Ç—Ä–∏—Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ –Ω—É–ª—é —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ —Å —Ä–æ—Å—Ç–æ–º $k$. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ—Ç –¥–∞–ª–µ–∫–∏—Ö –ø—Ä–æ—à–ª—ã—Ö —à–∞–≥–æ–≤ ($t-k$ –¥–ª—è –±–æ–ª—å—à–∏—Ö $k$) –ø–æ—á—Ç–∏ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ $W_{hh}$, –∏ —Å–µ—Ç—å –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è **–¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º**. Simple RNN –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω—ã —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–µ.
2.  **–í–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (Exploding Gradient):** –ï—Å–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è $W_{hh}$ (–∏–ª–∏ –Ω–æ—Ä–º—ã $J_k$) –ø–æ –º–æ–¥—É–ª—é **–±–æ–ª—å—à–µ 1**, —Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ø–∫–æ–±–∏–∞–Ω–æ–≤ –±—É–¥–µ—Ç —Ä–∞—Å—Ç–∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ–≥—Ä–æ–º–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —à–∞–≥–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—é –æ–±—É—á–µ–Ω–∏—è (NaN/Inf –≤ –ø–æ—Ç–µ—Ä—è—Ö –∏–ª–∏ –≤–µ—Å–∞—Ö).

#### **3.5 –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –†–µ—à–µ–Ω–∏—è**

*   **Gradient Clipping:** –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–æ—Ä–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞. –ï—Å–ª–∏ $\|\nabla\theta\| > \tau$ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ä–æ–≥), —Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è: $\nabla\theta \leftarrow \frac{\tau}{\|\nabla\theta\|} \nabla\theta$. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å–æ *–≤–∑—Ä—ã–≤–æ–º*, –Ω–æ –Ω–µ —Å *–∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º*.
*   **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤:** –ù–∞–ø—Ä–∏–º–µ—Ä, –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è $W_{hh}$ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –¥–µ—Ä–∂–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏–º–∏ –∫ 1.
*   **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —è—á–µ–µ–∫:** **LSTM (Long Short-Term Memory)** –∏ **GRU (Gated Recurrent Unit)** –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –±–æ—Ä—å–±—ã —Å –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –û–Ω–∏ –≤–≤–æ–¥—è—Ç "–≤–µ–Ω—Ç–∏–ª–∏" (gates), –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –ø–æ—Ç–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ —è—á–µ–π–∫—É, –ø–æ–∑–≤–æ–ª—è—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ –¥–æ–ª–≥–∏–µ –ø–µ—Ä–∏–æ–¥—ã.
*   **–§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ReLU –º–æ–∂–µ—Ç —É—Å—É–≥—É–±–∏—Ç—å –≤–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, –Ω–æ –º–µ–Ω–µ–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –∑–∞—Ç—É—Ö–∞–Ω–∏—é, —á–µ–º —Å–∏–≥–º–æ–∏–¥–∞/tanh (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ –Ω—É–ª–µ–≤–∞—è). –û–¥–Ω–∞–∫–æ –≤ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —á–∞—Å—Ç–∏ —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç tanh.


## **4. BPTT –Ω–∞ –ü—Ä–∞–∫—Ç–∏–∫–µ: –ö–≤–∞–∑–∏-–∫–æ–¥ –∏ PyTorch**

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (PyTorch, TensorFlow/Keras) —Ä–µ–∞–ª–∏–∑—É—é—Ç BPTT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í–∞–º –Ω—É–∂–Ω–æ –ª–∏—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É RNN –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (`loss.backward()` –≤ PyTorch).

–í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∏–ø–∏—á–Ω—ã–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BPTT –≤ PyTorch (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `tanh` –∫–∞–∫ $\sigma_h$ –∏ –ª–∏–Ω–µ–π–Ω–æ–π $\sigma_y$):

```python
import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F

# --- –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ) ---
T = 10      # –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
batch_size = 32
d_x = 20    # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞
d_h = 50    # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
d_y = 5     # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–∞

# --- –ú–æ–¥–µ–ª—å (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) ---
W_xh = torch.randn(d_x, d_h, requires_grad=True)
W_hh = torch.randn(d_h, d_h, requires_grad=True)
W_hy = torch.randn(d_h, d_y, requires_grad=True)
b_h  = torch.zeros(d_h, requires_grad=True)
b_y  = torch.zeros(d_y, requires_grad=True)
params = [W_xh, W_hh, W_hy, b_h, b_y]

# --- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö ---
x_sequence = torch.randn(T, batch_size, d_x) # [–í—Ä–µ–º—è, –ë–∞—Ç—á, –ü—Ä–∏–∑–Ω–∞–∫–∏]
y_true_sequence = torch.randn(T, batch_size, d_y)

# --- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ---
optimizer = optim.Adam(params, lr=0.001)

# --- –¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è (–æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è) ---
optimizer.zero_grad()

# == Forward pass (—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –≤—Ä—É—á–Ω—É—é –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏) ==
h_t = torch.zeros(batch_size, d_h) # –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ h_0
outputs = []
for t in range(T):
    # –§–æ—Ä–º—É–ª–∞ Simple RNN
    h_t = torch.tanh(x_sequence[t] @ W_xh + h_t @ W_hh + b_h)
    y_t = h_t @ W_hy + b_y # –õ–∏–Ω–µ–π–Ω—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
    outputs.append(y_t)

# –°–æ–±–∏—Ä–∞–µ–º –≤—ã—Ö–æ–¥—ã –≤ –æ–¥–∏–Ω —Ç–µ–Ω–∑–æ—Ä [T, Batch, d_y]
y_pred_sequence = torch.stack(outputs)

# == –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å ==
# –ü—Ä–∏–º–µ—Ä: MSE –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∑–∞—Ç–µ–º —É—Å—Ä–µ–¥–Ω—è–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –±–∞—Ç—á—É
loss = F.mse_loss(y_pred_sequence, y_true_sequence)

# == Backward pass (BPTT) ==
loss.backward() # PyTorch –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã ‚àÇL/‚àÇparams —á–µ—Ä–µ–∑ BPTT

# == –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Gradient Clipping ==
torch.nn.utils.clip_grad_norm_(params, max_norm=1.0) # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞

# == –®–∞–≥ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ ==
optimizer.step()

print(f"Loss: {loss.item()}")
# print(f"Gradient norm for W_hh: {W_hh.grad.norm().item()}") # –ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

*   PyTorch —Å—Ç—Ä–æ–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ –≤–æ –≤—Ä–µ–º—è forward pass.
*   –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `loss.backward()`, PyTorch –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ —ç—Ç–æ–º—É –≥—Ä–∞—Ñ—É –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –ø—Ä–∏–º–µ–Ω—è—è —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ (—Ä–µ–∞–ª–∏–∑—É—è BPTT) –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`requires_grad=True`), –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤–∏—Å–∏—Ç `loss`.
*   `torch.nn.utils.clip_grad_norm_` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤–∑—Ä—ã–≤–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ  

–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏, –æ–±–ª–∞–¥–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –ø–∞–º—è—Ç—å—é –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–∞—É–∑–∞–ª—å–Ω–æ—Å—Ç—å—é, –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º–∏ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–¥–∞—á –∏ —Å–∏—Ç—É–∞—Ü–∏–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –±–∞–∑—ã, –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏—ë–º–æ–≤ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π –¥–∞—ë—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ –¥–æ–ø–æ–ª–Ω—è–µ—Ç ¬´—Å–µ–º–µ–π—Å—Ç–≤–æ¬ª Transformer‚Äë–ø–æ–¥–æ–±–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.

</details>

<details> 
    <summary><em><strong>LSTM</strong></em></summary>

</details>

<details> 
    <summary><em><strong>GRU</strong></em></summary>

</details>

<details> 
    <summary><em><strong>CNN</strong></em></summary>

</details>

<details> 
    <summary><em><strong>SSM</strong></em></summary>

</details>

## **Nemotron-H: –£–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ä—ã–≤ –≤ –≥–∏–±—Ä–∏–¥–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**

![Figure_02](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/Figure_02.png)
*–†–∏—Å—É–Ω–æ–∫ 2 | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π Nemotron-H-8B/56B. –ü—Ä–∏–º–µ—Ä–Ω–æ 8% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Å–ª–æ–µ–≤ –≤ –º–æ–¥–µ–ª–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–ª–æ–∏ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è (self-attention); —ç—Ç–∏ —Å–ª–æ–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –≤—Å–µ–π –º–æ–¥–µ–ª–∏. –û—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –º–æ–¥–µ–ª–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ä–µ–¥—É—é—â–∏—Ö—Å—è —Å–ª–æ–µ–≤ Mamba-2 –∏ FFN.*

–ù–æ–≤–µ–π—à–∏–µ –º–æ–¥–µ–ª–∏ —Å–µ—Ä–∏–∏ Nemotron-H –æ—Ç NVIDIA –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç –Ω–∞—à–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ LLM. –≠—Ç–∞ —Å–µ—Ä–∏—è –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –≤–∫–ª—é—á–∞—é—â–∞—è —Ä–∞–∑–º–µ—Ä—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ 8B –∏ 56B, –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–ª–æ–µ–≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è —Å–ª–æ—è–º–∏ Mamba, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∞–µ—Ç—Å—è:** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞ (—Ç–∞–∫–∏–º–∏ –∫–∞–∫ Qwen-2.5-7B/72B –∏ Llama-3.1-8B/70B), –º–æ–¥–µ–ª—å Nemotron-H —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ —Ö–æ—Ä–æ—à–æ –∏–ª–∏ –¥–∞–∂–µ –ª—É—á—à–µ –≤–æ –º–Ω–æ–≥–∏—Ö —Ç–µ—Å—Ç–∞—Ö.
- **–°–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞:** –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –¥–ª–∏–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (–¥–ª–∏–Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö 65536, –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ 1024) —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–æ 3 —Ä–∞–∑.
- **–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Å–∂–∞—Ç–∏—è:** –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–æ–≤–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–∂–∞—Ç–∏—è –∏ –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏–∏ MiniPuzzle –º–æ–¥–µ–ª—å 56B —Å–∂–∏–º–∞–µ—Ç—Å—è –¥–æ 47B, —Å–æ—Ö—Ä–∞–Ω—è—è —Ç—É –∂–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –Ω–∞ 20%
- **–†–µ—Ü–µ–ø—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ FP8:** –ø–µ—Ä–≤–∞—è –ø–æ–ª–Ω–∞—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é FP8, —Å —Ç–æ–π –∂–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, —á—Ç–æ –∏ BF16

![Table_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/Table_01.png)