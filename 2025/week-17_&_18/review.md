# **Mamba 2 + Transformer = Nemotron H**

## **–í–≤–µ–¥–µ–Ω–∏–µ**

–ë–æ–ª—å—à–∏–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ (LLM) –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö, –Ω–æ –∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞ –æ—Å—Ç–∞—é—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –°–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π Nemotron-H —Ä–µ—à–∞–µ—Ç —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—è –≥–∏–±—Ä–∏–¥–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã Transformer —Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é —Å–ª–æ–µ–≤ Mamba.

![Figure_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/Figure_01.jpeg)
*–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏–†–∏—Å—É–Ω–æ–∫ 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Nemotron-H —Å –¥—Ä—É–≥–∏–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ LLM —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (—Ç–æ–∫–µ–Ω–æ–≤/—Å/GPU) –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ —ç—Ç–∞–ª–æ–Ω–Ω–æ–º —Ç–µ—Å—Ç–µ MMLU. Nemotron-H-56B –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤ 2,4 —Ä–∞–∑–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, —á–µ–º Llama-3.1-70B, –ø—Ä–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö —Ç–æ—á–Ω–æ—Å—Ç–∏.*

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ NVIDIA –º–æ–¥–µ–ª–∏ Nemotron-H —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω—è—é—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Å–ª–æ–µ–≤ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è –≤ Transformer —Å–ª–æ—è–º–∏ Mamba, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –º–æ–¥–µ–ª—è—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (SSM). –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è, –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è –∏ –æ–±—ä–µ–º–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ —Å –¥–ª–∏–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–ª–æ–∏ Mamba –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é –∏ –æ–±—ä–µ–º–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ —Ç–æ–∫–µ–Ω, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

–ö–ª—é—á–µ–≤–æ–µ –Ω–æ–≤—à–µ—Å—Ç–≤–æ Nemotron-H –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–∏—Ö –¥–≤—É—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ä–∞–¥–∏–≥–º –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –æ—Ç–≤–µ—á–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ LLM –≤ –º–æ–¥–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –±–µ–∑ —É—â–µ—Ä–±–∞ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

# –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Mamba

Mamba ‚Äî —ç—Ç–æ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π (SSM). –û–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ —Å–µ—Ä—å–µ–∑–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç Transformer. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (RNN) –∏ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (CNN), –¥–æ—Å—Ç–∏–≥–∞—è –ª–∏–Ω–µ–π–Ω–æ–≥–æ –∏–ª–∏ –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Mamba

1. **–ú–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞**  
   - –í–≤–µ–¥–µ–Ω –ø—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.  
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ SSM.

2. **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º**  
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.  
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ 3 —Ä–∞–∑ –Ω–∞ GPU A100.

3. **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è**  
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—É—é —Å Transformer.  
   - –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –ø–æ—á—Ç–∏ –ª–∏–Ω–µ–π–Ω–æ–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–ª–∏–Ω–Ω—ã–º–∏ –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Mamba

Mamba –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã–¥–∞—é—â—É—é—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö:  
- **–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ**:  
  –ú–æ–¥–µ–ª—å Vim, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ Mamba, –≤ 2,8 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ DeiT –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –≤—ã—Å–æ–∫–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –∏ —ç–∫–æ–Ω–æ–º–∏—Ç 86,8% –ø–∞–º—è—Ç–∏ GPU.  
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (NLP)**:  
  –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SSM –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 2‚Äì8 —Ä–∞–∑.
- **–ö–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è (Text-to-Code)**:  
  Mistral —Å–¥–µ–ª–∞–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ SSM –º–æ–¥–µ–ª—å Codestral, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –º–µ—Ç—Ä–∏–∫–∞—Ö —Ä–∞–∑–±–∏–ª–∞ –ø–æ—á—Ç–∏ –≤—Å–µ –¥—Ä—É–≥–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–æ–¥–µ–ª–∏. 

–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–æ–≥—Ä—É–∑–∏—Ç—Å—è –≤ –≥–ª—É–±–æ–∫–∏–π –æ–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ–π—Å—Ç–µ–π Mamba, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ —Ç–∞–∫–æ–µ RNN, LSTM, CNN, GRU, SSM üëá

<details> 
    <summary><em><strong>–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (RNN)</strong></em></summary>

## **1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è**

### **1.1¬†–ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–µ—Ç–∏**
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: —è–∑—ã–∫, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã, –∞—É–¥–∏–æ, –î–ù–ö‚Äë–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.  
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–µ—Ç–∏ —Å—á–∏—Ç–∞—é—Ç –≤—Ö–æ–¥—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏; RNN —Ö—Ä–∞–Ω—è—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ —Å–∫—Ä—ã—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ $h_t$.

### **1.2¬†–ò—Å—Ç–æ—Ä–∏—è**   

- **1982¬†–≥.¬†‚Äî Hopfield‚Äë—Å–µ—Ç—å.**  
  –ü–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å —Å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –ø–∞–º—è—Ç–∏‚Äë–∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π. –†–∞–±–æ—Ç–∞ –î–∂.¬†–•–æ–ø—Ñ–∏–ª–¥–∞ —Å—Ç–∞–ª–∞ –ø–µ—Ä–≤–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–µ–π —Ç—Ä–µ–Ω–∏—Ä—É–µ–º—ã—Ö —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π –≤ –Ω–µ–π—Ä–æ‚Äë–≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.

- **1986¬†–≥.¬†‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º BPTT (Rumelhart¬†&¬†McClelland).**  
  –ê–≤—Ç–æ—Ä—ã –æ–±–æ–±—â–∏–ª–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π back‚Äëpropagation –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–µ –≥—Ä–∞—Ñ—ã, —á—Ç–æ –æ—Ç–∫—Ä—ã–ª–æ –ø—É—Ç—å –∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –ö–Ω–∏–≥–∞ *Parallel Distributed Processing* –∑–∞–∫—Ä–µ–ø–∏–ª–∞ –∏–¥–µ—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π.

- **1990¬†–≥.¬†‚Äî ¬´Simple¬†RNN¬ª (Elman).**  
  –î.¬†–≠–ª–º–∞–Ω –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π ¬´–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π¬ª —Å–ª–æ–π —Å–ø–æ—Å–æ–±–µ–Ω –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ. –¢–∞–∫ –ø–æ—è–≤–∏–ª–∞—Å—å –±–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Elman‚Äënet, —Å—Ç–∞–≤—à–∞—è —É—á–µ–±–Ω—ã–º —ç—Ç–∞–ª–æ–Ω–æ–º RNN.

- **1997¬†–≥.¬†‚Äî LSTM (Hochreiter¬†&¬†Schmidhuber).**  
  –í–≤–µ–¥–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –ø–∞–º—è—Ç–∏ –∏ –≤–µ–Ω—Ç–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—à–∏–ª–æ –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, –ø–æ–∑–≤–æ–ª–∏–≤ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ —Å–æ—Ç–Ω–∏ —à–∞–≥–æ–≤ –Ω–∞–∑–∞–¥. LSTM –≤—Å–∫–æ—Ä–µ —Å—Ç–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–ª—è —Ä–µ—á–∏ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.

- **2014¬†–≥.¬†‚Äî GRU (Cho¬†–∏¬†–¥—Ä.).**  
  –°–æ–∫—Ä–∞—Ç–∏–≤ —á–∏—Å–ª–æ –≤–µ–Ω—Ç–∏–ª–µ–π –¥–æ –¥–≤—É—Ö, GRU –ø—Ä–µ–¥–ª–æ–∂–∏–ª –±–æ–ª–µ–µ –ª—ë–≥–∫—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É LSTM –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏. –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–≤–ø–∞–ª–∞ —Å –±—É–º–æ–º seq2seq‚Äë–º–æ–¥–µ–ª–µ–π –≤ –ø–µ—Ä–µ–≤–æ–¥–µ –∏ –¥–∏–∞–ª–æ–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

- **2020‚Äë–µ¬†‚Äî –≥–∏–±—Ä–∏–¥—ã RNN¬†+¬†Attention (RWKV,¬†S4,¬†Mamba).**  
  –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –ª–∏–Ω–µ–π–Ω—ã–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Å–æ —Å–ª–æ–µ–º –≤–Ω–∏–º–∞–Ω–∏—è, –¥–æ—Å—Ç–∏–≥–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –ø—Ä–∏ –ø–∞–º—è—Ç–∏ $O(1)$. –¢–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ —É—Å–ø–µ—à–Ω–æ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞.


## **2. Simple RNN (–Ø—á–µ–π–∫–∞ –≠–ª–º–∞–Ω–∞): –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**

### **2.1 –ò–Ω—Ç—É–∏—Ü–∏—è**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–ª–æ–≤–æ –∑–∞ —Å–ª–æ–≤–æ–º. –ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —Å–º—ã—Å–ª —Ç–µ–∫—É—â–µ–≥–æ —Å–ª–æ–≤–∞, –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∞–º–æ —Å–ª–æ–≤–æ, –Ω–æ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–ª–æ–≤. Simple RNN —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ö–æ–∂–∏–º –æ–±—Ä–∞–∑–æ–º:

*   –ù–∞ –∫–∞–∂–¥–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ $t$ –æ–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:
    1.  **–ù–æ–≤—ã–π –≤—Ö–æ–¥** $x_t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞).
    2.  **–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞** $h_{t-1}$ (–∫–æ–Ω—Ç–µ–∫—Å—Ç, "–ø–∞–º—è—Ç—å").
*   –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –¥–≤—É—Ö –≤—Ö–æ–¥–æ–≤ –æ–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç:
    1.  **–ù–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** $h_t$, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥.
    2.  **–í—ã—Ö–æ–¥** $y_t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ–≤–∞ –∏–ª–∏ –º–µ—Ç–∫–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞).

### **2.2 –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è**

–î–∞–≤–∞–π—Ç–µ –æ–ø–∏—à–µ–º —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏. –°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º—Å—è —Å –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ —Ç–µ–Ω–∑–æ—Ä–æ–≤ (–≤–µ–∫—Ç–æ—Ä–æ–≤/–º–∞—Ç—Ä–∏—Ü):

| **–û–±—ä–µ–∫—Ç** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å**        | **–°–º—ã—Å–ª**                                    |
| :--------- | :--------------------- | :------------------------------------------- |
| $x_t$      | $\mathbb{R}^{d_x}$     | –í–µ–∫—Ç–æ—Ä –≤—Ö–æ–¥–∞ –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ $t$            |
| $h_t$      | $\mathbb{R}^{d_h}$     | –í–µ–∫—Ç–æ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –º–æ–º–µ–Ω—Ç $t$       |
| $y_t$      | $\mathbb{R}^{d_y}$     | –í–µ–∫—Ç–æ—Ä –≤—ã—Ö–æ–¥–∞ –º–æ–¥–µ–ª–∏ –≤ –º–æ–º–µ–Ω—Ç $t$            |
| $W_{xh}$   | $\mathbb{R}^{d_x \times d_h}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "–≤—Ö–æ–¥ ‚Üí —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"   |
| $W_{hh}$   | $\mathbb{R}^{d_h \times d_h}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "–ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ" (—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å) |
| $W_{hy}$   | $\mathbb{R}^{d_h \times d_y}$ | –ú–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ "—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí –≤—ã—Ö–æ–¥" |
| $b_h$      | $\mathbb{R}^{d_h}$     | –í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è            |
| $b_y$      | $\mathbb{R}^{d_y}$     | –í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è           |

> **–ó–∞—á–µ–º —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º–∏?** –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –∏ –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ —Å broadcast'–∏–Ω–≥–æ–º –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö —Ç–∏–ø–∞ NumPy/PyTorch).

### **2.3 –î–∏–Ω–∞–º–∏–∫–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞**

–¢–µ–ø–µ—Ä—å –∑–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—ã, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç —à–∞–≥–∞ $t-1$ –∫ —à–∞–≥—É $t$:

$$
\boxed{%
\begin{aligned}
h_t &= \sigma_h\!\bigl(W_{xh}x_t + W_{hh}h_{t-1} + b_h\bigr), & h_0&=\mathbf0,\\[4pt]
y_t &= \sigma_y\!\bigl(W_{hy}h_t + b_y\bigr).
\end{aligned}}
$$

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**

1.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$:**
    *   $W_{xh}x_t$: –í–ª–∏—è–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≤—Ö–æ–¥–∞ $x_t$ –Ω–∞ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
    *   $W_{hh}h_{t-1}$: –í–ª–∏—è–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$ (–ø–∞–º—è—Ç–∏) –Ω–∞ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –≠—Ç–æ **–∫–ª—é—á–µ–≤–∞—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å**.
    *   $b_h$: –°–º–µ—â–µ–Ω–∏–µ (bias).
    *   $\sigma_h$: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **tanh** –∏–ª–∏ **—Å–∏–≥–º–æ–∏–¥—É**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ "—Å–∂–∏–º–∞—é—Ç" –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω ([-1, 1] –¥–ª—è tanh, [0, 1] –¥–ª—è —Å–∏–≥–º–æ–∏–¥—ã), —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.
    *   $h_0 = \mathbf{0}$: –ù–∞—á–∏–Ω–∞–µ–º —Å –Ω—É–ª–µ–≤–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

2.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ $y_t$:**
    *   $W_{hy}h_t$: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$ –≤ –≤—ã—Ö–æ–¥–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
    *   $b_y$: –°–º–µ—â–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è.
    *   $\sigma_y$: –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è. –ï—ë –≤—ã–±–æ—Ä **–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏**:
        *   `softmax`: –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞/—Å–ª–æ–≤–∞ –∏–∑ —Å–ª–æ–≤–∞—Ä—è).
        *   `sigmoid`: –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π).
        *   `id` (–ª–∏–Ω–µ–π–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è, —Ç.–µ. –µ—ë –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ): –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —á–∏—Å–ª–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è).

![Image_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_01.webp)

```python
"""
–≠—Ç–æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (RNN) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å–ª–æ–≤. 
–ö–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏, —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è softmax, –∞ —Ç–∞–∫–∂–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª RNN, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 
–≤—Ö–æ–¥–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ–≤ –∏ –≤—ã–≤–æ–¥–∏—Ç –ø—Ä–æ–≥–Ω–æ–∑—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–ö–æ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É RNN –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –û–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Å–∞ –∏ —Å–º–µ—â–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ 
–æ–ø–µ—Ä–∞—Ü–∏–∏ (one-hot encoding, embedding, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, softmax), –∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–æ–ø-2 –ø—Ä–æ–≥–Ω–æ–∑–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
"""

import numpy as np
import pandas as pd

def softmax(x: np.ndarray) -> np.ndarray:
    """
    Description:
    ---------------
        –í—ã—á–∏—Å–ª—è–µ—Ç softmax –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.

    Args:
    ---------------
        x: –í—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å softmax.

    Returns:
    ---------------
        –ú–∞—Å—Å–∏–≤ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π softmax.

    Raises:
    ---------------
        ValueError: –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç.

    Examples:
    ---------------
        >>> softmax(np.array([1, 2, 3]))
        array([0.09003057, 0.24472847, 0.66524096])
    """
    if x.size == 0:
        raise ValueError("–í—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")

    e = np.exp(x - np.max(x, axis=0, keepdims=True))
    return e / e.sum(axis=0, keepdims=True)

# ---------------- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ ----------------
vocab = ["the", "students", "opened", "their", "books", "laptops", "zoo"]
V = len(vocab)
d_e, d_h = 8, 16  # —Ä–∞–∑–º–µ—Ä—ã embedding –∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

# –°–ª–æ–≤–∞—Ä—å: —Å–ª–æ–≤–æ ‚Üí –∏–Ω–¥–µ–∫—Å
word2idx = {w: i for i, w in enumerate(vocab)}

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤
np.random.seed(0)
E = np.random.randn(d_e, V) * 0.1      # —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
W_e = np.random.randn(d_h, d_e) * 0.1  # —Å–∫—Ä—ã—Ç–æ–µ ‚Üê —ç–º–±–µ–¥–¥–∏–Ω–≥
W_h = np.random.randn(d_h, d_h) * 0.1  # —Å–∫—Ä—ã—Ç–æ–µ ‚Üê —Å–∫—Ä—ã—Ç–æ–µ
b1 = np.zeros((d_h, 1))                # —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è
U = np.random.randn(V, d_h) * 0.1      # –ø—Ä–æ–µ–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–æ–≥–æ ‚Üí –ª–æ–≥–∏—Ç—ã
b2 = np.zeros((V, 1))                  # —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è

# --------------- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü ----------------
df_E = pd.DataFrame(
    E, index=[f"e{i}" for i in range(d_e)], columns=vocab
)
df_We = pd.DataFrame(
    W_e, index=[f"h{i}" for i in range(d_h)], columns=[f"e{j}" for j in range(d_e)]
)
df_Wh = pd.DataFrame(
    W_h, index=[f"h{i}" for i in range(d_h)], columns=[f"h{j}" for j in range(d_h)]
)
df_U = pd.DataFrame(
    U, index=vocab, columns=[f"h{j}" for j in range(d_h)]
)

print("\n–ú–∞—Ç—Ä–∏—Ü–∞ E (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏):")
print(df_E)
print("\n–ú–∞—Ç—Ä–∏—Ü–∞ W_e (—Å–∫—Ä—ã—Ç–æ–µ ‚Üê —ç–º–±–µ–¥–¥–∏–Ω–≥):")
print(df_We)
print("\n–ú–∞—Ç—Ä–∏—Ü–∞ W_h (—Å–∫—Ä—ã—Ç–æ–µ ‚Üê —Å–∫—Ä—ã—Ç–æ–µ):")
print(df_Wh)
print("\n–ú–∞—Ç—Ä–∏—Ü–∞ U (–ø—Ä–æ–µ–∫—Ü–∏—è –Ω–∞ –≤—ã—Ö–æ–¥):")
print(df_U)

# --------------- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª RNN ----------------
sequence = ["the", "students", "opened", "their"]
h_prev = np.zeros((d_h, 1))

print("\n–®–∞–≥  t    –°–ª–æ–≤–æ      –¢–æ–ø‚Äë2 (—Å–ª–æ–≤–æ, –≤–µ—Ä‚Äë—Ç—å)")
print("-" * 60)
for t, word in enumerate(sequence, 1):
    print(f"\n## –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–∞–∑–±–æ—Ä –¥–ª—è t={t}, —Å–ª–æ–≤–æ = '{word}'")

    # 1) One‚Äëhot
    x = np.zeros((V, 1))
    x[word2idx[word], 0] = 1.0
    print("1) One‚Äëhot –≤–µ–∫—Ç–æ—Ä x:")
    print(x.T)

    # 2) Embedding
    e = E @ x
    print("\n2) Embedding e = E @ x:")
    print(e.T)

    # 3) –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    h = np.tanh(W_h @ h_prev + W_e @ e + b1)
    print("\n3) –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ h:")
    print(h.T)

    # 4) –õ–æ–≥–∏—Ç—ã –∏ softmax
    o = U @ h + b2
    y = softmax(o)
    print("\n4) –õ–æ–≥–∏—Ç—ã o = U @ h + b2:")
    print(o.T)
    print("   Softmax y:")
    print(y.T)

    # –¢–æ–ø‚Äë2 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
    top2 = np.argsort(-y.flatten())[:2]
    probs = [(vocab[i], float(y[i])) for i in top2]
    print(f"\n–¢–æ–ø‚Äë2 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞: {probs}")

    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    h_prev = h
```

### **–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ —Å—Ö–µ–º–µ ¬´–ü—Ä–æ—Å—Ç–∞—è RNN‚Äë—è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å¬ª (step by step)**

1. **–ü–æ–¥–∞—á–∞ –≤—Ö–æ–¥–∞**  
   - –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ $t$ –º—ã –∏–º–µ–µ–º —Å–ª–æ–≤–æ –≤ –≤–∏–¥–µ one‚Äëhot –≤–µ–∫—Ç–æ—Ä–∞  
     $$x^{(t)} \in \mathbb{R}^{|V|}$$  
     –≥–¥–µ $|V|$¬†‚Äî —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è.
     
   - –ü—Ä–∏–º–µ—Ä: –¥–ª—è —Å–ª–æ–≤–∞—Ä—è $\{\text{the}, \text{students}, \text{opened}, \dots\}$ —Å–ª–æ–≤–æ ¬´students¬ª –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–æ–º, –≥–¥–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ ¬´students¬ª¬†—Å—Ç–æ–∏—Ç¬†1, –∞ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö¬†‚Äî¬†0.

2. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ embedding**  
   - –£–º–Ω–æ–∂–∞–µ–º one‚Äëhot $x^{(t)}$ –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É –≤–ª–æ–∂–µ–Ω–∏–π  
     $$E \in \mathbb{R}^{d_e \times |V|}$$  
     —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–ª–æ—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä  
     $$e^{(t)} = E \, x^{(t)} \in \mathbb{R}^{d_e}$$

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è**  
   - –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞:  

    $$
      h^{(t)} = \sigma\bigl(W_h \, h^{(t-1)} + W_e \, e^{(t)} + b_1\bigr)
    $$  
     
     –≥–¥–µ  
     - $h^{(t)} \in \mathbb{R}^{d_h}$¬†‚Äî —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —à–∞–≥–µ $t$,  
     - $W_h \in \mathbb{R}^{d_h \times d_h}$¬†‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å–∫—Ä—ã—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é,  
     - $W_e \in \mathbb{R}^{d_h \times d_e}$¬†‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ embedding,  
     - $b_1 \in \mathbb{R}^{d_h}$¬†‚Äî –≤–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏–π,  
     - $\sigma$¬†‚Äî –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å (–æ–±—ã—á–Ω–æ¬†$\tanh$ –∏–ª–∏¬†ReLU).

   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:  

     $$h^{(0)} = \mathbf{0}\quad(\text{–∏–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–π –≤–µ–∫—Ç–æ—Ä}).$$  
   - –ü—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –≤—ã—Ö–æ–¥–∞ –∫ $W_h\,h^{(t-1)} + W_e\,e^{(t)}$ –ø—Ä–∏–±–∞–≤–ª—è–µ—Ç—Å—è —Å–º–µ—â–µ–Ω–∏–µ $b_1$, –∞ –∫ $U\,h^{(t)}$¬†‚Äî —Å–º–µ—â–µ–Ω–∏–µ¬†$b_2$, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø–æ –ª–æ–≥–∏—Ç–∞–º –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è softmax.

4. **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞**  
   - –°—Ç—Ä–æ–∏–º –ª–æ–≥–∏—Ç—ã –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Å–ª–æ–≤–∞—Ä—é:  
     $$
       o^{(t)} = U \, h^{(t)} + b_2,\qquad U\in\mathbb{R}^{|V|\times d_h},\;b_2\in\mathbb{R}^{|V|}.
     $$  
   - –ü—Ä–∏–º–µ–Ω—è–µ–º softmax, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:  
     $$
       \hat y^{(t)} = \mathrm{softmax}\bigl(o^{(t)}\bigr)\in[0,1]^{|V|},\quad\sum_i \hat y^{(t)}_i = 1.
     $$  
   - –í–µ–∫—Ç–æ—Ä $\hat y^{(t)}$ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–µ —Å–ª–æ–≤–æ –º–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º —Å–ª–µ–¥—É—é—â–∏–º –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ $t+1$.

5. **–ü–æ–≤—Ç–æ—Ä—è–µ–º –≤–æ –≤—Ä–µ–º–µ–Ω–∏**  
   - –ú–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤ ($W_{xh}, W_{hh}, W_{hy}$) –∏ –≤–µ–∫—Ç–æ—Ä—ã —Å–º–µ—â–µ–Ω–∏–π ($b_h, b_y$) **–æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –Ω–∞ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–∞—Ö $t$**. –°–µ—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç RNN –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥–ª–∏–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ $T$.

## **3. –û–±—É—á–µ–Ω–∏–µ RNN: Backpropagation Through Time (BPTT)**

–ú—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏, –∫–∞–∫ RNN –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–ø—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥). –ù–æ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ—ë –≤–µ—Å–∞ $W_{xh}, W_{hh}, W_{hy}, b_h, b_y$, —á—Ç–æ–±—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±—ã–ª–∏ —Ç–æ—á–Ω—ã–º–∏? –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–∫–∏, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã ‚Äî **Backpropagation Through Time (BPTT)**.

### **3.1 –ò–¥–µ—è: –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**

–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫, –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å $L$ –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º–æ–¥–µ–ª–∏. –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –≤—ã—Ö–æ–¥ $y_t$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_t$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_{t-1}$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $h_{t-2}$, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ, –≤–ø–ª–æ—Ç—å –¥–æ $h_0$. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤—Å–µ $h_k$ (–¥–ª—è $k < t$) –∑–∞–≤–∏—Å—è—Ç –æ—Ç –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –≤–µ—Å–æ–≤ $W_{hh}$ –∏ $W_{xh}$.

–ò–¥–µ—è BPTT –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã **–º—ã—Å–ª–µ–Ω–Ω–æ "—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å" RNN –≤–æ –≤—Ä–µ–º–µ–Ω–∏** –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª–∏–Ω–æ–π $T$. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å $T$ –∫–æ–ø–∏–π –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —è—á–µ–π–∫–∏ RNN, —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ. –í—Ö–æ–¥ $x_t$ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_{t-1}$ –ø–æ–¥–∞—é—Ç—Å—è –≤ $t$-—é –∫–æ–ø–∏—é, –æ–Ω–∞ –≤—ã–¥–∞–µ—Ç $h_t$ –∏ $y_t$, –∏ $h_t$ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ $(t+1)$-—é –∫–æ–ø–∏—é.

![Image_02](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_02.png)

### **–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ —Å—Ö–µ–º–µ ¬´–ü—Ä–æ—Å—Ç–∞—è RNN‚Äë—è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å¬ª (step by step)**

–ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Ñ—Ä–∞–∑—ã ¬´the students opened their¬ª –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä—è–º–æ–π –∏ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥—ã (BPTT) –≤ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–π RNN-–º–æ–¥–µ–ª–∏.

#### **1. –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (Unrolling)**

- –ö–∞–∂–¥—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –Ω–∞ —Å—Ö–µ–º–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É —à–∞–≥—É $t=0,1,2,3$.  
- –í—Ö–æ–¥—ã: $x_0,x_1,x_2,x_3$ ‚Äî one‚Äëhot –≤–µ–∫—Ç–æ—Ä—ã —Å–ª–æ–≤ ¬´the¬ª, ¬´students¬ª, ¬´opened¬ª, ¬´their¬ª.  
- –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_{-1}$ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω—É–ª—è–º–∏.  
- –°–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_0\ldots h_3$ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ —Ä–µ–±—Ä—É $W_{hh}$.  
- –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∏–∑ $h_t$ —á–µ—Ä–µ–∑ $W_{hy}$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤—ã—Ö–æ–¥ $\hat y_t$.

#### **2. –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ (Forward pass)**

#### **–®–∞–≥ 0 ($t=0$), —Å–ª–æ–≤–æ ¬´the¬ª**

1. **One-hot –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**:  
   $ x_0 $ ‚Äî –µ–¥–∏–Ω–∏—á–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –≥–¥–µ –µ–¥–∏–Ω–∏—Ü–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–æ–≤–∞ ¬´the¬ª.

2. **Embedding (–≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)**:  
   $ e_0 = E\,x_0 $,  
   –≥–¥–µ $ E $ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.

3. **–°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (hidden state)**:  
   $$
   h_0 = \tanh\bigl(W_{xh} e_0 + W_{hh} h_{-1} + b_1\bigr),
   $$  
   –≥–¥–µ:
   - $ W_{xh}, W_{hh} $ ‚Äî –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã,
   - $ b_1 $ ‚Äî —Å–º–µ—â–µ–Ω–∏–µ,
   - $ h_{-1} $ ‚Äî –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–æ–±—ã—á–Ω–æ –Ω—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä).

4. **–í—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏ –∏ softmax**:  
   $$
   o_0 = W_{hy}h_0 + b_2,\quad \hat{y}_0 = \mathrm{softmax}(o_0),
   $$  
   –≥–¥–µ:
   - $ W_{hy} $ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ª–æ–≥–∏—Ç—ã,
   - $ b_2 $ ‚Äî —Å–º–µ—â–µ–Ω–∏–µ,
   - $ \hat{y}_0 $ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–ª–æ–≤–∞—Ä—é.

5. **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (Loss)**:  
   –¶–µ–ª–µ–≤–æ–µ —Å–ª–æ–≤–æ ‚Äî ¬´students¬ª. –ü–æ—Ç–µ—Ä—è –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫:  
   $$
   L_0 = -\log\hat{y}_0[\text{students}].
   $$

#### **–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å**

–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–π–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å** –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∑–∞–¥–∞—á–∏. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ—ë —ç—Ç–∞–ø—ã:

1. **–õ–æ–≥–∏—Ç—ã –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏**:  
   –ú–æ–¥–µ–ª—å –≤—ã–¥–∞—ë—Ç –≤–µ–∫—Ç–æ—Ä –ª–æ–≥–∏—Ç–æ–≤:  
   $$
   o_0 = W_{hy}h_0 + b_2,
   $$  
   –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ softmax:  
   $$
   \hat{y}_0 = \mathrm{softmax}(o_0) \in [0, 1]^{|V|}, \quad \sum_i \hat{y}_0[i] = 1.
   $$

2. **–¶–µ–ª–µ–≤–∞—è –º–µ—Ç–∫–∞**:  
   –¶–µ–ª–µ–≤–∞—è –º–µ—Ç–∫–∞ $ y^{(0)} $ ‚Äî one-hot –≤–µ–∫—Ç–æ—Ä, –≥–¥–µ –µ–¥–∏–Ω–∏—Ü–∞ —Å—Ç–æ–∏—Ç –≤ –ø–æ–∑–∏—Ü–∏–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ ¬´students¬ª:  
   $$
   y^{(0)}_{\text{students}} = 1.
   $$

3. **–ö—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏—è**:  
   –§–æ—Ä–º—É–ª–∞ –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–∏:  
   $$
   L_0 = -\sum_{i=1}^{|V|} y^{(0)}_i \log\hat{y}_0[i] = -\log\hat{y}_0[\text{students}].
   $$

4. **–ò–Ω—Ç—É–∏—Ü–∏—è**:  
   –ß–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞ $ \hat{y}_0[\text{students}] $, —Ç–µ–º –≤—ã—à–µ —à—Ç—Ä–∞—Ñ (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏).

#### **–®–∞–≥ 1 ($t=1$), —Å–ª–æ–≤–æ ¬´students¬ª**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: $x_1$ ‚Üí $e_1$ ‚Üí  
  $$h_1 = \tanh(W_{xh}e_1 + W_{hh}h_0 + b_1).$$  
- –í—ã—Ö–æ–¥ $\hat y_1 = \mathrm{softmax}(W_{hy}h_1+b_2)$,  
  —Ü–µ–ª–µ–≤–æ–µ —Å–ª–æ–≤–æ ¬´opened¬ª, $L_1=-\log\hat y_1[opened]$.

#### **–®–∞–≥ 2 ($t=2$), —Å–ª–æ–≤–æ ¬´opened¬ª**
- $x_2$ ‚Üí $e_2$ ‚Üí  
  $$h_2 = \tanh(W_{xh}e_2 + W_{hh}h_1 + b_1).$$  
- $\hat y_2$, —Ü–µ–ª–µ–≤–æ–π ¬´their¬ª, $L_2=-\log\hat y_2[their]$.

#### **–®–∞–≥ 3 ($t=3$), —Å–ª–æ–≤–æ ¬´their¬ª**
- $x_3$ ‚Üí $e_3$ ‚Üí  
  $$h_3 = \tanh(W_{xh}e_3 + W_{hh}h_2 + b_1).$$  
- $\hat y_3$, —Ü–µ–ª–µ–≤–æ–π ¬´books¬ª, $L_3=-\log\hat y_3[books]$.

- **–°—É–º–º–∞—Ä–Ω–∞—è –ø–æ—Ç–µ—Ä—è**:  
  $$L = L_0 + L_1 + L_2 + L_3.$$  

#### **3. –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (Backward pass ‚Äî BPTT)**

- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ—Ç –∫–∞–∂–¥–æ–π $L_t$ (–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏) –ø—Ä–æ–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑:
  - –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π $W_{hy}$ –∫ —Å–∫—Ä—ã—Ç—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏—è–º,
  - —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ —Å–≤—è–∑–∏ $W_{hh}$ –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º $h_{t-1}$.
- –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∞–∫–∫—É–º—É–ª–∏—Ä—É—é—Ç—Å—è $
  \frac{\partial L}{\partial W_{xh}},
  \frac{\partial L}{\partial W_{hh}},
  \frac{\partial L}{\partial W_{hy}},
  \frac{\partial L}{\partial b_1},
  \frac{\partial L}{\partial b_2}$.
- –í –∏—Ç–æ–≥–µ –≤–µ—Å–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å —É—á—ë—Ç–æ–º –≤–∫–ª–∞–¥–∞ –æ—à–∏–±–æ–∫ —Å–æ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤.

**–í—ã–≤–æ–¥:** BPTT —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç RNN –≤–æ –≤—Ä–µ–º–µ–Ω–∏, –≤—ã—á–∏—Å–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ—à–∏–±–∫–∏ —Å–∫–≤–æ–∑—å –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –æ–±—É—á–µ–Ω–∏–µ —Å —É—á—ë—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤.

–•–æ—Ç—è –º—ã —Å–æ–∑–¥–∞–µ–º $T$ –∫–æ–ø–∏–π –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å: **–≤–µ—Å–∞ $W_{xh}, W_{hh}, W_{hy}$ –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –∫–æ–ø–∏–π**.

#### **3.2 –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**

–û–±—ã—á–Ω–æ –æ–±—â–∞—è –ø–æ—Ç–µ—Ä—è $L$ –¥–ª—è –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å $\ell$ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

$$
L \;=\;\sum_{t=1}^{T}\,\ell\bigl(y_t,\widehat y_t\bigr),
$$

–≥–¥–µ $y_t$ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —à–∞–≥–µ $t$, –∞ $\widehat y_t$ ‚Äî –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Ü–µ–ª—å) –Ω–∞ —à–∞–≥–µ $t$. –§—É–Ω–∫—Ü–∏—è $\ell$ –º–æ–∂–µ—Ç –±—ã—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–µ–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–æ–π (MSE) –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

#### **3.3 –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (–ü—Ä–∏–º–µ—Ä –¥–ª—è $W_{hh}$)**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ–±—â–µ–π –ø–æ—Ç–µ—Ä–∏ $L$ –ø–æ –æ–¥–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É $w$ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã $W_{hh}$. –ò—Å–ø–æ–ª—å–∑—É—è —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –≥—Ä–∞–¥–∏–µ–Ω—Ç $L$ –ø–æ $w$ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –∏–∑ –≤–∫–ª–∞–¥–æ–≤ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —à–∞–≥–∞ $t$:

$$
\frac{\partial L}{\partial w}\;=\; \sum_{t=1}^{T}\,\frac{\partial \ell(y_t, \widehat y_t)}{\partial w}
$$

–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ $\frac{\partial \ell(y_t, \widehat y_t)}{\partial w}$, –Ω–∞–º –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å, –∫–∞–∫ $w$ –≤–ª–∏—è–µ—Ç –Ω–∞ $y_t$. –≠—Ç–æ –≤–ª–∏—è–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$:

$$
\frac{\partial \ell(y_t, \widehat y_t)}{\partial w} = \frac{\partial \ell}{\partial y_t} \frac{\partial y_t}{\partial h_t} \frac{\partial h_t}{\partial w}
$$

–°–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å ‚Äî —ç—Ç–æ $\frac{\partial h_t}{\partial w}$. –°–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç $w$ –Ω–∞–ø—Ä—è–º—É—é (—á–µ—Ä–µ–∑ —á–ª–µ–Ω $W_{hh}h_{t-1}$ –≤ —Ñ–æ—Ä–º—É–ª–µ –¥–ª—è $h_t$) –∏ –∫–æ—Å–≤–µ–Ω–Ω–æ, —á–µ—Ä–µ–∑ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}, h_{t-2}, \dots, h_1$, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Ç–æ–∂–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç $w$.

$$
\frac{\partial h_t}{\partial w} = \underbrace{\frac{\partial h_t}{\partial h_{t-1}}\frac{\partial h_{t-1}}{\partial w}}_{\text{—á–µ—Ä–µ–∑ } h_{t-1}} + \underbrace{\frac{\partial h_t}{\partial w}}_{\text{–ø—Ä—è–º–æ–µ –≤–ª–∏—è–Ω–∏–µ}}
$$

–†–∞—Å–∫—Ä—ã–≤–∞—è —ç—Ç—É —Ä–µ–∫—É—Ä—Å–∏—é –¥–∞–ª—å—à–µ, –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è **—Å—É–º–º—É –ø—É—Ç–µ–π** —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ. –ö–∞–∂–¥—ã–π —Ç–∞–∫–æ–π –ø—É—Ç—å –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ø–∫–æ–±–∏–∞–Ω–æ–≤ $\frac{\partial h_k}{\partial h_{k-1}}$.

$$
\frac{\partial h_k}{\partial h_{k-1}} = \frac{\partial}{\partial h_{k-1}} \sigma_h(W_{xh}x_k + W_{hh}h_{k-1} + b_h) = \operatorname{diag}\!\bigl[\sigma_h'(a_k)\bigr]\,W_{hh}
$$
–≥–¥–µ $a_k = W_{xh}x_k + W_{hh}h_{k-1} + b_h$ ‚Äî –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ $\sigma_h$ –Ω–∞ —à–∞–≥–µ $k$. –û–±–æ–∑–Ω–∞—á–∏–º —ç—Ç–æ—Ç –Ø–∫–æ–±–∏–∞–Ω –∫–∞–∫ $J_k$.

–¢–æ–≥–¥–∞ –≤–∫–ª–∞–¥ –≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ—Ç –ø—É—Ç–∏ –¥–ª–∏–Ω–æ–π $k$ (–æ—Ç $h_{t-k}$ –∫ $h_t$) –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ $k$ —Ç–∞–∫–∏—Ö –Ø–∫–æ–±–∏–∞–Ω–æ–≤: $J_t J_{t-1} \dots J_{t-k+1}$.

#### **3.4 –ü—Ä–æ–±–ª–µ–º—ã: –ó–∞—Ç—É—Ö–∞–Ω–∏–µ –∏ –í–∑—Ä—ã–≤ –ì—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤**

–ò–º–µ–Ω–Ω–æ —ç—Ç–∏ **–¥–ª–∏–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ø–∫–æ–±–∏–∞–Ω–æ–≤** $J_k = \operatorname{diag}[\sigma_h'(a_k)] W_{hh}$ —è–≤–ª—è—é—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–æ–±–ª–µ–º –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ RNN:

1.  **–ó–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (Vanishing Gradient):** –ï—Å–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã $W_{hh}$ (–∏–ª–∏ –Ω–æ—Ä–º—ã –Ø–∫–æ–±–∏–∞–Ω–æ–≤ $J_k$) –ø–æ –º–æ–¥—É–ª—é **–º–µ–Ω—å—à–µ 1**, —Ç–æ –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏ –º–Ω–æ–≥–∏—Ö —Ç–∞–∫–∏—Ö –º–∞—Ç—Ä–∏—Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ –Ω—É–ª—é —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ —Å —Ä–æ—Å—Ç–æ–º $k$. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ—Ç –¥–∞–ª–µ–∫–∏—Ö –ø—Ä–æ—à–ª—ã—Ö —à–∞–≥–æ–≤ ($t-k$ –¥–ª—è –±–æ–ª—å—à–∏—Ö $k$) –ø–æ—á—Ç–∏ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ $W_{hh}$, –∏ —Å–µ—Ç—å –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è **–¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º**. Simple RNN –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω—ã —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–µ.
2.  **–í–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ (Exploding Gradient):** –ï—Å–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è $W_{hh}$ (–∏–ª–∏ –Ω–æ—Ä–º—ã $J_k$) –ø–æ –º–æ–¥—É–ª—é **–±–æ–ª—å—à–µ 1**, —Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ø–∫–æ–±–∏–∞–Ω–æ–≤ –±—É–¥–µ—Ç —Ä–∞—Å—Ç–∏ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ–≥—Ä–æ–º–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —à–∞–≥–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏ –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—é –æ–±—É—á–µ–Ω–∏—è (NaN/Inf –≤ –ø–æ—Ç–µ—Ä—è—Ö –∏–ª–∏ –≤–µ—Å–∞—Ö).

#### **3.5 –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –†–µ—à–µ–Ω–∏—è**

*   **Gradient Clipping:** –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–æ—Ä–º—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞. –ï—Å–ª–∏ $\|\nabla\theta\| > \tau$ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ä–æ–≥), —Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è: $\nabla\theta \leftarrow \frac{\tau}{\|\nabla\theta\|} \nabla\theta$. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å–æ *–≤–∑—Ä—ã–≤–æ–º*, –Ω–æ –Ω–µ —Å *–∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º*.
*   **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤:** –ù–∞–ø—Ä–∏–º–µ—Ä, –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è $W_{hh}$ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –¥–µ—Ä–∂–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –±–ª–∏–∑–∫–∏–º–∏ –∫ 1.
*   **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —è—á–µ–µ–∫:** **LSTM (Long Short-Term Memory)** –∏ **GRU (Gated Recurrent Unit)** –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –±–æ—Ä—å–±—ã —Å –∑–∞—Ç—É—Ö–∞–Ω–∏–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –û–Ω–∏ –≤–≤–æ–¥—è—Ç "–≤–µ–Ω—Ç–∏–ª–∏" (gates), –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –ø–æ—Ç–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ —è—á–µ–π–∫—É, –ø–æ–∑–≤–æ–ª—è—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ –¥–æ–ª–≥–∏–µ –ø–µ—Ä–∏–æ–¥—ã.
*   **–§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ReLU –º–æ–∂–µ—Ç —É—Å—É–≥—É–±–∏—Ç—å –≤–∑—Ä—ã–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, –Ω–æ –º–µ–Ω–µ–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –∑–∞—Ç—É—Ö–∞–Ω–∏—é, —á–µ–º —Å–∏–≥–º–æ–∏–¥–∞/tanh (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ –Ω—É–ª–µ–≤–∞—è). –û–¥–Ω–∞–∫–æ –≤ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —á–∞—Å—Ç–∏ —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç tanh.


## **4. BPTT –Ω–∞ –ü—Ä–∞–∫—Ç–∏–∫–µ: –ö–≤–∞–∑–∏-–∫–æ–¥ –∏ PyTorch**

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (PyTorch, TensorFlow/Keras) —Ä–µ–∞–ª–∏–∑—É—é—Ç BPTT –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –í–∞–º –Ω—É–∂–Ω–æ –ª–∏—à—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É RNN –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (`loss.backward()` –≤ PyTorch).

–í–æ—Ç –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∏–ø–∏—á–Ω—ã–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BPTT –≤ PyTorch (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `tanh` –∫–∞–∫ $\sigma_h$ –∏ –ª–∏–Ω–µ–π–Ω–æ–π $\sigma_y$):

```python
import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F

# --- –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ) ---
T = 10      # –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
batch_size = 32
d_x = 20    # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞
d_h = 50    # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
d_y = 5     # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–∞

# --- –ú–æ–¥–µ–ª—å (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) ---
W_xh = torch.randn(d_x, d_h, requires_grad=True)
W_hh = torch.randn(d_h, d_h, requires_grad=True)
W_hy = torch.randn(d_h, d_y, requires_grad=True)
b_h  = torch.zeros(d_h, requires_grad=True)
b_y  = torch.zeros(d_y, requires_grad=True)
params = [W_xh, W_hh, W_hy, b_h, b_y]

# --- –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö ---
x_sequence = torch.randn(T, batch_size, d_x) # [–í—Ä–µ–º—è, –ë–∞—Ç—á, –ü—Ä–∏–∑–Ω–∞–∫–∏]
y_true_sequence = torch.randn(T, batch_size, d_y)

# --- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä ---
optimizer = optim.Adam(params, lr=0.001)

# --- –¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è (–æ–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è) ---
optimizer.zero_grad()

# == Forward pass (—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ –≤—Ä—É—á–Ω—É—é –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏) ==
h_t = torch.zeros(batch_size, d_h) # –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ h_0
outputs = []
for t in range(T):
    # –§–æ—Ä–º—É–ª–∞ Simple RNN
    h_t = torch.tanh(x_sequence[t] @ W_xh + h_t @ W_hh + b_h)
    y_t = h_t @ W_hy + b_y # –õ–∏–Ω–µ–π–Ω—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
    outputs.append(y_t)

# –°–æ–±–∏—Ä–∞–µ–º –≤—ã—Ö–æ–¥—ã –≤ –æ–¥–∏–Ω —Ç–µ–Ω–∑–æ—Ä [T, Batch, d_y]
y_pred_sequence = torch.stack(outputs)

# == –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—å ==
# –ü—Ä–∏–º–µ—Ä: MSE –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∑–∞—Ç–µ–º —É—Å—Ä–µ–¥–Ω—è–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –±–∞—Ç—á—É
loss = F.mse_loss(y_pred_sequence, y_true_sequence)

# == Backward pass (BPTT) ==
loss.backward() # PyTorch –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã ‚àÇL/‚àÇparams —á–µ—Ä–µ–∑ BPTT

# == –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Gradient Clipping ==
torch.nn.utils.clip_grad_norm_(params, max_norm=1.0) # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞

# == –®–∞–≥ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞ ==
optimizer.step()

print(f"Loss: {loss.item()}")
# print(f"Gradient norm for W_hh: {W_hh.grad.norm().item()}") # –ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

*   PyTorch —Å—Ç—Ä–æ–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ –≤–æ –≤—Ä–µ–º—è forward pass.
*   –ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `loss.backward()`, PyTorch –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ —ç—Ç–æ–º—É –≥—Ä–∞—Ñ—É –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –ø—Ä–∏–º–µ–Ω—è—è —Ü–µ–ø–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ (—Ä–µ–∞–ª–∏–∑—É—è BPTT) –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`requires_grad=True`), –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤–∏—Å–∏—Ç `loss`.
*   `torch.nn.utils.clip_grad_norm_` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤–∑—Ä—ã–≤–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

## **5. –ü—Ä–æ–±–ª–µ–º–∞ –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

–û–¥–Ω–∞ –∏–∑ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–¥–µ–π RNN —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–º–µ—é—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–µ–π, —Ç–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–Ω–∞–Ω–∏—è –æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∫–∞–¥—Ä–µ –≤–∏–¥–µ–æ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ –∫–∞–¥—Ä–∞. –ï—Å–ª–∏ –±—ã RNN –æ–±–ª–∞–¥–∞–ª–∏ —Ç–∞–∫–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é, –æ–Ω–∏ –±—ã–ª–∏ –±—ã —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –ø–æ–ª–µ–∑–Ω—ã. –ù–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ RNN –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–∞–º —Ç–∞–∫—É—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å? –≠—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤.

–ò–Ω–æ–≥–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —Ç–æ–ª—å–∫–æ –Ω–µ–¥–∞–≤–Ω—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —è–∑—ã–∫–æ–≤—É—é –º–æ–¥–µ–ª—å, –ø—ã—Ç–∞—é—â—É—é—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö. –ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ ‚Äú–æ–±–ª–∞–∫–∞ –ø–ª—ã–≤—É—Ç –ø–æ –Ω–µ–±—É‚Äù, –Ω–∞–º –Ω–µ –Ω—É–∂–µ–Ω –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç; –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–æ–≤–æ–ª—å–Ω–æ –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º –±—É–¥–µ—Ç ‚Äú–Ω–µ–±—É‚Äù. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –º–µ–∂–¥—É –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –º–µ—Å—Ç–æ–º, –≥–¥–µ –æ–Ω–∞ –ø–æ–Ω–∞–¥–æ–±–∏–ª–∞—Å—å, –Ω–µ–≤–µ–ª–∏–∫–∞, RNN –º–æ–≥—É—Ç –æ–±—É—á–∏—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ.

–ù–æ –±—ã–≤–∞—é—Ç —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –î–æ–ø—É—Å—Ç–∏–º, –º—ã —Ö–æ—Ç–∏–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ –≤ —Ç–µ–∫—Å—Ç–µ ‚Äú–Ø –≤—ã—Ä–æ—Å –≤–æ –§—Ä–∞–Ω—Ü–∏–∏‚Ä¶ –Ø –±–µ–≥–ª–æ –≥–æ–≤–æ—Ä—é –ø–æ-—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏‚Äù. –ë–ª–∏–∂–∞–π—à–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º –±—É–¥–µ—Ç –Ω–∞–∑—ã–≤–∞–Ω–∏–µ —è–∑—ã–∫–∞, –Ω–æ —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–æ–≥–æ –∏–º–µ–Ω–Ω–æ —è–∑—ã–∫–∞, –Ω–∞–º –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç –§—Ä–∞–Ω—Ü–∏–∏ –∏–∑ –±–æ–ª–µ–µ –æ—Ç–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—à–ª–æ–≥–æ. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ —Ç–æ—á–∫–æ–π –µ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º.

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ —ç—Ç–æ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, RNN —Ç–µ—Ä—è—é—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–≤—è–∑—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

![Image_03](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/RNN/Image_03.png)

–ö —Å—á–∞—Å—Ç—å—é, LSTM –Ω–µ –∑–Ω–∞–µ—Ç —Ç–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º!

## **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏, –æ–±–ª–∞–¥–∞—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –ø–∞–º—è—Ç—å—é –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∫–∞—É–∑–∞–ª—å–Ω–æ—Å—Ç—å—é, –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–∑–∞–º–µ–Ω–∏–º—ã–º–∏ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∑–∞–¥–∞—á –∏ —Å–∏—Ç—É–∞—Ü–∏–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏. –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –±–∞–∑—ã, –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏—ë–º–æ–≤ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π –¥–∞—ë—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ –¥–æ–ø–æ–ª–Ω—è–µ—Ç ¬´—Å–µ–º–µ–π—Å—Ç–≤–æ¬ª Transformer‚Äë–ø–æ–¥–æ–±–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.

</details>

<details> 
    <summary><em><strong>–î–æ–ª–≥–∞—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å (LSTM)</strong></em></summary>

## 1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è

### 1.1 –ò—Å—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∏—è LSTM: –∫–ª—é—á–µ–≤—ã–µ —Ä–∞–±–æ—Ç—ã –•–æ—Ö—Ä–∞–π—Ç–µ—Ä–∞ –∏ –®–º–∏–¥—Ö—É–±–µ—Ä–∞, —Ä–∞–∑–≤–∏—Ç–∏–µ –∏–¥–µ–∏

**–ó–∞—Ä–æ–∂–¥–µ–Ω–∏–µ –∏–¥–µ–∏ (1991-1997)**

–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –±—ã–ª–∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –≤ –Ω–∞—á–∞–ª–µ 1990-—Ö –≥–æ–¥–æ–≤ –°–µ–ø–ø–æ–º –•–æ—Ö—Ä–∞–π—Ç–µ—Ä–æ–º –≤ –µ–≥–æ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ. –•–æ—Ö—Ä–∞–π—Ç–µ—Ä –∏ –Æ—Ä–≥–µ–Ω –®–º–∏–¥—Ö—É–±–µ—Ä –Ω–∞—á–∞–ª–∏ –∏—Å–∫–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–≥–ª–∞ –±—ã –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

**–ö–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã:**

- **1991-1995**: –ü–µ—Ä–≤—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –•–æ—Ö—Ä–∞–π—Ç–µ—Ä –∏ –®–º–∏–¥—Ö—É–±–µ—Ä –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º —Ç–µ—á—å —á–µ—Ä–µ–∑ –¥–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –∑–∞—Ç—É—Ö–∞–Ω–∏—è.

- **1997**: –ü—É–±–ª–∏–∫–∞—Ü–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–∏ "Long Short-Term Memory" –≤ –∂—É—Ä–Ω–∞–ª–µ Neural Computation. –í —ç—Ç–æ–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ –±—ã–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LSTM —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –≤–µ–Ω—Ç–∏–ª–µ–π (gates) –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º –æ—à–∏–±–∫–∏ (Constant Error Carousel, CEC).

**–≠–≤–æ–ª—é—Ü–∏—è LSTM:**

- **1999-2000**: –§–µ–ª–∏–∫—Å –ì–µ—Ä—Å –∏ –µ–≥–æ –∫–æ–ª–ª–µ–≥–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∏ "peephole connections" ‚Äî –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ–Ω—Ç–∏–ª—è–º "–∑–∞–≥–ª—è–¥—ã–≤–∞—Ç—å" –≤ —è—á–µ–π–∫—É –ø–∞–º—è—Ç–∏.

- **2000**: –ì–µ—Ä—Å –∏ –®–º–∏–¥—Ö—É–±–µ—Ä –≤–≤–æ–¥—è—Ç "forget gate" (–≤–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è) ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ LSTM —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å–≤–æ—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã.

- **2005**: –ì—Ä–µ–π–≤—Å –∏ –®–º–∏–¥—Ö—É–±–µ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∏ –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π LSTM (BiLSTM), –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –æ–±–æ–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.

- **2013-2014**: –≠–ø–æ—Ö–∞ —à–∏—Ä–æ–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è LSTM –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.

- **2014**: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ GRU (Gated Recurrent Unit) –∫–æ–º–∞–Ω–¥–æ–π –ß–æ –∫–∞–∫ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã LSTM, —Å–æ—Ö—Ä–∞–Ω—è—é—â–µ–π –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤.

**–¶–∏—Ç–∞—Ç–∞ –®–º–∏–¥—Ö—É–±–µ—Ä–∞ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ LSTM (2015):**

> "–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–ª–∞—Å—å –≤ —Ç–æ–º, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –ª–∏–±–æ –∑–∞—Ç—É—Ö–∞–ª–∏, –ª–∏–±–æ –≤–∑—Ä—ã–≤–∞–ª–∏—Å—å, –∏ –Ω–∞–º –Ω—É–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª–∏–ª–∞ –±—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º —Ç–µ—á—å —á–µ—Ä–µ–∑ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤."

### 1.2 –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞: –ø–æ—á–µ–º—É LSTM —Å—Ç–∞–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏

**1. –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞**

LSTM —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤–æ–µ–º—É —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É –º–µ—Ö–∞–Ω–∏–∑–º—É —è—á–µ–π–∫–∏ –ø–∞–º—è—Ç–∏ —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º–∏ –≤–µ–Ω—Ç–∏–ª—è–º–∏. –ö–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî **–∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –æ—à–∏–±–∫–∏** (Constant Error Carousel, CEC), –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏.

**2. –î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å**

LSTM —Å–ø–æ—Å–æ–±–Ω—ã –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —Å–æ—Ç–Ω–∏ –∏ –¥–∞–∂–µ —Ç—ã—Å—è—á–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤:
- –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–ª–∞–≤–ª–∏–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –±–æ–ª—å—à–∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è—Ö (long-range dependencies)
- –ú–æ–≥—É—Ç –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∑–∞–±—ã–≤–∞—Ç—å –Ω–µ–≤–∞–∂–Ω—É—é
- –ü–æ–∑–≤–æ–ª—è—é—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**3. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö**

LSTM —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
- –¢–µ–∫—Å—Ç –∏ —Ä–µ—á—å (–º–∞—à–∏–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã (—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã, –¥–∞–Ω–Ω—ã–µ —Å–µ–Ω—Å–æ—Ä–æ–≤)
- –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∞–Ω–∞–ª–∏–∑ –î–ù–ö, –±–µ–ª–∫–æ–≤)
- –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ–¥–ø–∏—Å–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º, –≤–∏–¥–µ–æ–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)

**4. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –≥–∏–±–∫–æ—Å—Ç—å**

- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª—É–±–æ–∫–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –ø—É—Ç–µ–º —à—Ç–∞–±–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è LSTM —Å–ª–æ–µ–≤
- –ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º–æ—Å—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∏–ø–∞–º–∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (CNN, Attention)
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏

**5. –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**

–î–æ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ (2017-2018), LSTM –±—ã–ª–∏ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –∏ –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö:

- **Google** (2015-2016): –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª LSTM –≤ —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏, —Å–æ–∫—Ä–∞—Ç–∏–≤ –æ—à–∏–±–∫–∏ –Ω–∞ 30%
- **Apple**: –≤–Ω–µ–¥—Ä–∏–ª LSTM –≤ Siri –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **Facebook**: –ø—Ä–∏–º–µ–Ω—è–ª LSTM –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- **Amazon**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª LSTM –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ø—Ä–æ—Å–∞

–î–∞–∂–µ –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤, LSTM –æ—Å—Ç–∞—é—Ç—Å—è –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–º–∏ –≤ —Ä—è–¥–µ –æ–±–ª–∞—Å—Ç–µ–π:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ó–∞–¥–∞—á–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç—Ä–µ–±—É—é—â–∏–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏

**–≠–≤–æ–ª—é—Ü–∏—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ LSTM** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç—å: –æ—Ç –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –≤ –∫–æ–Ω—Ü–µ 1990-—Ö –¥–æ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ 2010-—Ö, –∏ –ø–æ—Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–Ω–∏–º–∞–Ω–∏—è (attention).

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LSTM: –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### 2.1 –ò–Ω—Ç—É–∏—Ü–∏—è: –ú–µ—Ç–∞—Ñ–æ—Ä–∞ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º–∏ –≤–æ—Ä–æ—Ç–∞–º–∏

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã LSTM, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º –µ–≥–æ –∫–∞–∫ —É–º–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é –ª–∏–Ω–∏—é —Å —Å–∏—Å—Ç–µ–º–æ–π –∫–æ–Ω–≤–µ–π–µ—Ä–æ–≤ –∏ –≤–æ—Ä–æ—Ç:

**1. –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω–≤–µ–π–µ—Ä ‚Äî —è—á–µ–π–∫–∞ –ø–∞–º—è—Ç–∏ (cell state)**

–ö–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç LSTM ‚Äì —ç—Ç–æ **—Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ (cell state)** ‚Äì –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è, –ø—Ä–æ—Ö–æ–¥—è—â–∞—è —á–µ—Ä–µ–∑ –≤—Å—é —Ü–µ–ø–æ—á–∫—É. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –¥–ª–∏–Ω–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä (–∏–ª–∏ –∫–æ–Ω–≤–µ–π–µ—Ä–Ω—É—é –ª–µ–Ω—Ç—É), –∫–æ—Ç–æ—Ä—ã–π —Ç—è–Ω–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≤—Å—é —Ñ–∞–±—Ä–∏–∫—É (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å). –ù–∞ —ç—Ç–æ–º –∫–æ–Ω–≤–µ–π–µ—Ä–µ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π" (cell state, $C_t$).

![Image_01.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_01.png)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏:**  
- –û–Ω–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –≤—Å—é —Ü–µ–ø–æ—á–∫—É, —É—á–∞—Å—Ç–≤—É—è –ª–∏—à—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è—Ö.  
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ —Ç–µ—á—å –ø–æ –Ω–µ–π, –Ω–µ –ø–æ–¥–≤–µ—Ä–≥–∞—è—Å—å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º.  
- –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –¥–æ–ª–≥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ ‚Äî –≤ —ç—Ç–æ–º –≥–ª–∞–≤–Ω—ã–π —Å–µ–∫—Ä–µ—Ç LSTM.  

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, LSTM –º–æ–∂–µ—Ç **—É–¥–∞–ª—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏; —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏, –Ω–∞–∑—ã–≤–∞–µ–º—ã–º–∏ **—Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (gates)**.  

**2. –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –≤–æ—Ä–æ—Ç (gates)**

–ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ (–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–æ—á–∫–µ) –Ω–∞—à –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ç—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞:

- **–í–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è (Forget Gate)**: –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Ñ–∏–ª—å—Ç—Ä, —Ä–µ—à–∞—é—â–∏–π, –∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —É–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Ä–∞–±–æ—á–µ–≥–æ, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ —Ç–µ–∫—É—â–∏–π –≤—Ö–æ–¥, –∞ –∑–∞—Ç–µ–º —Ä–µ—à–∞–µ—Ç, —á—Ç–æ –≤—ã–±—Ä–æ—Å–∏—Ç—å. "–ù–∞–º –≤—Å—ë –µ—â—ë –Ω—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –ø–æ–ª —Å—É–±—ä–µ–∫—Ç–∞, —á—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞—Ç—å –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è? –î–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º. –ê –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–≤–µ—Ç–µ –µ–≥–æ –º–∞—à–∏–Ω—ã? –ù–µ—Ç, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º."

- **–í–µ–Ω—Ç–∏–ª—å –≤—Ö–æ–¥–∞ (Input Gate)**: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –¥—Ä—É–≥–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ, –∫–æ—Ç–æ—Ä—ã–π, –ø–æ—Å–º–æ—Ç—Ä–µ–≤ –Ω–∞ —Ç–µ–∫—É—â–∏–π –≤—Ö–æ–¥ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤—ã—Ö–æ–¥, —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–∏–µ –Ω–æ–≤—ã–µ —Ñ–∞–∫—Ç—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∞–∂–Ω—ã, —á—Ç–æ–±—ã –∏—Ö –∑–∞–ø–æ–º–Ω–∏—Ç—å. "–ú—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ —É–∑–Ω–∞–ª–∏ –∏–º—è –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ —Ä–∞—Å—Å–∫–∞–∑–µ? –≠—Ç–æ –≤–∞–∂–Ω–æ, –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä."

- **–í–µ–Ω—Ç–∏–ª—å –≤—ã—Ö–æ–¥–∞ (Output Gate)**: –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–µ—Ä–µ–¥–∞—Ç—å –≤–Ω–µ—à–Ω–µ–º—É –º–∏—Ä—É (–≤ –≤–∏–¥–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è). –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–µ—Ç—å–µ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. "–ù–∞–º –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ ‚Äî –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –ø–æ–¥–ª–µ–∂–∞—â–µ–µ –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ, –Ω–æ –Ω–µ –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, –æ –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–µ —à–ª–∞ —Ä–µ—á—å —Ä–∞–Ω–µ–µ."

**3. –î–≤–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π**

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤–∞–Ω–∏–ª—å–Ω–æ–π RNN, —É LSTM –µ—Å—Ç—å –¥–≤–µ –ª–∏–Ω–∏–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

- **–Ø—á–µ–π–∫–∞ –ø–∞–º—è—Ç–∏ (Cell State)** $C_t$: –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω–≤–µ–π–µ—Ä, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
- **–°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (Hidden State)** $h_t$: —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —è—á–µ–π–∫–∏ –ø–∞–º—è—Ç–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è —Ç–æ–ª—å–∫–æ —Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é —Å–µ—Ç—å —Å—á–∏—Ç–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç.

**–ú–µ—Ç–∞—Ñ–æ—Ä–∞ —Å –∑–∞–ø–∏—Å–Ω–æ–π –∫–Ω–∏–∂–∫–æ–π:**

–î—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å LSTM ‚Äî —ç—Ç–æ —á–µ–ª–æ–≤–µ–∫ —Å –∑–∞–ø–∏—Å–Ω–æ–π –∫–Ω–∏–∂–∫–æ–π (cell state), –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–µ—à–∞–µ—Ç:
- –ö–∞–∫–∏–µ —Å—Ç–∞—Ä—ã–µ –∑–∞–º–µ—Ç–∫–∏ —Å—Ç–µ—Ä–µ—Ç—å (forget gate)
- –ö–∞–∫–∏–µ –Ω–æ–≤—ã–µ –∑–∞–º–µ—Ç–∫–∏ –∑–∞–ø–∏—Å–∞—Ç—å (input gate)
- –ö–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –∫–Ω–∏–∂–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å (output gate)

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç LSTM –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∫–∞–∫ —É–º–Ω—ã–π –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–π –≤–∞–∂–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—â–∏–π –Ω–µ–≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ ‚Äî –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

### 2.2 –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–î–∞–≤–∞–π—Ç–µ —Ñ–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É LSTM, —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏–≤ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –∫–∞–∫ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ç–∞–∫ –∏ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**

| **–°–∏–º–≤–æ–ª** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|------------|-----------------|--------------|
| $x_t$ | $\mathbb{R}^{d_x}$ | –í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä –Ω–∞ —à–∞–≥–µ $t$ |
| $h_t$ | $\mathbb{R}^{d_h}$ | –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —à–∞–≥–µ $t$ |
| $C_t$ | $\mathbb{R}^{d_h}$ | –°–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ –Ω–∞ —à–∞–≥–µ $t$ |
| $f_t$ | $\mathbb{R}^{d_h}$ | –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è –Ω–∞ —à–∞–≥–µ $t$ |
| $i_t$ | $\mathbb{R}^{d_h}$ | –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–µ–Ω—Ç–∏–ª—è –≤—Ö–æ–¥–∞ –Ω–∞ —à–∞–≥–µ $t$ |
| $o_t$ | $\mathbb{R}^{d_h}$ | –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–µ–Ω—Ç–∏–ª—è –≤—ã—Ö–æ–¥–∞ –Ω–∞ —à–∞–≥–µ $t$ |
| $\tilde{C}_t$ | $\mathbb{R}^{d_h}$ | –ö–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —è—á–µ–π–∫–∏ |

**–í–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏ –≤–µ–∫—Ç–æ—Ä—ã —Å–º–µ—â–µ–Ω–∏—è:**

| **–°–∏–º–≤–æ–ª** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|------------|-----------------|--------------|
| $W_f$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è |
| $W_i$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –≤—Ö–æ–¥–∞ |
| $W_C$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞ |
| $W_o$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –≤—ã—Ö–æ–¥–∞ |
| $b_f$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è |
| $b_i$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –≤—Ö–æ–¥–∞ |
| $b_C$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞ |
| $b_o$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –≤—ã—Ö–æ–¥–∞ |

**–§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**
- $\sigma$: —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ö–æ–¥—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [0, 1]
- $\tanh$: –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ç–∞–Ω–≥–µ–Ω—Å, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ö–æ–¥—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [-1, 1]

**–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**
- $d_x$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $x_t$
- $d_h$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏

**–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≤—Ö–æ–¥–∞ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:**

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –º—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $x_t$ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$:

$$[x_t, h_{t-1}] \in \mathbb{R}^{d_x + d_h}$$

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–µ—Å–∞ –∫–∞–∫ –æ–¥–Ω—É –º–∞—Ç—Ä–∏—Ü—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–µ–Ω—Ç–∏–ª—è, –≤–º–µ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è $x_t$ –∏ $h_{t-1}$.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º:**

1. –í —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ LSTM —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏ $C_t$ —Ä–∞–≤–Ω–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏—è—Ö –æ–Ω–∏ –º–æ–≥—É—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è.

2. –í—Å–µ –≤–µ–Ω—Ç–∏–ª–∏ ($f_t$, $i_t$, $o_t$) –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $d_h$, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏.

3. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º LSTM:
   - –í–µ—Å–∞: $4 \times d_h \times (d_x + d_h)$
   - –°–º–µ—â–µ–Ω–∏—è: $4 \times d_h$
   - –ò—Ç–æ–≥–æ: $4 \times d_h \times (d_x + d_h + 1)$

–≠—Ç–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º—É–ª –∏ –¥–∏–Ω–∞–º–∏–∫–∏ LSTM.

### 2.3 –î–∏–Ω–∞–º–∏–∫–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Ç–æ—á–Ω–æ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã LSTM –Ω–∞ –æ–¥–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ $t$. –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–æ–¥—Ä–æ–±–Ω–æ.

### –í–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è (forget gate)

–í–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è $f_t$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏ $C_{t-1}$ —Å–ª–µ–¥—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –∞ –∫–∞–∫—É—é ‚Äî —Å—Ç–µ—Ä–µ—Ç—å:

$$
f_t = \sigma\big(W_f \cdot [x_t, h_{t-1}] + b_f\big)
$$

–ó–¥–µ—Å—å:
- $[x_t, h_{t-1}]$ ‚Äî –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤—Ö–æ–¥–∞ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- $W_f$ ‚Äî –≤–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è
- $b_f$ ‚Äî –≤–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è
- $\sigma$ ‚Äî —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [0, 1]

–†–µ–∑—É–ª—å—Ç–∞—Ç $f_t$ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–∫—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –º–µ–∂–¥—É 0 –∏ 1, –≥–¥–µ:
- **1** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"
- **0** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±—ã—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"

### **–ü—Ä–∏–º–µ—Ä:** 

–ï—Å–ª–∏ –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –≤–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è –º–æ–∂–µ—Ç "–æ–±–Ω—É–ª–∏—Ç—å" —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏.

![Image_02.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_02.png)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ "–Ø –ª—é–±–ª—é –º–æ—Ä–µ. –ù–∞ –Ω–µ–±–µ —Å–≤–µ—Ç–∏—Ç —Å–æ–ª–Ω—Ü–µ."

1. **–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:**
   - $C_{t-1}$ (—Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏) –∫–æ–¥–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä–≤–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏: [0.8, 0.6, -0.2]
     - 0.8 ‚Üí —Ñ–∞–∫—Ç "–º–æ—Ä–µ" (—Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ)
     - 0.6 ‚Üí —ç–º–æ—Ü–∏—è "–ª—é–±–æ–≤—å"
     - -0.2 ‚Üí –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏–µ "—è"

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–≤–∞ "–ù–∞" (–Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è):**
   - –í—Ö–æ–¥ $x_t$ = embedding —Å–ª–æ–≤–∞ "–ù–∞" [0.1, -0.3, 0.5]
   - $h_{t-1}$ = –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ [0.7, 0.5, -0.1]
   - –í–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç:
     $$
     f_t = \sigma\left(
     \begin{bmatrix}
     0.2 & 0.4 & -0.1 \\
     -0.3 & 0.6 & 0.2 \\
     0.1 & -0.2 & 0.3
     \end{bmatrix}
     \cdot
     \begin{bmatrix}
     0.1 \\ -0.3 \\ 0.5 \\ 0.7 \\ 0.5 \\ -0.1
     \end{bmatrix}
     +
     \begin{bmatrix}
     0.1 \\ -0.2 \\ 0.3
     \end{bmatrix}
     \right) = [0.1, 0.9, 0.8]
     $$
     - –ü–µ—Ä–≤—ã–π –Ω–µ–π—Ä–æ–Ω (0.1) ‚Üí –∑–∞–±—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏–∏ (—É–∂–µ –Ω–µ –Ω—É–∂–Ω–æ)
     - –í—Ç–æ—Ä–æ–π –Ω–µ–π—Ä–æ–Ω (0.9) ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
     - –¢—Ä–µ—Ç–∏–π –Ω–µ–π—Ä–æ–Ω (0.8) ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–º

3. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏:**
   - $C_t = f_t \odot C_{t-1} = [0.1, 0.9, 0.8] \odot [0.8, 0.6, -0.2] = [0.08, 0.54, -0.16]$
     - –ó–Ω–∞—á–µ–Ω–∏–µ 0.8 (–º–æ—Ä–µ) —É–º–µ–Ω—å—à–∏–ª–æ—Å—å –¥–æ 0.08 ‚Üí –∑–∞–±—ã—Ç–æ
     - –≠–º–æ—Ü–∏—è 0.6 —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å –∫–∞–∫ 0.54
     - –ú–µ—Å—Ç–æ–∏–º–µ–Ω–∏–µ -0.2 —Å—Ç–∞–ª–æ -0.016 ‚Üí –ø–æ—á—Ç–∏ –∑–∞–±—ã—Ç–æ

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –ú–æ–¥–µ–ª—å —Ä–µ—à–∏–ª–∞:
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)
- –ó–∞–±—ã—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ –Ω–æ–≤–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (–Ω–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤:**
```
–î–æ forget gate:    [ 0.80  0.60  -0.20 ]
After forget gate: [ 0.08  0.54  -0.02 ]
                   ‚îÇ      ‚îÇ      ‚îî‚îÄ‚îÄ –ü–æ—á—Ç–∏ –∑–∞–±—ã—Ç–æ ("—è")
                   ‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ("–ª—é–±–æ–≤—å")
                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ó–∞–±—ã—Ç–æ ("–º–æ—Ä–µ")
```

---

### –í–µ–Ω—Ç–∏–ª—å –≤—Ö–æ–¥–∞ (input gate)

–í–µ–Ω—Ç–∏–ª—å –≤—Ö–æ–¥–∞ $i_t$ —Ä–µ—à–∞–µ—Ç, –∫–∞–∫—É—é –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏:

$$
i_t = \sigma\big(W_i \cdot [x_t, h_{t-1}] + b_i\big)
$$

–ö–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å –≤–µ–Ω—Ç–∏–ª–µ–º –∑–∞–±—ã–≤–∞–Ω–∏—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [0, 1], –≥–¥–µ:
- **1** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç—É –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"
- **0** –æ–∑–Ω–∞—á–∞–µ—Ç "–Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"

#### –ö–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏

![Image_03.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_03.png)

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –≤–µ–Ω—Ç–∏–ª–µ–º –≤—Ö–æ–¥–∞, —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä $\tilde{C}_t$ ‚Äî "—á–µ—Ä–Ω–æ–≤–∏–∫" –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏:

$$
\tilde{C}_t = \tanh\big(W_C \cdot [x_t, h_{t-1}] + b_C\big)
$$

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è $\tanh$, —á—Ç–æ–±—ã –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-1, 1].

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏

![Image_04.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_04.png)

–¢–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$, –∏—Å–ø–æ–ª—å–∑—É—è –≤–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è, –≤–µ–Ω—Ç–∏–ª—å –≤—Ö–æ–¥–∞ –∏ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä:

$$
C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t
$$

–≥–¥–µ $\odot$ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ (—É–º–Ω–æ–∂–µ–Ω–∏–µ –ê–¥–∞–º–∞—Ä–∞).

–≠—Ç–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∑–º LSTM:
1. $f_t \odot C_{t-1}$ ‚Äî —Å—Ç–∞—Ä–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
2. $i_t \odot \tilde{C}_t$ ‚Äî –Ω–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å

**–í–∞–∂–Ω–æ!** –°–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ç–æ–ª—å–∫–æ –ª–∏–Ω–µ–π–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ —Å–ª–æ–∂–µ–Ω–∏–µ). –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —Ç–µ—á—å —á–µ—Ä–µ–∑ —è—á–µ–π–∫—É –±–µ–∑ –∑–∞—Ç—É—Ö–∞–Ω–∏—è, —Ä–µ—à–∞—è –ø—Ä–æ–±–ª–µ–º—É –≤–∞–Ω–∏–ª—å–Ω—ã—Ö RNN.

### **–ü—Ä–∏–º–µ—Ä:**

–ü—Ä–æ–¥–æ–ª–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ "–Ø –ª—é–±–ª—é –º–æ—Ä–µ. –ù–∞ –Ω–µ–±–µ —Å–≤–µ—Ç–∏—Ç —Å–æ–ª–Ω—Ü–µ." –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è.

1. **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è:**
   - $f_t \odot C_{t-1} = [0.08, 0.54, -0.16]$ ‚Äî —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–≤–∞ "–ù–∞" (–Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è):**
   - –í—Ö–æ–¥ $x_t$ = embedding —Å–ª–æ–≤–∞ "–ù–∞" [0.1, -0.3, 0.5]
   - $h_{t-1}$ = –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ [0.7, 0.5, -0.1]
   
   - –í–µ–Ω—Ç–∏–ª—å –≤—Ö–æ–¥–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç:
     $$
     i_t = \sigma\left(
     \begin{bmatrix}
     0.3 & -0.2 & 0.1 \\
     0.5 & 0.4 & -0.3 \\
     -0.1 & 0.7 & 0.2
     \end{bmatrix}
     \cdot
     \begin{bmatrix}
     0.1 \\ -0.3 \\ 0.5 \\ 0.7 \\ 0.5 \\ -0.1
     \end{bmatrix}
     +
     \begin{bmatrix}
     -0.1 \\ 0.2 \\ 0.1
     \end{bmatrix}
     \right) = [0.7, 0.6, 0.9]
     $$
     
   - –ö–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
     $$
     \tilde{C}_t = \tanh\left(
     \begin{bmatrix}
     0.4 & 0.1 & -0.3 \\
     -0.2 & 0.5 & 0.3 \\
     0.3 & -0.4 & 0.2
     \end{bmatrix}
     \cdot
     \begin{bmatrix}
     0.1 \\ -0.3 \\ 0.5 \\ 0.7 \\ 0.5 \\ -0.1
     \end{bmatrix}
     +
     \begin{bmatrix}
     0.2 \\ -0.1 \\ 0.4
     \end{bmatrix}
     \right) = [0.6, -0.3, 0.7]
     $$
     - –ü–µ—Ä–≤—ã–π –Ω–µ–π—Ä–æ–Ω (0.6) ‚Üí –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–µ "–Ω–µ–±–æ" (—Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ)
     - –í—Ç–æ—Ä–æ–π –Ω–µ–π—Ä–æ–Ω (-0.3) ‚Üí –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
     - –¢—Ä–µ—Ç–∏–π –Ω–µ–π—Ä–æ–Ω (0.7) ‚Üí –ø—Ä–µ–¥–ª–æ–≥ "–Ω–∞" (—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ)

3. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ —Å –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:**
   - $i_t \odot \tilde{C}_t = [0.7, 0.6, 0.9] \odot [0.6, -0.3, 0.7] = [0.42, -0.18, 0.63]$
   
   - –ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏:
     $C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t = [0.08, 0.54, -0.16] + [0.42, -0.18, 0.63] = [0.50, 0.36, 0.47]$
     - –ó–Ω–∞—á–µ–Ω–∏–µ 0.08 (–∑–∞–±—ã—Ç–æ–µ "–º–æ—Ä–µ") + 0.42 (–Ω–æ–≤–æ–µ "–Ω–µ–±–æ") = 0.50 ‚Üí –Ω–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Ç–µ
     - –≠–º–æ—Ü–∏—è 0.54 (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è "–ª—é–±–æ–≤—å") + (-0.18) (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å) = 0.36 ‚Üí —Å–Ω–∏–∂–µ–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –æ–∫—Ä–∞—Å–∫–∏
     - –ó–Ω–∞—á–µ–Ω–∏–µ -0.16 (–ø–æ—á—Ç–∏ –∑–∞–±—ã—Ç–æ–µ "—è") + 0.63 (–Ω–æ–≤–æ–µ "–Ω–∞") = 0.47 ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –æ—Ç —Å—É–±—ä–µ–∫—Ç–∞ –∫ –ª–æ–∫–∞—Ü–∏–∏

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –ú–æ–¥–µ–ª—å:
- –î–æ–±–∞–≤–∏–ª–∞ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ–±–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º
- –°–Ω–∏–∑–∏–ª–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É, –ø–µ—Ä–µ—Ö–æ–¥—è –∫ –±–æ–ª–µ–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–º—É –æ–ø–∏—Å–∞–Ω–∏—é
- –ü–µ—Ä–µ–∫–ª—é—á–∏–ª–∞ —Ñ–æ–∫—É—Å —Å —Å—É–±—ä–µ–∫—Ç–∞ ("—è") –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ ("–Ω–∞")

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤:**
```
–ü–æ—Å–ª–µ forget gate:  [ 0.08  0.54  -0.16 ]
–ù–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:   [ 0.42  -0.18  0.63 ]
–ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: [ 0.50  0.36  0.47 ]
                     ‚îÇ      ‚îÇ      ‚îî‚îÄ‚îÄ –ù–æ–≤—ã–π —Ñ–æ–∫—É—Å (–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ "–Ω–∞")
                     ‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –°–Ω–∏–∂–µ–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ù–æ–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ ("–Ω–µ–±–æ")
```
---

#### –í–µ–Ω—Ç–∏–ª—å –≤—ã—Ö–æ–¥–∞ (output gate)

![Image_05.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_05.png)

–í–µ–Ω—Ç–∏–ª—å –≤—ã—Ö–æ–¥–∞ $o_t$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –≤—ã—Ö–æ–¥–Ω–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

$$
o_t = \sigma\big(W_o \cdot [x_t, h_{t-1}] + b_o\big)
$$

–ö–∞–∫ –∏ –¥—Ä—É–≥–∏–µ –≤–µ–Ω—Ç–∏–ª–∏, $o_t$ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [0, 1].

#### –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

–ù–∞–∫–æ–Ω–µ—Ü, –≤—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$, –ø—Ä–∏–º–µ–Ω—è—è –≤–µ–Ω—Ç–∏–ª—å –≤—ã—Ö–æ–¥–∞ –∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é —è—á–µ–π–∫–∏:

$$
h_t = o_t \odot \tanh(C_t)
$$

–ó–¥–µ—Å—å:
- $\tanh(C_t)$ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏ –¥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ [-1, 1]
- $o_t$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —ç—Ç–æ–≥–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª—å—à–µ

–°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤—ã—Ö–æ–¥–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–º —à–∞–≥–µ, —Ç–∞–∫ –∏ –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ —Å–µ—Ç–∏.

**–ò—Ç–æ–≥: –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–æ—Ä–º—É–ª LSTM**

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –≤–æ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–æ—Ä–º—É–ª, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –æ–¥–∏–Ω —à–∞–≥ LSTM:

$$
\begin{align}
f_t &= \sigma(W_f \cdot [x_t, h_{t-1}] + b_f) \\
i_t &= \sigma(W_i \cdot [x_t, h_{t-1}] + b_i) \\
\tilde{C}_t &= \tanh(W_C \cdot [x_t, h_{t-1}] + b_C) \\
C_t &= f_t \odot C_{t-1} + i_t \odot \tilde{C}_t \\
o_t &= \sigma(W_o \cdot [x_t, h_{t-1}] + b_o) \\
h_t &= o_t \odot \tanh(C_t)
\end{align}
$$

–≠—Ç–∏ —à–µ—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å—ã–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏–∫—É LSTM —è—á–µ–π–∫–∏ –Ω–∞ –æ–¥–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ.

## 3. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ LSTM

### 3.1 –†–æ–ª—å —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π: –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Å–∏–≥–º–æ–∏–¥–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª–µ–π

–°–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ LSTM, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ –≤–µ–Ω—Ç–∏–ª–µ–π. –†–∞–∑–±–µ—Ä–µ–º, –ø–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–µ—Ö –≤–µ–Ω—Ç–∏–ª–µ–π (–∑–∞–±—ã–≤–∞–Ω–∏—è, –≤—Ö–æ–¥–∞ –∏ –≤—ã—Ö–æ–¥–∞).

![Image_06.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_06.jpg)

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:**

$\sigma(x) = \frac{1}{1 + e^{-x}}$

**–ö–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Å–∏–≥–º–æ–∏–¥—ã, –¥–µ–ª–∞—é—â–∏–µ –µ—ë –∏–¥–µ–∞–ª—å–Ω–æ–π –¥–ª—è –≤–µ–Ω—Ç–∏–ª–µ–π:**

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π [0, 1]**
   - –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –≤–µ–Ω—Ç–∏–ª–µ–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é "—Ñ–∏–ª—å—Ç—Ä–∞"
   - –ó–Ω–∞—á–µ–Ω–∏–µ 0 –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"
   - –ó–Ω–∞—á–µ–Ω–∏–µ 1 –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é"
   - –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

2. **–ì–ª–∞–¥–∫–æ—Å—Ç—å –∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–æ—Å—Ç—å**
   - –°–∏–≥–º–æ–∏–¥–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞ –∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞ –Ω–∞ –≤—Å–µ–π –æ–±–ª–∞—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
   - –ï—ë –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –∏–º–µ–µ—Ç –ø—Ä–æ—Å—Ç—É—é —Ñ–æ—Ä–º—É: $\sigma'(x) = \sigma(x) \cdot (1 - \sigma(x))$
   - –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –≤–∞–∂–Ω–æ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏

3. **–ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å –∏ –Ω–∞—Å—ã—â–µ–Ω–∏–µ**
   - –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö $x$ —Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ 1
   - –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö $x$ —Ñ—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ 0
   - –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç "–Ω–∞—Å—ã—â–µ–Ω–∏—è", –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É —Å–µ—Ç–∏

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –≤–µ–Ω—Ç–∏–ª—è—Ö LSTM:**

- **–í–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è ($f_t$)**: —Å–∏–≥–º–æ–∏–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —è—á–µ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å. –ó–Ω–∞—á–µ–Ω–∏–µ 0 –æ–∑–Ω–∞—á–∞–µ—Ç "–∑–∞–±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é", 1 ‚Äî "—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é".

- **–í–µ–Ω—Ç–∏–ª—å –≤—Ö–æ–¥–∞ ($i_t$)**: —Å–∏–≥–º–æ–∏–¥–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ ($\tilde{C}_t$) –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏. –ó–Ω–∞—á–µ–Ω–∏–µ 0 –æ–∑–Ω–∞—á–∞–µ—Ç "–Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–∏—á–µ–≥–æ", 1 ‚Äî "–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é".

- **–í–µ–Ω—Ç–∏–ª—å –≤—ã—Ö–æ–¥–∞ ($o_t$)**: —Å–∏–≥–º–æ–∏–¥–∞ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$. –ó–Ω–∞—á–µ–Ω–∏–µ 0 –æ–∑–Ω–∞—á–∞–µ—Ç "–Ω–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å", 1 ‚Äî "–ø–µ—Ä–µ–¥–∞—Ç—å –≤—Å—ë".

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏–π:**

–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–º–µ—â–µ–Ω–∏—è (bias) –≤–µ–Ω—Ç–∏–ª–µ–π —á–∞—Å—Ç–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º:
- –°–º–µ—â–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è –∑–∞–±—ã–≤–∞–Ω–∏—è ($b_f$) —á–∞—Å—Ç–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1 –∏–ª–∏ 2), —á—Ç–æ–±—ã –≤ –Ω–∞—á–∞–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–µ—Ç—å –±—ã–ª–∞ —Å–∫–ª–æ–Ω–Ω–∞ "–ø–æ–º–Ω–∏—Ç—å" –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –°–º–µ—â–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –≤–µ–Ω—Ç–∏–ª–µ–π –æ–±—ã—á–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –Ω—É–ª—è–º–∏ –∏–ª–∏ –Ω–µ–±–æ–ª—å—à–∏–º–∏ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

–¢–∞–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–º–æ–≥–∞–µ—Ç LSTM –±—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–∞—Ç—å—Å—è —Ä–∞–±–æ—Ç–µ —Å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

### 3.2 –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ tanh: –ï—ë —Ä–æ–ª—å –≤ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–µ –∏ –≤—ã—Ö–æ–¥–µ

–ì–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ç–∞–Ω–≥–µ–Ω—Å (tanh) ‚Äî –≤—Ç–æ—Ä–∞—è –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ LSTM. –û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥–≤—É—Ö –≤–∞–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö: –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞ –∏ –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

![Image_07.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/LSTM/Image_07.jpg)

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ tanh:**

$\tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}$

**–ö–ª—é—á–µ–≤—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ tanh, –≤–∞–∂–Ω—ã–µ –¥–ª—è LSTM:**

1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π [-1, 1]**
   - –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–∏–≥–º–æ–∏–¥—ã, tanh —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—á–∞–ª–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
   - –î–∏–∞–ø–∞–∑–æ–Ω [-1, 1] –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å —Ä–∞–≤–Ω–æ–π –∞–º–ø–ª–∏—Ç—É–¥–æ–π

2. **–ö—Ä—É—Ç–∏–∑–Ω–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞**
   - –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è tanh –≤ –Ω—É–ª–µ —Ä–∞–≤–Ω–∞ 1, —á—Ç–æ –±–æ–ª—å—à–µ, —á–µ–º —É —Å–∏–≥–º–æ–∏–¥—ã (0.25)
   - –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –ø—Ä–∏ –æ–±—Ä–∞—Ç–Ω–æ–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏

3. **–ù—É–ª–µ–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**
   - –í—ã—Ö–æ–¥—ã —Ñ—É–Ω–∫—Ü–∏–∏ tanh –∏–º–µ—é—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ –Ω—É–ª–µ–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
   - –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –±–æ—Ä–æ—Ç—å—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π —Å–º–µ—â–µ–Ω–∏—è –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ (covariate shift)

**–†–æ–ª—å tanh –≤ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–µ $\tilde{C}_t$:**

$\tilde{C}_t = \tanh(W_C \cdot [x_t, h_{t-1}] + b_C)$

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π**
   - tanh –ø—Ä–∏–≤–æ–¥–∏—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [-1, 1], —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É –≤ —è—á–µ–π–∫–µ
   - –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π —Ä–æ—Å—Ç –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —è—á–µ–π–∫–∏

2. **–ë–∏–ø–æ–ª—è—Ä–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
   - –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å "–∏–Ω–≥–∏–±–∏—Ä—É—é—â–∏–µ" —Å–∏–≥–Ω–∞–ª—ã
   - –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å "–≤–æ–∑–±—É–∂–¥–∞—é—â–∏–µ" —Å–∏–≥–Ω–∞–ª—ã
   - –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–≥–∞—Ç–æ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

3. **–ë–∞–ª–∞–Ω—Å —Å —Å–∏–≥–º–æ–∏–¥–æ–π –≤–µ–Ω—Ç–∏–ª—è –≤—Ö–æ–¥–∞**
   - tanh —Å–æ–∑–¥–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç-–∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-1, 1]
   - –°–∏–≥–º–æ–∏–¥–∞ –≤–µ–Ω—Ç–∏–ª—è –≤—Ö–æ–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å —ç—Ç–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ–±–∞–≤–∏—Ç—å
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞–∫ –¥–æ–±–∞–≤–ª—è—Ç—å, —Ç–∞–∫ –∏ –≤—ã—á–∏—Ç–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏

**–†–æ–ª—å tanh –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_t$:**

$h_t = o_t \odot \tanh(C_t)$

1. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Å –±–æ–ª—å—à–æ–π –∞–º–ø–ª–∏—Ç—É–¥–æ–π
   - tanh –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–æ–µ–≤

2. **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–π**
   - tanh –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –≤—ã—Ö–æ–¥ –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ $C_t$
   - –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–æ–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤—Ö–æ–¥–∞–º–∏

3. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –≤—ã—Ö–æ–¥–∞**
   - –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ –∫–∞–∫ –≤—Ö–æ–¥–Ω–æ–π —Å–∏–≥–Ω–∞–ª –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
   - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω [-1, 1] –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**

–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ tanh, –∞ –Ω–µ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ ReLU?

- **ReLU** –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–µ–¥–µ–ª –≤—ã—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–º—É —Ä–æ—Å—Ç—É –∞–∫—Ç–∏–≤–∞—Ü–∏–π
- **Leaky ReLU** –∏–º–µ–µ—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –∏ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –æ—Ç–∫–ª–∏–∫, —á—Ç–æ –º–µ–Ω–µ–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏
- **Sigmoid** –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, —á—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∞—Å–ø–µ–∫—Ç:**

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏—è—Ö LSTM —Ñ—É–Ω–∫—Ü–∏—è tanh –º–æ–∂–µ—Ç –∑–∞–º–µ–Ω—è—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞, –Ω–æ –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π tanh –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –≤—ã–±–æ—Ä–æ–º, –±–ª–∞–≥–æ–¥–∞—Ä—è –µ—ë –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–≤–æ–π—Å—Ç–≤–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ä–æ—à–æ —Å–æ–≥–ª–∞—Å—É—é—Ç—Å—è —Å –ø—Ä–∏—Ä–æ–¥–æ–π –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

### 3.3 –ü–æ—Ç–æ–∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –≤ LSTM: –∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞

–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ LSTM –ø–µ—Ä–µ–¥ –æ–±—ã—á–Ω—ã–º–∏ RNN ‚Äî —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ LSTM —Ä–µ—à–∞–µ—Ç —ç—Ç—É —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Ç–æ–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

**–ù–∞–ø–æ–º–Ω–∏–º –ø—Ä–æ–±–ª–µ–º—É –≤ –≤–∞–Ω–∏–ª—å–Ω—ã—Ö RNN:**

–í –æ–±—ã—á–Ω–æ–π RNN –≥—Ä–∞–¥–∏–µ–Ω—Ç –ø–æ—Ç–µ—Ä–∏ –ø–æ —Å–∫—Ä—ã—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é $h_{t-k}$ –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —è–∫–æ–±–∏–∞–Ω–æ–≤:

$$\frac{\partial h_t}{\partial h_{t-k}} = \prod_{i=t-k+1}^{t} \frac{\partial h_i}{\partial h_{i-1}} = \prod_{i=t-k+1}^{t} \text{diag}(\tanh'(a_i)) \cdot W_{hh}$$

–≠—Ç–∏ —è–∫–æ–±–∏–∞–Ω—ã –æ–±—ã—á–Ω–æ –∏–º–µ—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ–Ω—å—à–µ 1, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É –∑–∞—Ç—É—Ö–∞–Ω–∏—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ $k$.

**–ö–ª—é—á–µ–≤–∞—è –∏–Ω–Ω–æ–≤–∞—Ü–∏—è LSTM: –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –æ—à–∏–±–∫–∏**

–ì–ª–∞–≤–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å LSTM ‚Äî **–ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –æ—à–∏–±–∫–∏ (Constant Error Carousel, CEC)**, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä—è–º—ã–º –ª–∏–Ω–µ–π–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ—Ç–æ–∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ –æ—Ç –º–æ–º–µ–Ω—Ç–∞ $t$ –∫ –º–æ–º–µ–Ω—Ç—É $t-1$:

$$\frac{\partial C_t}{\partial C_{t-1}} = \frac{\partial (f_t \odot C_{t-1} + i_t \odot \tilde{C}_t)}{\partial C_{t-1}} = f_t$$

–≠—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ LSTM: **–≥—Ä–∞–¥–∏–µ–Ω—Ç –æ—Ç $C_t$ –∫ $C_{t-1}$ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ–µ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ–Ω—Ç–∏–ª—å –∑–∞–±—ã–≤–∞–Ω–∏—è $f_t$**. –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∏ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –Ω–∏ –º–∞—Ç—Ä–∏—á–Ω—ã–µ —É–º–Ω–æ–∂–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä—è–º–æ–µ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ.

**–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:**

–ü—Ä–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ $k$ —à–∞–≥–æ–≤ –Ω–∞–∑–∞–¥ –∏–º–µ–µ–º:

$$\frac{\partial C_t}{\partial C_{t-k}} = \prod_{i=t-k+1}^{t} \frac{\partial C_i}{\partial C_{i-1}} = \prod_{i=t-k+1}^{t} f_i$$

–≠—Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤–µ–Ω—Ç–∏–ª–µ–π –∑–∞–±—ã–≤–∞–Ω–∏—è (–ø—Ä–∏–º–µ–Ω—è–µ–º–æ–µ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ).

**–ö–∞–∫ —ç—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞:**

1. **–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ $f_t$**
   - –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã $f_t$ –±–ª–∏–∑–∫–∏ –∫ 1, –≥—Ä–∞–¥–∏–µ–Ω—Ç –ø—Ä–æ—Ç–µ–∫–∞–µ—Ç –ø–æ—á—Ç–∏ –±–µ–∑ –∑–∞—Ç—É—Ö–∞–Ω–∏—è
   - LSTM –æ–±—É—á–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å $f_t \approx 1$ –¥–ª—è –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

2. **–ê–¥–¥–∏—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏**
   - –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤ –≤–∞–Ω–∏–ª—å–Ω—ã—Ö RNN, LSTM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥–¥–∏—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
     $C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t$
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º —Ç–µ—á—å –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ –≤–µ—Å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —Å–≤—è–∑–∏

3. **–ú–µ—Ö–∞–Ω–∏–∑–º –æ–±—É—á–∞–µ–º–æ–≥–æ "–∑–∞–±—ã–≤–∞–Ω–∏—è"**
   - –í–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞—Ç—É—Ö–∞–Ω–∏—è, LSTM –æ–±—É—á–∞–µ—Ç—Å—è —Ç–æ–º—É, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–º–Ω–∏—Ç—å, –∞ —á—Ç–æ –º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å
   - –≠—Ç–æ –∫–∞–∫ –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω—ã–π "—à–ª—é–∑", –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤–∞–∂–Ω—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–µ–≤–∞–∂–Ω—ã–µ

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤:**

–ü–æ–ª–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –ø–æ—Ç–µ—Ä–∏ $L$ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é —è—á–µ–π–∫–∏ $C_{t-k}$ –º–æ–∂–Ω–æ —Ä–∞–∑–ª–æ–∂–∏—Ç—å:

$$\frac{\partial L}{\partial C_{t-k}} = \sum_{j=t-k+1}^{T} \frac{\partial L}{\partial C_j} \frac{\partial C_j}{\partial C_{t-k}}$$

–ó–¥–µ—Å—å –ø–µ—Ä–≤—ã–π —á–ª–µ–Ω $\frac{\partial L}{\partial C_j}$ ‚Äî —ç—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é —è—á–µ–π–∫–∏ –≤ –º–æ–º–µ–Ω—Ç $j$, –∞ –≤—Ç–æ—Ä–æ–π —á–ª–µ–Ω $\frac{\partial C_j}{\partial C_{t-k}}$ ‚Äî —ç—Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª–µ–π –∑–∞–±—ã–≤–∞–Ω–∏—è –ø–æ –ø—É—Ç–∏ –æ—Ç $t-k$ –¥–æ $j$.

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–ª–µ–¥—Å—Ç–≤–∏—è:**

1. **–î–ª–∏–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
   - LSTM –º–æ–∂–µ—Ç –æ–±—É—á–∞—Ç—å—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º –Ω–∞ —Å–æ—Ç–Ω–∏ –∏ –¥–∞–∂–µ —Ç—ã—Å—è—á–∏ —à–∞–≥–æ–≤, —á—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–ª—è –≤–∞–Ω–∏–ª—å–Ω—ã—Ö RNN
   - –ù–∞–ø—Ä–∏–º–µ—Ä, LSTM –º–æ–∂–µ—Ç —Å–≤—è–∑–∞—Ç—å "–§—Ä–∞–Ω—Ü–∏—è" –≤ –Ω–∞—á–∞–ª–µ —Ç–µ–∫—Å—Ç–∞ —Å "—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π" –≤ –∫–æ–Ω—Ü–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –º–µ–∂–¥—É –Ω–∏–º–∏ –±–æ–ª—å—à–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫

2. **–í—ã–±–æ—Ä–æ—á–Ω–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - LSTM –æ–±—É—á–∞–µ—Ç—Å—è –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π —Ç–æ–ª—å–∫–æ –∫ –≤–∞–∂–Ω—ã–º –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º
   - –≠—Ç–æ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, —á–µ–º –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –≤—Å—ë –ø–æ–¥—Ä—è–¥

3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è**
   - –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π –ø–æ—Ç–æ–∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –¥–µ–ª–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ LSTM –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º
   - –†–µ–∂–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è gradient clipping –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LSTM —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º –æ—à–∏–±–∫–∏ —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ –∏ –æ–±—É—á–∞–µ–º—ã–º–∏ –≤–µ–Ω—Ç–∏–ª—è–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### 3.4 –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤–∞–Ω–∏–ª—å–Ω–æ–π RNN: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–∑–≥–ª—è–¥ –Ω–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–º —Å—Ç—Ä–æ–≥–æ–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ LSTM –∏ –≤–∞–Ω–∏–ª—å–Ω–æ–π RNN, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É LSTM —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ.

**1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π**

**–í–∞–Ω–∏–ª—å–Ω–∞—è RNN:**
$h_t = \tanh(W_{xh}x_t + W_{hh}h_{t-1} + b_h)$

**LSTM:**
$
\begin{align}
f_t &= \sigma(W_f \cdot [x_t, h_{t-1}] + b_f) \\
i_t &= \sigma(W_i \cdot [x_t, h_{t-1}] + b_i) \\
\tilde{C}_t &= \tanh(W_C \cdot [x_t, h_{t-1}] + b_C) \\
C_t &= f_t \odot C_{t-1} + i_t \odot \tilde{C}_t \\
o_t &= \sigma(W_o \cdot [x_t, h_{t-1}] + b_o) \\
h_t &= o_t \odot \tanh(C_t)
\end{align}
$

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è:**

- **–û–¥–Ω–æ vs –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–π**: RNN –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–Ω–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ LSTM —Ä–∞–∑–¥–µ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
- **–û–¥–Ω–æ vs –¥–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è**: RNN –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$, —Ç–æ–≥–¥–∞ –∫–∞–∫ LSTM —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–µ–∂–¥—É —Å–∫—Ä—ã—Ç—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º $h_t$ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —è—á–µ–π–∫–∏ $C_t$.
- **–ü—Ä–æ—Å—Ç–æ–µ vs –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: RNN –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å—ë —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ü–µ–ª–∏–∫–æ–º, –∞ LSTM –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏.

**2. –ü–æ—Ç–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**

**–í–∞–Ω–∏–ª—å–Ω–∞—è RNN:**

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç –≤—Ö–æ–¥–∞ $x_{t-k}$ –∫ —Ç–µ–∫—É—â–µ–º—É —Å–∫—Ä—ã—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é $h_t$ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π:

$h_t = F(h_{t-1}, x_t) = F(F(h_{t-2}, x_{t-1}), x_t) = ... = F(F(...F(h_{t-k-1}, x_{t-k})...), x_t)$

–ó–¥–µ—Å—å $F(h, x) = \tanh(W_{xh}x + W_{hh}h + b_h)$. –ö–∞–∂–¥–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏ $\tanh$ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –ø–æ—Ç–µ—Ä–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

**LSTM:**

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç —Ç–µ—á—å —á–µ—Ä–µ–∑ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$ —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º –∑–∞–±—ã–≤–∞–Ω–∏–µ–º:

$C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t = f_t \odot (f_{t-1} \odot C_{t-2} + i_{t-1} \odot \tilde{C}_{t-1}) + i_t \odot \tilde{C}_t = ...$

–†–∞—Å–∫—Ä—ã–≤–∞—è —ç—Ç–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–ª—å—à–µ, –ø–æ–ª—É—á–∞–µ–º:

$C_t = \left( \prod_{j=t-k+1}^{t} f_j \right) \odot C_{t-k} + \sum_{j=t-k+1}^{t} \left( i_j \odot \tilde{C}_j \odot \prod_{l=j+1}^{t} f_l \right)$

–≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$ —è–≤–ª—è–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Å—É–º–º–æ–π –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤—Ö–æ–¥–æ–≤, –≥–¥–µ –≤–µ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è–º–∏ –≤–µ–Ω—Ç–∏–ª–µ–π $f_j$. –ï—Å–ª–∏ –≤—Å–µ $f_j \approx 1$, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–æ—Ç–µ–∫–∞—Ç—å –ø–æ—á—Ç–∏ –±–µ–∑ –∏—Å–∫–∞–∂–µ–Ω–∏–π.

**3. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ—Ç–æ–∫–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤**

**–í–∞–Ω–∏–ª—å–Ω–∞—è RNN:**

–ì—Ä–∞–¥–∏–µ–Ω—Ç –ø–æ—Ç–µ—Ä–∏ $L$ –ø–æ –≤–µ—Å–∞–º $W_{hh}$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ü–µ–ø–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞:

$\frac{\partial L}{\partial W_{hh}} = \sum_{k=1}^{t} \frac{\partial L}{\partial h_t} \frac{\partial h_t}{\partial h_{t-k}} \frac{\partial h_{t-k}}{\partial W_{hh}}$

–ì–¥–µ –≤—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —è–∫–æ–±–∏–∞–Ω–æ–≤:

$\frac{\partial h_t}{\partial h_{t-k}} = \prod_{j=t-k+1}^{t} \frac{\partial h_j}{\partial h_{j-1}} = \prod_{j=t-k+1}^{t} \text{diag}(\tanh'(W_{xh}x_j + W_{hh}h_{j-1} + b_h)) \cdot W_{hh}$

–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –æ–±—ã—á–Ω–æ –º–µ–Ω—å—à–µ 1, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–∞—Ç—É—Ö–∞–Ω–∏—é –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞.

**LSTM:**

–£ LSTM –≥—Ä–∞–¥–∏–µ–Ω—Ç –æ—Ç $C_t$ –∫ $C_{t-k}$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫:

$\frac{\partial C_t}{\partial C_{t-k}} = \prod_{j=t-k+1}^{t} \frac{\partial C_j}{\partial C_{j-1}} = \prod_{j=t-k+1}^{t} f_j$

–ü–æ—Å–∫–æ–ª—å–∫—É $f_j$ ‚Äî —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –æ–±—É—á–µ–Ω–Ω–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–æ—Ç–æ–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, LSTM –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è $f_j \approx 1$ –¥–ª—è –≤–∞–∂–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞.

**4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏**

**–í–∞–Ω–∏–ª—å–Ω–∞—è RNN:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: $d_h \times (d_x + d_h + 1)$
- –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ —à–∞–≥: $O(d_h \times (d_x + d_h))$

**LSTM:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: $4 \times d_h \times (d_x + d_h + 1)$
- –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ —à–∞–≥: $O(4 \times d_h \times (d_x + d_h))$

LSTM —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –Ω–æ —ç—Ç–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º —É–ª—É—á—à–µ–Ω–∏–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –∑–∞–¥–∞—á–∞—Ö —Å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

**5. –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π**

| **–°–≤–æ–π—Å—Ç–≤–æ** | **–í–∞–Ω–∏–ª—å–Ω–∞—è RNN** | **LSTM** |
|--------------|-------------------|----------|
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | 5-10 —à–∞–≥–æ–≤ | –°–æ—Ç–Ω–∏ –∏–ª–∏ —Ç—ã—Å—è—á–∏ —à–∞–≥–æ–≤ |
| –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —à—É–º—É | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |
| –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞–±—ã–≤–∞—Ç—å –Ω–µ–≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è | –í—ã—Å–æ–∫–∞—è |
| –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–∞—Å—à—Ç–∞–±–∞–º | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è |

**6. –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è**

–ï—Å–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å–∫—Ä—ã—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫–∞–∫ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —Ç–æ:

- **–í–∞–Ω–∏–ª—å–Ω–∞—è RNN** —Å–æ–∑–¥–∞–µ—Ç —Å–ª–æ–∂–Ω—É—é –Ω–µ–ª–∏–Ω–µ–π–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –º–æ–≥—É—Ç –±—ã—Å—Ç—Ä–æ —Å—Ö–æ–¥–∏—Ç—å—Å—è –∫ –∞—Ç—Ç—Ä–∞–∫—Ç–æ—Ä–∞–º, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—à–ª—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö.

- **LSTM** —Å–æ–∑–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª—è–µ–º—É—é –¥–∏–Ω–∞–º–∏–∫—É, –≥–¥–µ –≤–∞–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –º–æ–≥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –ø–æ—á—Ç–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –ø–æ–∑–≤–æ–ª—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ç–µ—á—å –Ω–∞ –±–æ–ª—å—à–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –Ω–µ–≤–∞–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Å—Ç—Ä–æ –∑–∞—Ç—É—Ö–∞—Ç—å.

–í —Ü–µ–ª–æ–º, LSTM –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≥–ª—É–±–æ–∫–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã RNN, –∫–æ—Ç–æ—Ä–æ–µ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤–∞–Ω–∏–ª—å–Ω—ã—Ö RNN, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞, —á—Ç–æ –¥–µ–ª–∞–µ—Ç LSTM –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

</details>

<details> 
    <summary><em><strong>–£–ø—Ä–∞–≤–ª—è–µ–º—ã–π —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π –±–ª–æ–∫ (GRU)</strong></em></summary>

## 1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è

### 1.1 –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è GRU: –∏—Å—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–∫ —É–ø—Ä–æ—â–µ–Ω–∏—è LSTM

Gated Recurrent Unit (GRU) ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –º–∏—Ä—É –≤ 2014 –≥–æ–¥—É. GRU –≤–æ–∑–Ω–∏–∫–ª–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –≤ –æ–±–ª–∞—Å—Ç–∏ –Ω–µ–π—Ä–æ–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞, –≤ –ø–µ—Ä–∏–æ–¥, –∫–æ–≥–¥–∞ LSTM (Long Short-Term Memory) —É–∂–µ –∑–∞—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª–∏ —Å–µ–±—è –∫–∞–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

**–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è GRU:**

- **2013-2014**: –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–∑–≤–∏—Ç–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –Ω–µ–π—Ä–æ–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –ú–æ–Ω—Ä–µ–∞–ª—è –Ω–∞—á–∞–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –≤–∞—Ä–∏–∞—Ü–∏—è–º–∏ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–µ—Ç–µ–π.
  
- **–ò—é–Ω—å 2014**: –ö—é–Ω—Ö—ë–Ω –ß–æ –∏ —Å–æ–∞–≤—Ç–æ—Ä—ã –ø—É–±–ª–∏–∫—É—é—Ç —Å—Ç–∞—Ç—å—é ["Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation"](https://arxiv.org/abs/1406.1078), –≤ –∫–æ—Ç–æ—Ä–æ–π –≤–ø–µ—Ä–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ GRU.

- **–°–µ–Ω—Ç—è–±—Ä—å 2014**: –≤ —Å—Ç–∞—Ç—å–µ ["Empirical Evaluation of Gated Recurrent Neural Networks on Sequence Modeling"](https://arxiv.org/abs/1412.3555) –Æ–∞—à–∞ –ß—É–Ω–≥ –∏ –¥—Ä. –ø—Ä–æ–≤–æ–¥—è—Ç –ø–µ—Ä–≤–æ–µ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ LSTM –∏ GRU.

GRU –≤–æ–∑–Ω–∏–∫–ª–∞ –∏–∑ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ LSTM. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–∫–∞–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –º–æ–≥–ª–∞ –±—ã:

- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö
- –ë—ã—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∏ –ø—Ä–æ—â–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –¢—Ä–µ–±–æ–≤–∞—Ç—å –º–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ö–ª—é—á–µ–≤—ã–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º –±—ã–ª–æ —Ç–æ, —á—Ç–æ –Ω–µ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–æ–∂–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã LSTM –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –≠—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ —Å–æ–∑–¥–∞–Ω–∏—é GRU, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ–Ω—Ç–∏–ª–µ–π LSTM –∏ —É–ø—Ä–æ—â–∞–µ—Ç –æ–±—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.

### 1.2 –ê–≤—Ç–æ—Ä—ã –∏ –∫–ª—é—á–µ–≤—ã–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: –†–∞–±–æ—Ç—ã –ß–æ –∏ –∫–æ–ª–ª–µ–≥, —Å–≤—è–∑—å —Å –º–∞—à–∏–Ω–Ω—ã–º –ø–µ—Ä–µ–≤–æ–¥–æ–º

GRU –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω–æ —Å–≤—è–∑–∞–Ω–∞ —Å –∏–º–µ–Ω–µ–º **–ö—é–Ω—Ö—ë–Ω–∞ –ß–æ** (Kyunghyun Cho) –∏ –µ–≥–æ –∫–æ–ª–ª–µ–≥–∞–º–∏ –∏–∑ –ú–æ–Ω—Ä–µ–∞–ª—å—Å–∫–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –≥—Ä—É–ø–ø–∞, —Ä–∞–±–æ—Ç–∞–≤—à–∞—è –Ω–∞–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º GRU, –≤–∫–ª—é—á–∞–ª–∞ —Ç–∞–∫–∏—Ö —É—á—ë–Ω—ã—Ö –∫–∞–∫ –ô–æ—à—É–∞ –ë–µ–Ω–¥–∂–∏–æ (Yoshua Bengio), –î–º–∏—Ç—Ä–∏–π –ë–∞—Ö–¥–∞–Ω–∞—É (Dzmitry Bahdanau) –∏ –¥—Ä—É–≥–∏–µ –≤–∏–¥–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

**–û—Å–Ω–æ–≤–æ–ø–æ–ª–∞–≥–∞—é—â–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:**

1. **"Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation" (–ß–æ –∏ –¥—Ä., 2014)**
   - –ü–µ—Ä–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ GRU –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —ç–Ω–∫–æ–¥–µ—Ä-–¥–µ–∫–æ–¥–µ—Ä –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞
   - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ñ—Ä–∞–∑ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–≤–æ–π RNN –∏ –ø–æ–∫–∞–∑ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–µ–Ω—Ç–∏–ª–µ–π

2. **"Empirical Evaluation of Gated Recurrent Neural Networks on Sequence Modeling" (–ß—É–Ω–≥ –∏ –¥—Ä., 2014)**
   - –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ LSTM –∏ GRU –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏—Ñ–æ–Ω–∏—á–µ—Å–∫–æ–π –º—É–∑—ã–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—á–µ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
   - –í—ã–≤–æ–¥ –æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ GRU —Å LSTM –ø—Ä–∏ –º–µ–Ω—å—à–µ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

3. **"Neural Machine Translation by Jointly Learning to Align and Translate" (–ë–∞—Ö–¥–∞–Ω–∞—É, –ß–æ –∏ –ë–µ–Ω–¥–∂–∏–æ, 2014)**
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ GRU –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞
   - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π GRU –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –≤–Ω–∏–º–∞–Ω–∏—è

**–°–≤—è–∑—å —Å –º–∞—à–∏–Ω–Ω—ã–º –ø–µ—Ä–µ–≤–æ–¥–æ–º:**

–ü–æ—è–≤–ª–µ–Ω–∏–µ GRU —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ä–∞–∑–≤–∏—Ç–∏–µ–º –Ω–µ–π—Ä–æ–Ω–Ω–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ (NMT). –í 2014 –≥–æ–¥—É –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–∫–∞–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º –º–µ—Ç–æ–¥–∞–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞, –∏ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ –º–Ω–æ–≥–æ–æ–±–µ—â–∞—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

GRU –±—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –º–æ–¥–µ–ª–∏ —ç–Ω–∫–æ–¥–µ—Ä-–¥–µ–∫–æ–¥–µ—Ä –¥–ª—è NMT, –≥–¥–µ:
- **–≠–Ω–∫–æ–¥–µ—Ä** –∫–æ–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
- **–î–µ–∫–æ–¥–µ—Ä** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞

–†–∞–±–æ—Ç–∞ –ß–æ –∏ —Å–æ–∞–≤—Ç–æ—Ä–æ–≤ –ø–æ–∫–∞–∑–∞–ª–∞, —á—Ç–æ GRU –º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ GRU –ø–æ–∑–≤–æ–ª—è–ª–∞ –æ–±—É—á–∞—Ç—å –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–µ –º–æ–¥–µ–ª–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –Ω–∞ –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –±—ã–ª–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.

–¶–∏—Ç–∞—Ç–∞ –ö—é–Ω—Ö—ë–Ω–∞ –ß–æ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ GRU:
> "–ú—ã —Å—Ç—Ä–µ–º–∏–ª–∏—Å—å —Å–æ–∑–¥–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—É—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É LSTM, –∫–æ—Ç–æ—Ä–∞—è –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å –ª–µ–≥—á–µ –≤ –æ–±—É—á–µ–Ω–∏–∏ –∏ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö."

### 1.3 –ë–∞–ª–∞–Ω—Å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–ª–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö

–í –Ω–∞—á–∞–ª–µ 2010-—Ö –≥–æ–¥–æ–≤ LSTM —Å—Ç–∞–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–µ-—Ñ–∞–∫—Ç–æ –¥–ª—è –∑–∞–¥–∞—á –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –Ω–æ –æ–Ω–∏ –∏–º–µ–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞–ª–∏ –ø–æ–∏—Å–∫ –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤:

**–ü—Ä–æ–±–ª–µ–º—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é LSTM:**

1. **–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**
   - LSTM –∏–º–µ–µ—Ç —á–µ—Ç—ã—Ä–µ –Ω–∞–±–æ—Ä–∞ –≤–µ—Å–æ–≤ –∏ —Å–º–µ—â–µ–Ω–∏–π (–¥–ª—è –≤–µ–Ω—Ç–∏–ª–µ–π –∑–∞–±—ã–≤–∞–Ω–∏—è, –≤—Ö–æ–¥–∞, –≤—ã—Ö–æ–¥–∞ –∏ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞)
   - –û–±—É—á–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö LSTM –º–æ–¥–µ–ª–µ–π —Ç—Ä–µ–±–æ–≤–∞–ª–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
   - –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—ã–ª–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

2. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è**
   - –ë–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–∑–Ω–∞—á–∞–ª–æ –±–æ–ª—å—à–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
   - LSTM —á–∞—Å—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–ª–∏ –±–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –°–ª–æ–∂–Ω–µ–µ –¥–æ–±–∏—Ç—å—Å—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö

3. **–ü–∞–º—è—Ç—å –∏ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ**
   - –ú–æ–¥–µ–ª–∏ —Å LSTM –∑–∞–Ω–∏–º–∞–ª–∏ –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏
   - –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–ª–æ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - –í—ã—Å–æ–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö

4. **–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ**
   - –°–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LSTM –∑–∞—Ç—Ä—É–¥–Ω—è–ª–∞ –∞–Ω–∞–ª–∏–∑ –µ—ë –ø–æ–≤–µ–¥–µ–Ω–∏—è
   - –ù–µ –≤—Å–µ–≥–¥–∞ –±—ã–ª–æ —è—Å–Ω–æ, –∫–∞–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–Ω–æ—Å—è—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –≤–∫–ª–∞–¥ –≤ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

**–ü–æ—á–µ–º—É –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∏—Å—å –±–æ–ª–µ–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏:**

1. **–†–∞–∑–≤–∏—Ç–∏–µ –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º**
   - –†–æ—Å—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –≤ –º–æ–¥–µ–ª—è—Ö, —Å–ø–æ—Å–æ–±–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
   - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ –±–æ–ª—å—à–∏–º –æ–±—ä–µ–º–∞–º –¥–∞–Ω–Ω—ã—Ö**
   - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–ª–æ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
   - –ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ç–µ—Ö –∂–µ —Ä–µ—Å—É—Ä—Å–∞—Ö

3. **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ —É–ø—Ä–æ—â–µ–Ω–∏—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**
   - –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –Ω–∞—á–∞–ª–∏ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑—É—á–∞—Ç—å, –∫–∞–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã LSTM –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã
   - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã LSTM –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

4. **–°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –≤ –¥–∏–∑–∞–π–Ω–µ**
   - –ü—Ä–∏–Ω—Ü–∏–ø –û–∫–∫–∞–º–∞: –µ—Å–ª–∏ –¥–≤–µ –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–∞—è
   - –ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ —á–∞—Å—Ç–æ –ª—É—á—à–µ –æ–±–æ–±—â–∞—é—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

**–ö–∞–∫ GRU —Ä–µ—à–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–ú–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**
   - GRU –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –¥–≤–∞ –≤–µ–Ω—Ç–∏–ª—è –≤–º–µ—Å—Ç–æ —Ç—Ä–µ—Ö –≤ LSTM
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤–µ–Ω—Ç–∏–ª–µ–π –≤—Ö–æ–¥–∞ –∏ –∑–∞–±—ã–≤–∞–Ω–∏—è –≤ –æ–¥–∏–Ω –≤–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —è—á–µ–π–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏**
   - –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É–ø—Ä–æ—â–µ–Ω–∏—è, GRU —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –ú–µ—Ö–∞–Ω–∏–∑–º –≤–µ–Ω—Ç–∏–ª–µ–π –≤—Å—ë –µ—â—ë –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Å–µ—Ç—å

3. **–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
   - –ù–∞ –º–Ω–æ–≥–∏—Ö –∑–∞–¥–∞—á–∞—Ö GRU –ø–æ–∫–∞–∑–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã–µ —Å LSTM
   - –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –¥–∞–∂–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏–ª–∞ LSTM, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö

GRU –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–∑—è—â–Ω–æ–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏–º—ã–º–∏ –≤ —à–∏—Ä–æ–∫–æ–º —Å–ø–µ–∫—Ç—Ä–µ –∑–∞–¥–∞—á.

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ GRU: –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 2.1 –ò–Ω—Ç—É–∏—Ü–∏—è: –º–µ—Ç–∞—Ñ–æ—Ä–∞ "—ç–∫–æ–Ω–æ–º–Ω–æ–π –ø–∞–º—è—Ç–∏" —Å –¥–≤—É–º—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏

–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–∞ —Ä–∞–±–æ—Ç—ã GRU –¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º –µ—ë –∫–∞–∫ —Å–∏—Å—Ç–µ–º—É "—ç–∫–æ–Ω–æ–º–Ω–æ–π –ø–∞–º—è—Ç–∏" —Å –¥–≤—É–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏. –≠—Ç–∞ –º–µ—Ç–∞—Ñ–æ—Ä–∞ –ø–æ–º–æ–∂–µ—Ç –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ GRU —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.

**–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Å –æ–¥–Ω–æ–π –±–æ–ª—å—à–æ–π –∫–Ω–∏–≥–æ–π (—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ):**

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç LSTM, –≥–¥–µ –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–Ω–∏–≥–∞ –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è (—è—á–µ–π–∫–∞ –ø–∞–º—è—Ç–∏) –∏ —Ä–∞–±–æ—á–∞—è —Ç–µ—Ç—Ä–∞–¥—å –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –∑–∞–º–µ—Ç–æ–∫ (—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ), –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å GRU —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –æ–¥–Ω–æ–π –∫–Ω–∏–≥–æ–π. –í —ç—Ç–æ–π –∫–Ω–∏–≥–µ –æ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Å–ª–µ–¥—É—è –¥–≤—É–º –ø—Ä–æ—Å—Ç—ã–º –ø—Ä–∞–≤–∏–ª–∞–º:

**1. –í–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ (Reset Gate) ‚Äî "–ß—Ç–æ —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å?"**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –µ–≥–æ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞–Ω–∏–π (—Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ –∫–Ω–∏–≥–µ) –∞–∫—Ç—É–∞–ª—å–Ω—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:

- –ö–æ–≥–¥–∞ –≤–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ –±–ª–∏–∑–æ–∫ –∫ 1: "–≠—Ç–∞ —á–∞—Å—Ç—å –º–æ–∏—Ö —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞–Ω–∏–π –≤–∞–∂–Ω–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"
- –ö–æ–≥–¥–∞ –≤–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ –±–ª–∏–∑–æ–∫ –∫ 0: "–≠—Ç–∞ —á–∞—Å—Ç—å –º–æ–∏—Ö –∑–Ω–∞–Ω–∏–π –Ω–µ –∏–º–µ–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —è –µ—ë –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É—é"

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ "–ü–æ–≥–æ–¥–∞ –≤ –ü–∞—Ä–∏–∂–µ...", –∏ –¥–∞–ª–µ–µ —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ "...—Å—Ç–æ–ª–∏—Ü–µ –§—Ä–∞–Ω—Ü–∏–∏", –≤–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å, —á—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ "–ü–∞—Ä–∏–∂–µ" –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π, –∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ "–ø–æ–≥–æ–¥–µ" —É–∂–µ –Ω–µ –≤–∞–∂–Ω–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.

**2. –í–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (Update Gate) ‚Äî "–ù–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É?"**

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –æ–ø—Ä–µ–¥–µ–ª–∏–ª, –∫–∞–∫–∞—è —á–∞—Å—Ç—å —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞–Ω–∏–π –∞–∫—Ç—É–∞–ª—å–Ω–∞, –æ–Ω –¥–æ–ª–∂–µ–Ω —Ä–µ—à–∏—Ç—å, –≤ –∫–∞–∫–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–Ω–∏–≥–∏:

- –ö–æ–≥–¥–∞ –≤–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–ª–∏–∑–æ–∫ –∫ 1: "–Ø –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—é —ç—Ç—É —á–∞—Å—Ç—å –∫–Ω–∏–≥–∏ –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π"
- –ö–æ–≥–¥–∞ –≤–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–ª–∏–∑–æ–∫ –∫ 0: "–Ø —Å–æ—Ö—Ä–∞–Ω—é —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π"

–ù–∞ –ø—Ä–∏–º–µ—Ä–µ —Ç–µ–∫—Å—Ç–∞: –µ—Å–ª–∏ –¥–æ —ç—Ç–æ–≥–æ –≤ –∫–Ω–∏–≥–µ –±—ã–ª–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –†–∏–º–µ, –∞ –Ω–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç –æ –ü–∞—Ä–∏–∂–µ, –≤–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∑–∞–º–µ–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –†–∏–º–µ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ü–∞—Ä–∏–∂–µ.

**–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã GRU –≤ –º–µ—Ç–∞—Ñ–æ—Ä–µ:**

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—É—é –ø–æ—Ä—Ü–∏—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä $x_t$)

2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ä—ã—Ö –∑–Ω–∞–Ω–∏–π**: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–Ω–∏–≥–∏ (—Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$) –≤–∞–∂–Ω—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

3. **–°–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Å—Ç–∞—Ä—ã—Ö –∑–Ω–∞–Ω–∏–π –∏ –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å —Å–æ–∑–¥–∞–µ—Ç —á–µ—Ä–Ω–æ–≤–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä $\tilde{h}_t$)

4. **–†–µ—à–µ–Ω–∏–µ –æ —Å—Ç–µ–ø–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –∏—Å–ø–æ–ª—å–∑—É—è –≤–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å —Ä–µ—à–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞–∂–¥—É—é —á–∞—Å—Ç—å –∫–Ω–∏–≥–∏

5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏**: –∫–Ω–∏–≥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å —É—á–µ—Ç–æ–º —Ä–µ—à–µ–Ω–∏–π –≤–µ–Ω—Ç–∏–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Å–æ–∑–¥–∞–≤–∞—è –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–∏–≥–∏ ($h_t$)

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç LSTM:**

LSTM –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π, –≥–¥–µ –µ—Å—Ç—å:
- –°–∫–ª–∞–¥ –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è (—è—á–µ–π–∫–∞ –ø–∞–º—è—Ç–∏)
- –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª (—Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- –¢—Ä–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏—Ö —Ä–µ—à–µ–Ω–∏—è (—Ç—Ä–∏ –≤–µ–Ω—Ç–∏–ª—è)

GRU —É–ø—Ä–æ—â–∞–µ—Ç —ç—Ç—É —Å–∏—Å—Ç–µ–º—É, –æ–±—ä–µ–¥–∏–Ω—è—è "—Å–∫–ª–∞–¥" –∏ "—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª" –≤ –æ–¥–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –∏ —Å–æ–∫—Ä–∞—â–∞—è —á–∏—Å–ª–æ "—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤" –¥–æ –¥–≤—É—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –±–æ–ª–µ–µ —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ–π, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –µ—ë –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

–≠—Ç–∞ —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å ‚Äî –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ GRU, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ –¥–æ—Å—Ç–∏—á—å —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å LSTM –ø—Ä–∏ –º–µ–Ω—å—à–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç–∞—Ö.

### 2.2 –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π

–î–∞–≤–∞–π—Ç–µ —Ñ–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É GRU, –æ–ø—Ä–µ–¥–µ–ª–∏–≤ –≤—Å–µ –µ—ë –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –∫–∞–∫ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —Ç–∞–∫ –∏ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**

| **–°–∏–º–≤–æ–ª** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|------------|-----------------|--------------|
| $x_t$ | $\mathbb{R}^{d_x}$ | –í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä –Ω–∞ —à–∞–≥–µ $t$ |
| $h_t$ | $\mathbb{R}^{d_h}$ | –°–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —à–∞–≥–µ $t$ |
| $z_t$ | $\mathbb{R}^{d_h}$ | –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–µ–Ω—Ç–∏–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (update gate) –Ω–∞ —à–∞–≥–µ $t$ |
| $r_t$ | $\mathbb{R}^{d_h}$ | –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–µ–Ω—Ç–∏–ª—è —Å–±—Ä–æ—Å–∞ (reset gate) –Ω–∞ —à–∞–≥–µ $t$ |
| $\tilde{h}_t$ | $\mathbb{R}^{d_h}$ | –ö–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä –Ω–æ–≤–æ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è |

**–í–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏ –≤–µ–∫—Ç–æ—Ä—ã —Å–º–µ—â–µ–Ω–∏—è:**

| **–°–∏–º–≤–æ–ª** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|------------|-----------------|--------------|
| $W_z$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| $W_r$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è —Å–±—Ä–æ—Å–∞ |
| $W_h$ | $\mathbb{R}^{d_h \times (d_x + d_h)}$ | –í–µ—Å–∞ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞ |
| $b_z$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| $b_r$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è —Å–±—Ä–æ—Å–∞ |
| $b_h$ | $\mathbb{R}^{d_h}$ | –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞ |

–í –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π —Ñ–æ—Ä–º–µ –∑–∞–ø–∏—Å–∏, –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –≤–µ—Å–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –∏ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

| **–°–∏–º–≤–æ–ª** | **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å** | **–û–ø–∏—Å–∞–Ω–∏–µ** |
|------------|-----------------|--------------|
| $W_{xz}$ | $\mathbb{R}^{d_h \times d_x}$ | –í–µ—Å–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –≤–µ–Ω—Ç–∏–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| $W_{hz}$ | $\mathbb{R}^{d_h \times d_h}$ | –í–µ—Å–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –≤–µ–Ω—Ç–∏–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| $W_{xr}$ | $\mathbb{R}^{d_h \times d_x}$ | –í–µ—Å–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –≤–µ–Ω—Ç–∏–ª–µ —Å–±—Ä–æ—Å–∞ |
| $W_{hr}$ | $\mathbb{R}^{d_h \times d_h}$ | –í–µ—Å–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –≤–µ–Ω—Ç–∏–ª–µ —Å–±—Ä–æ—Å–∞ |
| $W_{xh}$ | $\mathbb{R}^{d_h \times d_x}$ | –í–µ—Å–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–µ |
| $W_{hh}$ | $\mathbb{R}^{d_h \times d_h}$ | –í–µ—Å–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–µ |

–û–±–µ —Ñ–æ—Ä–º—ã –∑–∞–ø–∏—Å–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã, –Ω–æ –∏–Ω–æ–≥–¥–∞ —É–¥–æ–±–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏–∑ –Ω–∏—Ö –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

**–§—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**

- $\sigma$: —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ö–æ–¥—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [0, 1]
- $\tanh$: –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ç–∞–Ω–≥–µ–Ω—Å, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—Ö–æ–¥—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [-1, 1]

**–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

- $d_x$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $x_t$
- $d_h$: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≤—Ö–æ–¥–∞ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:**

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –º—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $x_t$ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$:

$$[x_t, h_{t-1}] \in \mathbb{R}^{d_x + d_h}$$

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—è–º:**

1. –í GRU –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç LSTM, –≥–¥–µ –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ $C_t$.

2. –û–±–∞ –≤–µ–Ω—Ç–∏–ª—è ($z_t$, $r_t$) –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $d_h$, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

3. –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º GRU:
   - –í–µ—Å–∞: $3 \times d_h \times (d_x + d_h)$
   - –°–º–µ—â–µ–Ω–∏—è: $3 \times d_h$
   - –ò—Ç–æ–≥–æ: $3 \times d_h \times (d_x + d_h + 1)$

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ GRU –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ 3/4 —á–∏—Å–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ LSTM, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ —ç—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

### 2.3 –î–∏–Ω–∞–º–∏–∫–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞

–¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Ç–æ—á–Ω–æ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã GRU –Ω–∞ –æ–¥–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ $t$. –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–æ–¥—Ä–æ–±–Ω–æ.

![Image_01.png](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/GRU/Image_01.jpg)

#### –í–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ (reset gate)

–í–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ $r_t$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è $h_{t-1}$ —Å—Ç–æ–∏—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞:

$$
r_t = \sigma\big(W_r \cdot [x_t, h_{t-1}] + b_r\big)
$$

–∏–ª–∏, –≤ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–π —Ñ–æ—Ä–º–µ:

$$
r_t = \sigma\big(W_{xr} \cdot x_t + W_{hr} \cdot h_{t-1} + b_r\big)
$$

–ó–¥–µ—Å—å:
- $[x_t, h_{t-1}]$ ‚Äî –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤—Ö–æ–¥–∞ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- $W_r$ (–∏–ª–∏ $W_{xr}$ –∏ $W_{hr}$) ‚Äî –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è –≤–µ–Ω—Ç–∏–ª—è —Å–±—Ä–æ—Å–∞
- $b_r$ ‚Äî –≤–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è
- $\sigma$ ‚Äî —Å–∏–≥–º–æ–∏–¥–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [0, 1]

–†–µ–∑—É–ª—å—Ç–∞—Ç $r_t$ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–∫—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –º–µ–∂–¥—É 0 –∏ 1, –≥–¥–µ:
- **1** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é —É—á–∏—Ç—ã–≤–∞—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è"
- **0** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è"

**–ü—Ä–∏–º–µ—Ä:** –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ç–µ–∫—Å—Ç–∞, –µ—Å–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç —Ç–µ–º—É, –≤–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ–±—ã "–∑–∞–±—ã—Ç—å" –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ç–µ–º—ã –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞.

#### –í–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (update gate)

–í–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è $z_t$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω:

$$
z_t = \sigma\big(W_z \cdot [x_t, h_{t-1}] + b_z\big)
$$

–∏–ª–∏:

$$
z_t = \sigma\big(W_{xz} \cdot x_t + W_{hz} \cdot h_{t-1} + b_z\big)
$$

–ö–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å –≤–µ–Ω—Ç–∏–ª–µ–º —Å–±—Ä–æ—Å–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ [0, 1], –≥–¥–µ:
- **1** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–æ–≤–æ–π"
- **0** –æ–∑–Ω–∞—á–∞–µ—Ç "–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π"

**–í–∞–∂–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ:** –í–µ–Ω—Ç–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ GRU –∏–≥—Ä–∞–µ—Ç —Ä–æ–ª—å, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤–µ–Ω—Ç–∏–ª–µ–π –∑–∞–±—ã–≤–∞–Ω–∏—è –∏ –≤—Ö–æ–¥–∞ –≤ LSTM. –í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ $z_t$ –æ–∑–Ω–∞—á–∞–µ—Ç "–∑–∞–±—ã—Ç—å" —Å—Ç–∞—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ "–∑–∞–ø–æ–º–Ω–∏—Ç—å" –Ω–æ–≤—É—é.

#### –ö–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

–ö–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä $\tilde{h}_t$ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π "–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ" –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –Ω–æ —Å —É—á–µ—Ç–æ–º —Ç–æ–ª—å–∫–æ —Ç–æ–π —á–∞—Å—Ç–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä—É—é –æ–ø—Ä–µ–¥–µ–ª–∏–ª –≤–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞:

$$
\tilde{h}_t = \tanh\big(W_h \cdot [x_t, r_t \odot h_{t-1}] + b_h\big)
$$

–∏–ª–∏:

$$
\tilde{h}_t = \tanh\big(W_{xh} \cdot x_t + W_{hh} \cdot (r_t \odot h_{t-1}) + b_h\big)
$$

–ó–¥–µ—Å—å:
- $r_t \odot h_{t-1}$ ‚Äî –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –≤–µ–Ω—Ç–∏–ª—è —Å–±—Ä–æ—Å–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- $\tanh$ ‚Äî –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ç–∞–Ω–≥–µ–Ω—Å, –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—â–∏–π –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [-1, 1]

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –í–µ–Ω—Ç–∏–ª—å —Å–±—Ä–æ—Å–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ $h_{t-1}$ –ø–µ—Ä–µ–¥ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞, –∞ –Ω–µ –∫ –ø–æ–ª–Ω–æ–º—É —Å–∫—Ä—ã—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ç–∏ "–∑–∞–±—ã—Ç—å" —á–∞—Å—Ç—å –ø—Ä–æ—à–ª–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

#### –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

–ù–∞–∫–æ–Ω–µ—Ü, –≤—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ $h_t$, –∫–∞–∫ –≤–∑–≤–µ—à–µ–Ω–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –∫–∞–Ω–¥–∏–¥–∞—Ç-–≤–µ–∫—Ç–æ—Ä–∞, –≥–¥–µ –≤–µ—Å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–µ–Ω—Ç–∏–ª–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

$$
h_t = (1 - z_t) \odot h_{t-1} + z_t \odot \tilde{h}_t
$$

–ó–¥–µ—Å—å:
- $(1 - z_t) \odot h_{t-1}$ ‚Äî —á–∞—Å—Ç—å —Å—Ç–∞—Ä–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
- $z_t \odot \tilde{h}_t$ ‚Äî —á–∞—Å—Ç—å –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å

**–í–∞–∂–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ:** –≠—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–∞ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É —Å—Ç–∞—Ä—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º $h_{t-1}$ –∏ –Ω–æ–≤—ã–º –∫–∞–Ω–¥–∏–¥–∞—Ç-—Å–æ—Å—Ç–æ—è–Ω–∏–µ–º $\tilde{h}_t$, –≥–¥–µ $z_t$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ—á–∫—É –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–µ–∫—Ç–æ—Ä–∞.

**–ò—Ç–æ–≥: –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–æ—Ä–º—É–ª GRU**

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, –≤–æ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–æ—Ä–º—É–ª, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –æ–¥–∏–Ω —à–∞–≥ GRU:

$$
\begin{align}
z_t &= \sigma(W_z \cdot [x_t, h_{t-1}] + b_z) \\
r_t &= \sigma(W_r \cdot [x_t, h_{t-1}] + b_r) \\
\tilde{h}_t &= \tanh(W_h \cdot [x_t, r_t \odot h_{t-1}] + b_h) \\
h_t &= (1 - z_t) \odot h_{t-1} + z_t \odot \tilde{h}_t
\end{align}
$$

–≠—Ç–∏ —á–µ—Ç—ã—Ä–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å—ã–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏–∫—É GRU —è—á–µ–π–∫–∏ –Ω–∞ –æ–¥–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º —à–∞–≥–µ.

</details>

<details> 
    <summary><em><strong>SSM</strong></em></summary>

</details>

## **Nemotron-H: –£–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ä—ã–≤ –≤ –≥–∏–±—Ä–∏–¥–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**

![Figure_02](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_&_18/assets/Figure_02.png)

*–†–∏—Å—É–Ω–æ–∫ 2 | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π Nemotron-H-8B/56B. –ü—Ä–∏–º–µ—Ä–Ω–æ 8% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —Å–ª–æ–µ–≤ –≤ –º–æ–¥–µ–ª–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–ª–æ–∏ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è (self-attention); —ç—Ç–∏ —Å–ª–æ–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –≤—Å–µ–π –º–æ–¥–µ–ª–∏. –û—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å –º–æ–¥–µ–ª–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ä–µ–¥—É—é—â–∏—Ö—Å—è —Å–ª–æ–µ–≤ Mamba-2 –∏ FFN.*

–ù–æ–≤–µ–π—à–∏–µ –º–æ–¥–µ–ª–∏ —Å–µ—Ä–∏–∏ Nemotron-H –æ—Ç NVIDIA –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç –Ω–∞—à–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ LLM. –≠—Ç–∞ —Å–µ—Ä–∏—è –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –≤–∫–ª—é—á–∞—é—â–∞—è —Ä–∞–∑–º–µ—Ä—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ 8B –∏ 56B, –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–ª–æ–µ–≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è —Å–ª–æ—è–º–∏ Mamba, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∞–µ—Ç—Å—è:** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º —Ç–æ–≥–æ –∂–µ —Ä–∞–∑–º–µ—Ä–∞ (—Ç–∞–∫–∏–º–∏ –∫–∞–∫ Qwen-2.5-7B/72B –∏ Llama-3.1-8B/70B), –º–æ–¥–µ–ª—å Nemotron-H —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ —Ö–æ—Ä–æ—à–æ –∏–ª–∏ –¥–∞–∂–µ –ª—É—á—à–µ –≤–æ –º–Ω–æ–≥–∏—Ö —Ç–µ—Å—Ç–∞—Ö.
- **–°–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞:** –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –¥–ª–∏–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (–¥–ª–∏–Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö 65536, –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ 1024) —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–æ 3 —Ä–∞–∑.
- **–ò–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —Å–∂–∞—Ç–∏—è:** –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–æ–≤–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–∂–∞—Ç–∏—è –∏ –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏–∏ MiniPuzzle –º–æ–¥–µ–ª—å 56B —Å–∂–∏–º–∞–µ—Ç—Å—è –¥–æ 47B, —Å–æ—Ö—Ä–∞–Ω—è—è —Ç—É –∂–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –Ω–∞ 20%
- **–†–µ—Ü–µ–ø—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ FP8:** –ø–µ—Ä–≤–∞—è –ø–æ–ª–Ω–∞—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é FP8, —Å —Ç–æ–π –∂–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, —á—Ç–æ –∏ BF16

![Table_01](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-17_%26_18/assets/Table_1.png)