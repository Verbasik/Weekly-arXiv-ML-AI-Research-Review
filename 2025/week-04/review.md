# –ü—Ä–µ–µ–º–Ω–∏–∫ BERT: ModernBERT üöÄ

**ModernBERT** ‚Äî –Ω–æ–≤–æ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞, —Å–æ—á–µ—Ç–∞—é—â–µ–µ –≤ —Å–µ–±–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. üåü

## –í–≤–µ–¥–µ–Ω–∏–µ üìú

BERT –±—ã–ª –≤—ã–ø—É—â–µ–Ω –≤ **2018 –≥–æ–¥—É**, –Ω–æ –æ–Ω –¥–æ —Å–∏—Ö –ø–æ—Ä —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, —ç—Ç–æ –≤—Ç–æ—Ä–∞—è –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª—å –Ω–∞ **Hugging Face Hub** —Å –µ–∂–µ–º–µ—Å—è—á–Ω—ã–º–∏ –∑–∞–≥—Ä—É–∑–∫–∞–º–∏ –±–æ–ª–µ–µ **68 –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä–∞–∑**! üöÄ –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –µ–≥–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–µ–ª–∞–µ—Ç –µ–≥–æ –∏–¥–µ–∞–ª—å–Ω—ã–º –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫:

- **–ü–æ–∏—Å–∫** (–Ω–∞–ø—Ä–∏–º–µ—Ä, RAG)
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞)
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º)

–ù–∞–∫–æ–Ω–µ—Ü, —Å–ø—É—Å—Ç—è **6 –ª–µ—Ç**, —É –Ω–∞—Å –µ—Å—Ç—å –∑–∞–º–µ–Ω–∞! üéâ **ModernBERT**. –≠—Ç–æ –Ω–æ–≤–æ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç BERT –∏ –µ–≥–æ –∞–Ω–∞–ª–æ–≥–∏ –∫–∞–∫ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏, —Ç–∞–∫ –∏ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏. üöÄ

ModernBERT –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –¥–µ—Å—è—Ç–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –æ–±–ª–∞—Å—Ç–∏ –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM) –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –∫ –º–æ–¥–µ–ª—è–º –≤ —Å—Ç–∏–ª–µ BERT, –≤–∫–ª—é—á–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è. üß†

–ü–æ–º–∏–º–æ —Ç–æ–≥–æ, —á—Ç–æ ModernBERT —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –∏ —Ç–æ—á–Ω–µ–µ, –æ–Ω —Ç–∞–∫–∂–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–ª–∏–Ω—É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–æ **8 —Ç—ã—Å. —Ç–æ–∫–µ–Ω–æ–≤** (–ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å 512 –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤) –∏ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–¥–æ–≤ –≤ —Å–≤–æ–∏ –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ. üíª

–≠—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—ã–µ –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ä–∞–Ω–µ–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —á–µ—Ä–µ–∑ –æ—Ç–∫—Ä—ã—Ç—É—é –º–æ–¥–µ–ª—å, —Ç–∞–∫–∏–µ –∫–∞–∫:

- **–ö—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–π –ø–æ–∏—Å–∫ –∫–æ–¥–∞**
- **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ IDE**
- **–ù–æ–≤—ã–µ –∫–æ–Ω–≤–µ–π–µ—Ä—ã –ø–æ–∏—Å–∫–∞**, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–∞, –∞ –Ω–µ –Ω–µ–±–æ–ª—å—à–∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤

–ù–æ —á—Ç–æ–±—ã –æ–±—ä—è—Å–Ω–∏—Ç—å, —á–µ–º –∏–º–µ–Ω–Ω–æ –º—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è, –¥–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —à–∞–≥ –Ω–∞–∑–∞–¥ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –æ—Ç–∫—É–¥–∞ –º—ã –ø—Ä–∏—à–ª–∏. üîç

> –ú—ã –æ–∂–∏–¥–∞–µ–º, —á—Ç–æ ModernBERT —Å—Ç–∞–Ω–µ—Ç –Ω–æ–≤—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤–æ –º–Ω–æ–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –≥–¥–µ —Å–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–∞—Ö **RAG** (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –ø–æ–∏—Å–∫–æ–º) –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. üìä

## –¢–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å –¥–µ–∫–æ–¥–µ—Ä–∞ ü§ñ

–ù–µ–¥–∞–≤–Ω–∏–µ –≥—Ä–æ–º–∫–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ –æ–±–ª–∞—Å—Ç–∏ LLM –±—ã–ª–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –Ω–∞ —Ç–∞–∫–∏—Ö –º–æ–¥–µ–ª—è—Ö, –∫–∞–∫ **GPT**, **Claude**, **Llama**, **Mistral** –∏ **DeepSeek**. –≠—Ç–æ –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏. –ò—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç, –ø–æ—Ö–æ–∂–∏–π –Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π, –ø—Ä–∏–≤–µ–ª–∞ –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é –Ω–æ–≤—ã—Ö —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è **GenAI**, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç. üé®üí¨

–≠—Ç–∏ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏–≤–ª–µ–∫–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, –ø—Ä–æ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–ª–∏ –±—É—Ä–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–≤–µ–ª–∏ –∫ –±—ã—Å—Ç—Ä–æ–º—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º—É –ø—Ä–æ–≥—Ä–µ—Å—Å—É. –ü–æ —Å—É—Ç–∏, –º—ã –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ —ç—Ç–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤. üöÄ

**–ü–æ—á–µ–º—É?** –ü–æ—Ç–æ–º—É —á—Ç–æ –¥–ª—è –º–Ω–æ–≥–∏—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏ –º–æ—â–Ω–∞—è –º–æ–¥–µ–ª—å! –ò —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å. üí°

–ì—Ä—É–±–æ –≥–æ–≤–æ—Ä—è, –º–æ–¥–µ–ª–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–µ–∫–æ–¥–µ—Ä–∞—Ö, —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫–∏, —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω—ã, —Å–ª–∏—à–∫–æ–º –∑–∞–ø–∞—Ç–µ–Ω—Ç–æ–≤–∞–Ω—ã –∏ —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–∏ –¥–ª—è –º–Ω–æ–≥–∏—Ö –∑–∞–¥–∞—á. –£—á—Ç–∏—Ç–µ, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω—ã–π **GPT-1** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª —Å–æ–±–æ–π –º–æ–¥–µ–ª—å —Å–æ **117 –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**. –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, –º–æ–¥–µ–ª—å **Llama 3.1** –∏–º–µ–µ—Ç **405 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**, –∞ –µ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥—ã —Å–∏–Ω—Ç–µ–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã –∏ –¥–æ—Ä–æ–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –∫–æ–º–ø–∞–Ω–∏–π. üí∏

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫—É—é ‚Äã‚Äã–º–æ–¥–µ–ª—å, –∫–∞–∫ **ChatGPT**, –≤–∞–º –Ω—É–∂–Ω–æ –∑–∞–ø–ª–∞—Ç–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é –∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç API –æ—Ç —Ç—è–∂–µ–ª–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å. ‚è≥

–ö–æ–Ω–µ—á–Ω–æ, –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç—Ç–∏—Ö –æ–≥—Ä–æ–º–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å –Ω–µ–æ—Ö–æ—Ç–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–ª—è –Ω–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∏–ª–∏ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è. –≠—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø–∏—Å–∞—Ç—å –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º, –∞ –∑–∞—Ç–µ–º‚Ä¶ –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç—å –º–æ–¥–µ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é. –ù–æ —Ö–æ—Ç—è —ç—Ç–æ—Ç —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –≤—ã –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–µ –∫ —Å–µ—Ä–∏–π–Ω–æ–º—É –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É, –≤–∞–º –Ω–µ –∑–∞—Ö–æ—á–µ—Ç—Å—è –ø–ª–∞—Ç–∏—Ç—å —Ü–µ–Ω—É –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞. üíº

–ü–æ–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ **GenAI** –∑–∞—Ç–º–∏–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–µ—Ä–æ–≤. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ —Ä–µ–∞–ª—å–Ω–æ–π —è–∑—ã–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∏ —ç—Ç–∏ –º–æ–¥–µ–ª–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –º–Ω–æ–≥–∏—Ö –Ω–∞—É—á–Ω—ã—Ö –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –¥–ª—è —Ç–∞–∫–∏—Ö —Ä–∞–±–æ—á–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫. üßë‚Äçüíª

## –¢–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å –∫–æ–¥–µ—Ä–∞ üõ†Ô∏è

–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Å–ø–∏—Å–æ–∫ —á–∏—Å–µ–ª (–≤–µ–∫—Ç–æ—Ä –≤–Ω–µ–¥—Ä–µ–Ω–∏—è). –ú–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤–º–µ—Å—Ç–æ –æ—Ç–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–æ–º –º–æ–¥–µ–ª—å –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –∫–æ–¥–∏—Ä—É–µ—Ç —Å–≤–æ–π ¬´–æ—Ç–≤–µ—Ç¬ª –≤ —ç—Ç–æ–π —Å–∂–∞—Ç–æ–π —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–µ. –≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∂–∞—Ç–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏, –ø–æ—ç—Ç–æ–º—É –º–æ–¥–µ–ª–∏, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, –∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç –º–æ–¥–µ–ª—è–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. üìä

–•–æ—Ç—è –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, GPT) –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–µ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BERT), –æ–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º: –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ —è–≤–ª—è—é—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, –∏–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ ¬´–Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ¬ª ¬´–∑–∞–≥–ª—è–¥—ã–≤–∞—Ç—å¬ª –∑–∞ —Ç–æ–∫–µ–Ω. –û–Ω–∏ –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–∑–∞–¥. –í —ç—Ç–æ–º –æ—Ç–ª–∏—á–∏–µ –æ—Ç –º–æ–¥–µ–ª–µ–π, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—É—á–µ–Ω—ã –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤–ø–µ—Ä–µ–¥ –∏ –Ω–∞–∑–∞–¥ (–≤ –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞. –û–Ω–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã. üöÄ

–ü–æ —Å—É—Ç–∏, –ø–µ—Ä–µ–¥–æ–≤—ã–µ –º–æ–¥–µ–ª–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ **O1** –æ—Ç **OpenAI**, –ø–æ—Ö–æ–∂–∏ –Ω–∞ **Ferrari SF-23**. –≠—Ç–æ —è–≤–Ω–æ —Ç—Ä–∏—É–º—Ñ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π –º—ã—Å–ª–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è –ø–æ–±–µ–¥—ã –≤ –≥–æ–Ω–∫–∞—Ö, –ø–æ—ç—Ç–æ–º—É –º—ã –æ –Ω–µ–º –∏ –≥–æ–≤–æ—Ä–∏–º. –ù–æ –¥–ª—è –∑–∞–º–µ–Ω—ã —à–∏–Ω—ã –Ω—É–∂–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ä–µ–º–æ–Ω—Ç–Ω–∞—è –±—Ä–∏–≥–∞–¥–∞, –∞ –∫—É–ø–∏—Ç—å –µ–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è. –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª—å **BERT** –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ **Honda Civic**. –≠—Ç–æ —Ç–∞–∫–∂–µ —Ç—Ä–∏—É–º—Ñ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π –º—ã—Å–ª–∏, –Ω–æ –±–æ–ª–µ–µ —Ç–æ–Ω–∫–∏–π, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–º, —ç–∫–æ–Ω–æ–º–∏—á–Ω—ã–º, –Ω–∞–¥–µ–∂–Ω—ã–º –∏ –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã–º. –ü–æ—ç—Ç–æ–º—É –æ–Ω–∏ –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ–∑–¥–µ. üöó

# –ë—É–¥–µ—Ç –æ—á–µ–Ω—å –¥—É—à–Ω–æ, —ç—Ç–æ—Ç –±–ª–æ–∫ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å üòå

<details>
  <summary>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å</summary>

### –í—Å–ø–æ–º–Ω–∏–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é –∫–æ–¥–µ—Ä ü§ñ

> –í —ç—Ç–æ–º –±–ª–æ–∫–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∞ –±–∞–∑–æ–≤–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–µ—Ä–∞ –∏ –¥–µ–∫–æ–¥–µ—Ä–∞. –¢–∞–∫ –∂–µ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å –º–µ–∂–¥—É —Å—Ç–∞—Ä–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π BERT –∏ –Ω–æ–≤–æ–π Moder Bert, —Ç–∞–∫ –∫–∞–∫ ModernBERT –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é BERT —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –≤–∫–ª—é—á–∞—è RoPE, GeGLU, Flash Attention –∏ –¥—Ä—É–≥–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

–í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞, –æ–ø–∏—Å–∞–Ω–Ω–æ–π –≤ —Å—Ç–∞—Ç—å–µ ¬´–í–Ω–∏–º–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –≤—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ¬ª, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏: –∫–æ–¥–µ—Ä –∏ –¥–µ–∫–æ–¥–µ—Ä. –û–±–µ —á–∞—Å—Ç–∏ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Å–ª–æ–µ–≤, –∏–º–µ—é—â–∏—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–æ —Å–ª—É–∂–∞—â–∏—Ö —Ä–∞–∑–Ω—ã–º —Ü–µ–ª—è–º.

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ Transformer. –û–Ω–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π: **–∫–æ–¥–µ—Ä–∞ (encoder)** –∏ **–¥–µ–∫–æ–¥–µ—Ä–∞ (decoder)**.

![Figure_1](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-04/assets/Figure_1.png)

### –ö–æ–¥–µ—Ä (Encoder)
–ö–æ–¥–µ—Ä –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ª–µ–≤–æ–π —á–∞—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –û–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–µ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤–∫–ª—é—á–∞–µ—Ç:
1. **Multi-Head Attention** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
2. **Add & Norm** ‚Äî —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤–Ω–∏–º–∞–Ω–∏—è (residual connection) –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é.
3. **Feed Forward** ‚Äî –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.
4. **Add & Norm** ‚Äî —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç.

–≠—Ç–∏ —Å–ª–æ–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–æ–±—ã—á–Ω–æ 6 –∏–ª–∏ –±–æ–ª–µ–µ) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–ª—É–±–æ–∫–æ–π –º–æ–¥–µ–ª–∏.

### –î–µ–∫–æ–¥–µ—Ä (Decoder)
–î–µ–∫–æ–¥–µ—Ä –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –û–Ω —Ç–∞–∫–∂–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª–æ–µ–≤, –Ω–æ –∏–º–µ–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **Masked Multi-Head Attention** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –º–∞—Å–∫–∏—Ä—É–µ—Ç –±—É–¥—É—â–∏–µ —Ç–æ–∫–µ–Ω—ã, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å "–ø–æ–¥–≥–ª—è–¥—ã–≤–∞–Ω–∏–µ" –≤–ø–µ—Ä–µ–¥.
2. **Add & Norm** ‚Äî —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤–Ω–∏–º–∞–Ω–∏—è –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç.
3. **Multi-Head Attention** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—ã—Ö–æ–¥ –∫–æ–¥–µ—Ä–∞.
4. **Add & Norm** ‚Äî —Å–Ω–æ–≤–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç.
5. **Feed Forward** ‚Äî –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Ç–æ–º—É, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–µ.
6. **Add & Norm** ‚Äî –∑–∞–≤–µ—Ä—à–∞—é—â–∏–π —Å–ª–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

### –í—Ö–æ–¥—ã –∏ –≤—ã—Ö–æ–¥—ã
- **Input Embedding** –∏ **Positional Encoding** –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –≤—Ö–æ–¥–Ω—ã–º –¥–∞–Ω–Ω—ã–º, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–∞—é—Ç—Å—è –≤ –∫–æ–¥–µ—Ä.
- **Output Embedding** –∏ **Outputs (shifted right)** –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –≤—ã—Ö–æ–¥–Ω—ã–º –¥–∞–Ω–Ω—ã–º, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –¥–µ–∫–æ–¥–µ—Ä–æ–º.

### **–ö–æ–¥–µ—Ä**:

#### –†–æ–ª–∏:
–†–æ–ª—å –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –æ—Ç—Ä–∞–∂–∞—é—â–µ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞–º–∏ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏). –≠—Ç–∞ —á–∞—Å—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ–¥–µ—Ä.

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:
–ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–¥–µ—Ä–∞ –∏–º–µ–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è –∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏. –ú–µ—Ö–∞–Ω–∏–∑–º —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∫–æ–¥–µ—Ä–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è –∫–æ–¥–µ—Ä–∞ ‚Äî —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–Ω –º–æ–∂–µ—Ç –∏–∑—É—á–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞.

#### –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è:
–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–¥–µ—Ä–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Å–µ—Ä–∏—é –≤–µ–∫—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –≤—Ö–æ–¥–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –≠—Ç–∏ –≤–µ–∫—Ç–æ—Ä—ã —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –∫–æ–¥–∏—Ä—É—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞, –Ω–æ –∏ –∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.

#### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:

1. **–°–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏–µ (Self-Attention)**:
   - **–í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä $X$**: –≠—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –≤—Ö–æ–¥–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏) –≤ –≤–∏–¥–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
   - **–ö–ª—é—á–∏ $K$**, **–∑–∞–ø—Ä–æ—Å—ã $Q$** –∏ **–∑–Ω–∞—á–µ–Ω–∏—è $V$**: –≠—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–ª—É—á–∞—é—Ç—Å—è –ø—É—Ç–µ–º —É–º–Ω–æ–∂–µ–Ω–∏—è –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $X$ –Ω–∞ –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã $W_K$, $W_Q$ –∏ $W_V$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ:

     $$
     Q = XW_Q, \quad K = XW_K, \quad V = XW_V
     $$

   - **–í–Ω–∏–º–∞–Ω–∏–µ $A$**: –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—É—Ç–µ–º —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–ª—é—á–µ–π, –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π $d_k$:
   
     $$
     A = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)
     $$

   - **–í—ã—Ö–æ–¥ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è $Z$**: –≠—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è:

     $$
     Z = AV
     $$

```python
import numpy as np

def self_attention(X, d_k):
    """
    Description:
      –†–µ–∞–ª–∏–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º Self-Attention.

    Args:
        X (numpy.ndarray): –í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä (–º–∞—Ç—Ä–∏—Ü–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤), —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é (n_samples, embedding_dim).
        d_k (int): –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π.

    Returns:
        numpy.ndarray: –í—ã—Ö–æ–¥ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è Z.
    """
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤—ã—Ö –º–∞—Ç—Ä–∏—Ü —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    embedding_dim = X.shape[1]
    W_Q = np.random.rand(embedding_dim, d_k)
    W_K = np.random.rand(embedding_dim, d_k)
    W_V = np.random.rand(embedding_dim, d_k)

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π
    Q = X @ W_Q
    K = X @ W_K
    V = X @ W_V

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤–Ω–∏–º–∞–Ω–∏—è
    attention_scores = Q @ K.T
    scaled_attention_scores = attention_scores / np.sqrt(d_k)

    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ softmax –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è
    attention_weights = np.exp(scaled_attention_scores) / np.sum(np.exp(scaled_attention_scores), axis=-1, keepdims=True)

    # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞
    Z = attention_weights @ V

    return Z

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
# –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ 3 —Å–ª–æ–≤, –≥–¥–µ –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤–µ–∫—Ç–æ—Ä–æ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 4
X = np.array([[1.0, 0.5, 0.2, 0.8],
              [0.3, 0.9, 0.1, 0.4],
              [0.6, 0.2, 0.7, 0.5]])

d_k = 2  # –ü—Ä–∏–º–µ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∫–ª—é—á–µ–π

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è
output_Z = self_attention(X, d_k)

print("–í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä X:\n", X)
print("\n–í—ã—Ö–æ–¥ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è Z:\n", output_Z)
```

2. **–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏ (Feedforward Neural Network)**:
   - –í—ã—Ö–æ–¥ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏—è $Z$ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –¥–≤–∞ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ—è —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ReLU) –º–µ–∂–¥—É –Ω–∏–º–∏:

     $$
     \text{FFN}(Z) = \max(0, ZW_1 + b_1)W_2 + b_2
     $$

   - **$W_1$, $W_2$**: –í–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ª–æ—è.
   - **$b_1$, $b_2$**: –°–º–µ—â–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–æ–≥–æ —Å–ª–æ—è.

#### **–í–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã $W_K$, $W_Q$ –∏ $W_V$ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤**

1. –û–±—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

  –í –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ –≤–∞–∂–Ω–µ–π—à—É—é —Ä–æ–ª—å –∏–≥—Ä–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏). –î–ª—è —ç—Ç–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: **–∑–∞–ø—Ä–æ—Å—ã (queries)**, **–∫–ª—é—á–∏ (keys)** –∏ **–∑–Ω–∞—á–µ–Ω–∏—è (values)**. –≠—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –≤–µ—Å–æ–≤—ã—Ö –º–∞—Ç—Ä–∏—Ü $W_Q$, $W_K$ –∏ $W_V$ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ—Å–æ–≤—ã—Ö –º–∞—Ç—Ä–∏—Ü

  2.1 –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
  
  –î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å –≤—Ö–æ–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $X$ —Ä–∞–∑–º–µ—Ä–æ–º $n \times d_{model}$, –≥–¥–µ:
  - $n$ ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è).
  - $d_{model}$ ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 512 –∏–ª–∏ 1024).

  –≠—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $X$ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—É, –≥–¥–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –ª–∏–Ω–µ–π–Ω—ã–µ —Å–ª–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç –µ—ë –≤ –∑–∞–ø—Ä–æ—Å—ã $Q$, –∫–ª—é—á–∏ $K$ –∏ –∑–Ω–∞—á–µ–Ω–∏—è $V$.

  2.2 –õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

  –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π, –≤—Ö–æ–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ —Ç—Ä–∏ —Ä–∞–∑–Ω—ã–µ –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã $W_Q$, $W_K$ –∏ $W_V$:

  $$
  Q = XW_Q, \quad K = XW_K, \quad V = XW_V
  $$

  –≥–¥–µ:
  - $W_Q$ ‚Äî –≤–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ $d_{model} \times d_k$.
  - $W_K$ ‚Äî –≤–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –∫–ª—é—á–µ–π —Ä–∞–∑–º–µ—Ä–∞ $d_{model} \times d_k$.
  - $W_V$ ‚Äî –≤–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–∞ $d_{model} \times d_v$.

  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $d_k$ –∏ $d_v$ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω–∞ –ø–æ-—Ä–∞–∑–Ω–æ–º—É, –Ω–æ –æ–±—ã—á–Ω–æ $d_k = d_v = d_{model}$. –≠—Ç–∏ –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –æ–±—É—á–∞—é—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª–∏ –∏ –∏—Ö –∑–∞–¥–∞—á–∞ ‚Äî –Ω–∞–π—Ç–∏ —Ç–∞–∫–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç.

3. –ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã?

  3.1 –ó–∞–ø—Ä–æ—Å—ã ($W_Q$)

  –ú–∞—Ç—Ä–∏—Ü–∞ $W_Q$ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –≤ –∑–∞–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–∞–Ω–Ω–æ–≥–æ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ø—ã—Ç–∞–µ—Ç—Å—è "–≤—ã—è—Å–Ω–∏—Ç—å", –Ω–∞ –∫–∞–∫–∏–µ –¥—Ä—É–≥–∏–µ —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ –µ–º—É —Å–ª–µ–¥—É–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ.

  3.2 –ö–ª—é—á–∏ ($W_K$)

  –ú–∞—Ç—Ä–∏—Ü–∞ $W_K$ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –≤ –∫–ª—é—á–∏. –ö–ª—é—á–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏. –ü–æ —Å—É—Ç–∏, –∫–ª—é—á–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, "–Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–µ–Ω" –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å –∑–∞–ø—Ä–æ—Å–æ–º. –ß–µ–º –±–ª–∏–∂–µ –∑–∞–ø—Ä–æ—Å –∫ –∫–ª—é—á—É (–ø–æ –º–µ—Ä–µ —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è), —Ç–µ–º –±–æ–ª—å—à–µ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –±—É–¥–µ—Ç —É–¥–µ–ª–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É.

  3.3 –ó–Ω–∞—á–µ–Ω–∏—è ($W_V$)

  –ú–∞—Ç—Ä–∏—Ü–∞ $W_V$ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –≤ –∑–Ω–∞—á–µ–Ω–∏—è. –ó–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è. –ò—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –±—É–¥–µ—Ç –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Å—É–º–º–æ–π –∑–Ω–∞—á–µ–Ω–∏–π –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤, –≥–¥–µ –≤–µ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Å—Ç–µ–ø–µ–Ω—å—é –≤–Ω–∏–º–∞–Ω–∏—è (–≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–π —á–µ—Ä–µ–∑ –∑–∞–ø—Ä–æ—Å—ã –∏ –∫–ª—é—á–∏).

4. –ú–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è

  4.1 –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è

  –ó–∞–ø—Ä–æ—Å—ã $Q$ –∏ –∫–ª—é—á–∏ $K$ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –≤–Ω–∏–º–∞–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–ª—é—á–µ–π —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $d_k$ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º softmax:

  $$
  A = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)
  $$

  –ì–¥–µ $A$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –≤–Ω–∏–º–∞–Ω–∏—è, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è, –∫–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ –≤–ª–∏—è–Ω–∏–µ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞.

  4.2 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º

  –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –≤–Ω–∏–º–∞–Ω–∏—è, –µ—ë —É–º–Ω–æ–∂–∞—é—Ç –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É –∑–Ω–∞—á–µ–Ω–∏–π $V$, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞, —É—á–∏—Ç—ã–≤–∞—é—â–µ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç:

  $$
  Z = AV
  $$

5. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

  –í–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã $W_Q$, $W_K$ –∏ $W_V$ —Å–ª—É–∂–∞—Ç –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å—ã, –∫–ª—é—á–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è. –≠—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –æ–±—É—á–∞—é—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª–∏ –∏ –∏–≥—Ä–∞—é—Ç —Ä–µ—à–∞—é—â—É—é —Ä–æ–ª—å –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ç–æ–≥–æ, –∫–∞–∫ –º–æ–¥–µ–ª—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏.

  –¢–∞–∫–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –∑–∞–¥–∞—á–∞—Ö –ø–µ—Ä–µ–≤–æ–¥–∞, –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö.

## **–û—Ç –≤—Ö–æ–¥–∞ –∫ –≤—ã—Ö–æ–¥—É –≤–Ω—É—Ç—Ä–∏ –∫–æ–¥–µ—Ä–∞**

### 1. **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

  - **–í—Ö–æ–¥–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $X$**: –ú–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(N, L, D_{model})$, 

  –≥–¥–µ:

  **Batch Size ($N$) - –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞:**

  * Batch Size –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ **–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å—é **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –∑–∞ –æ–¥–∏–Ω –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ –æ–±—É—á–µ–Ω–∏—è –∏–ª–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è).

  **–î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ($L$) - Length of the sequence:**

  * –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ **—ç–ª–µ–º–µ–Ω—Ç–æ–≤** (—Ç–æ–∫–µ–Ω–æ–≤) –≤ –∫–∞–∂–¥–æ–π **–æ—Ç–¥–µ–ª—å–Ω–æ–π** –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –ø–∞–∫–µ—Ç–∞.

  **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ ($D_{model}$) - Dimension of the embeddings:**

  * –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –æ–±—ä–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–∞, —Ç–æ–∫–µ–Ω–∞).

  **–ö–∞–∫ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞ X:**

  1. **–≠–º–±–µ–¥–¥–∏–Ω–≥ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**  –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–≤–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥ - –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$.

  2. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –ø–∞–∫–µ—Ç–µ –º—ã –ø–æ–ª—É—á–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(L, D_{model})$. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —ç—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥—É –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —É –Ω–∞—Å –µ—Å—Ç—å $L$ —Å—Ç—Ä–æ–∫ (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏) –∏ $D_{model}$ —Å—Ç–æ–ª–±—Ü–æ–≤ (–ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞).

  3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞:**  –ü–æ—Å–∫–æ–ª—å–∫—É —É –Ω–∞—Å –µ—Å—Ç—å $N$ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ –ø–∞–∫–µ—Ç–µ, –º—ã "—Å–∫–ª–∞–¥—ã–≤–∞–µ–º" —ç—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã $(L, D_{model})$ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —Ç—Ä–µ—Ö–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä (–∏–ª–∏ –º–∞—Ç—Ä–∏—Ü—É —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 3) $X$ —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ $(N, L, D_{model})$.

### **–í –∏—Ç–æ–≥–µ:**

–ú–∞—Ç—Ä–∏—Ü–∞ $X$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(N, L, D_{model})$ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ç—Ä–µ—Ö–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä. –ï—Å–ª–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ –Ω–∞–±–æ—Ä –¥–≤—É–º–µ—Ä–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü, —Ç–æ –æ–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ $N$ –º–∞—Ç—Ä–∏—Ü —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(L, D_{model})$, "–Ω–∞–ª–æ–∂–µ–Ω–Ω—ã—Ö" –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞. –ö–∞–∂–¥–∞—è –∏–∑ —ç—Ç–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–∞—Ç—Ä–∏—Ü (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –ø–∞–∫–µ—Ç–µ) –∏–º–µ–µ—Ç $L$ —Å—Ç—Ä–æ–∫ (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏) –∏ $D_{model}$ —Å—Ç–æ–ª–±—Ü–æ–≤ (–ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤).

### **–ü—Ä–∏–º–µ—Ä:**

```Python
import torch

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –±–∞—Ç—á–µ
sentences = [
    "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –Ø —É–≤–ª–µ–∫–∞—é—Å—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º",  # 7 —Ç–æ–∫–µ–Ω–æ–≤
    "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?",                                   # 4 —Ç–æ–∫–µ–Ω–∞
    "–ò–ò ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!"                                  # 5 —Ç–æ–∫–µ–Ω–æ–≤
]

# 1. –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
batch_tokens = [
    ["[CLS]", "–í—Å–µ–º", "–ø—Ä–∏–≤–µ—Ç", "!", "–Ø", "—É–≤–ª–µ–∫–∞—é—Å—å", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º", "[SEP]"],  # L=9
    ["[CLS]", "–ü—Ä–∏–≤–µ—Ç", ",", "–∫–∞–∫", "–¥–µ–ª–∞", "?", "[SEP]", "[PAD]", "[PAD]"],                      # L=9 (—Å –ø–∞–¥–¥–∏–Ω–≥–æ–º)
    ["[CLS]", "–ò–ò", "‚Äî", "—ç—Ç–æ", "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ", "!", "[SEP]", "[PAD]", "[PAD]"]                      # L=9 (—Å –ø–∞–¥–¥–∏–Ω–≥–æ–º)
]

N = len(sentences)  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ = 3
L = 9               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–æ—Å–ª–µ –ø–∞–¥–¥–∏–Ω–≥–∞)
D_model = 512       # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

# 2. –°–æ–∑–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è –≤—Å–µ–≥–æ –±–∞—Ç—á–∞
embeddings = torch.randn(N, L, D_model)

# 3. –§–æ—Ä–º–∏—Ä—É–µ–º –≤—Ö–æ–¥–Ω–æ–π —Ç–µ–Ω–∑–æ—Ä X
X = embeddings

print("–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞ X:", X.shape)  # (3, 9, 512)
print("\n–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:")
print(f"‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞—Ç—á–µ–π (N): {N}")
print(f"‚Ä¢ –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (L): {L} (—Å —É—á–µ—Ç–æ–º –ø–∞–¥–¥–∏–Ω–≥–∞)")
print(f"‚Ä¢ –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (D_model): {D_model}\n")

# ================= –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ =================
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
for batch_idx in range(N):
    print(f"–ë–∞—Ç—á {batch_idx + 1} ({sentences[batch_idx][:20]}...):")
    print(f"–¢–æ–∫–µ–Ω—ã: {batch_tokens[batch_idx]}")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 3 —ç–ª–µ–º–µ–Ω—Ç–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
    print("\n–ü—Ä–∏–º–µ—Ä—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤:")
    print(f"‚Ä¢ [CLS] —Ç–æ–∫–µ–Ω: {X[batch_idx, 0, :3].detach().numpy().round(4)}...")
    print(f"‚Ä¢ 3-–π —Ç–æ–∫–µ–Ω:   {X[batch_idx, 2, :3].detach().numpy().round(4)}...")
    print(f"‚Ä¢ [SEP] —Ç–æ–∫–µ–Ω: {X[batch_idx, -3, :3].detach().numpy().round(4)}...")
    print(f"‚Ä¢ [PAD] —Ç–æ–∫–µ–Ω: {X[batch_idx, -1, :3].detach().numpy().round(4)}...")
    print("-" * 60)
```

```Python
# ================= –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ =================
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ç–µ–Ω–∑–æ—Ä–∞ X
for batch_idx in range(N):
    print(f"–ë–∞—Ç—á {batch_idx + 1} ({sentences[batch_idx][:20]}...):")
    print(f"–¢–æ–∫–µ–Ω—ã: {batch_tokens[batch_idx]}")
    
    # –í—ã–≤–æ–¥–∏–º –≤—Å–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    print("\n–≠–º–±–µ–¥–¥–∏–Ω–≥–∏:")
    for token_idx in range(L):
        print(f"‚Ä¢ –¢–æ–∫–µ–Ω {token_idx}: {X[batch_idx, token_idx].detach().numpy().round(4)}...")
    print("-" * 60)
```

### 2. **–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (Positional Encodings):**

  **–ó–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω—ã –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è?** –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (RNN), —Ç–∞–∫–∏–µ –∫–∞–∫ LSTM –∏–ª–∏ GRU, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω –∑–∞ —Ç–æ–∫–µ–Ω–æ–º, –∏ –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞. –û–¥–Ω–∞–∫–æ, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Ö–∞–Ω–∏–∑–º–µ –≤–Ω–∏–º–∞–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ Transformer, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –æ–Ω–∏ —Ç–µ—Ä—è—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ—Ä—è–¥–∫–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤. –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–≤–æ–¥—è—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã "–ø–æ–¥—Å–∫–∞–∑–∞—Ç—å" –º–æ–¥–µ–ª–∏, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

  –ö–æ–≥–¥–∞ –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞), –∫–æ–¥–µ—Ä Transformer —Ç–∞–∫–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, —Ñ–æ—Ä–º–∏—Ä—É—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.

  –¢–∞–∫ –∂–µ –≤–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è ($PE$) –∏–º–µ—é—Ç —Ç—É –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, —á—Ç–æ –∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤ ($D_{model}$). –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –∏—Ö –≤–º–µ—Å—Ç–µ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ.

  ![Figure_2](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-04/assets/Figure_2.png)

  - –î–ª—è —É—á–µ—Ç–∞ –ø–æ—Ä—è–¥–∫–∞ —Å–ª–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫ –≤—Ö–æ–¥–Ω—ã–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è $PE$ —Ç–æ–π –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$.
  - $PE$ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –ø–æ —Å–ª–µ–¥—É—é—â–∏–º —Ñ–æ—Ä–º—É–ª–∞–º:
    $$
    PE_{(pos, 2i)} = \sin\left(\frac{pos}{10000^{2i/D_{model}}}\right) \\
    PE_{(pos, 2i+1)} = \cos\left(\frac{pos}{10000^{2i/D_{model}}}\right)
    $$
    
    –≥–¥–µ:

  *   **$pos$ (–ø–æ–∑–∏—Ü–∏—è):**
      *   –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é —Ç–æ–∫–µ–Ω–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
      *   –ù—É–º–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0. –ü–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç $pos = 0$, –≤—Ç–æ—Ä–æ–π - $pos = 1$, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.
      *   –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ "–°–æ–±–∞–∫–∞ –ª–∞–µ—Ç –≥—Ä–æ–º–∫–æ", "–°–æ–±–∞–∫–∞" –∏–º–µ–µ—Ç $pos = 0$, "–ª–∞–µ—Ç" - $pos = 1$, "–≥—Ä–æ–º–∫–æ" - $pos = 2$.
  *   **$i$ (–∏–Ω–¥–µ–∫—Å –∏–∑–º–µ—Ä–µ–Ω–∏—è):**
      *   –≠—Ç–æ –∏–Ω–¥–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤ –≤–µ–∫—Ç–æ—Ä–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.
      *   $i$ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 0 –¥–æ $D_{model}/2 - 1$.
      *   –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è $i$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞ –∑–Ω–∞—á–µ–Ω–∏–π: –æ–¥–Ω–æ —Å —Å–∏–Ω—É—Å–æ–º, –¥—Ä—É–≥–æ–µ —Å –∫–æ—Å–∏–Ω—É—Å–æ–º.
      *   –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ $D_{model} = 512$, —Ç–æ $i$ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 0 –¥–æ 255.
  *   **$D_{model}$ (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏):**
      *   –≠—Ç–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å–ª–æ–≤ –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π.
      *   –û–±—ã—á–Ω–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ 512, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ –¥—Ä—É–≥–∏–º.
      *   $D_{model}$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–ª–∏–Ω—É –≤–µ–∫—Ç–æ—Ä–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

  **–ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∏–Ω—É—Å –∏ –∫–æ—Å–∏–Ω—É—Å?**

  *   **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** –°–∏–Ω—É—Å –∏ –∫–æ—Å–∏–Ω—É—Å –ø–æ–∑–≤–æ–ª—è—é—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏.
  *   **–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å:** –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –ª–µ–≥–∫–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤.
  *   **–≠–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è:** –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —ç–∫—Å—Ç—Ä–∞–ø–æ–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —á–µ–º —Ç–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∞ –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞.
  *   **–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏:** –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏ –¥–ª—è —Å–æ—Å–µ–¥–Ω–∏—Ö –ø–æ–∑–∏—Ü–∏–π –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π, —á—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –ø–æ–Ω–∏–º–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤.

  **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π:**

  –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ $pos$ –∏ –∫–∞–∂–¥–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è $i$ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ—Ö–º–µ—Ä–Ω–æ–≥–æ —Ç–µ–Ω–∑–æ—Ä–∞ $X$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(N, L, D_{model})$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ü–æ—Å–∫–æ–ª—å–∫—É $i$ –ø—Ä–æ–±–µ–≥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 0 –¥–æ $D_{model}/2 - 1$, –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ $pos$ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$. –ü–µ—Ä–≤—ã–µ $D_{model}/2$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —ç—Ç–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Å–∏–Ω—É—Å–∞, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ $D_{model}/2$ - —Å –ø–æ–º–æ—â—å—é –∫–æ—Å–∏–Ω—É—Å–∞.

  **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π:**

  –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–º–µ—é—Ç —Ç—É –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, —á—Ç–æ –∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å–ª–æ–≤ ($D_{model}$), —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ —Å–ª–æ–∂–∏—Ç—å. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞–∫ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞ (–∏–∑ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞), —Ç–∞–∫ –∏ –µ–≥–æ –ø–æ–∑–∏—Ü–∏—é –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∏–∑ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è).

### **–í –∏—Ç–æ–≥–µ:**

–ò—Ç–æ–≥–æ–≤—ã–π –≤—Ö–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—è –∫–æ–¥–µ—Ä–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ —Å–ª–æ–∂–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å–ª–æ–≤ $X$ –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π $PE$: $X_{embedded} = X + PE$.

**–ü—Ä–∏–º–µ—Ä:**

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ $D_{model} = 4$. –¢–æ–≥–¥–∞ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ $pos = 1$ –∏ $i = 0$ –º—ã –ø–æ–ª—É—á–∏–º:

$$PE_{(1, 0)} = \sin\left(\frac{1}{10000^{0}}\right) = \sin(1) \approx 0.84$$
$$PE_{(1, 1)} = \cos\left(\frac{1}{10000^{0}}\right) = \cos(1) \approx 0.54$$

–î–ª—è $i = 1$:

$$PE_{(1, 2)} = \sin\left(\frac{1}{10000^{2/4}}\right) = \sin\left(\frac{1}{100}\right) \approx 0.01$$
$$PE_{(1, 3)} = \cos\left(\frac{1}{10000^{2/4}}\right) = \cos\left(\frac{1}{100}\right) \approx 1$$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤–µ–∫—Ç–æ—Ä –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ 1 –±—É–¥–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–µ–Ω [0.84, 0.54, 0.01, 1].

- –ò—Ç–æ–≥–æ–≤—ã–π –≤—Ö–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—è –∫–æ–¥–µ—Ä–∞: $X_{embedded} = X + PE$.

```Python
import torch
import math

def positional_encoding(max_len: int, d_model: int) -> torch.Tensor:
    """
    Description:
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–∏ Transformer.

    Args:
        max_len: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        d_model: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤).

    Returns:
        –¢–µ–Ω–∑–æ—Ä –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π —Ñ–æ—Ä–º—ã (max_len, d_model).

    Examples:
        >>> pe = positional_encoding(10, 512)
        >>> pe.shape
        torch.Size([10, 512])
    """
    pe = torch.zeros(max_len, d_model)
    position = torch.arange(0, max_len, dtype=torch.float).unsqueeze(1)
    div_term = torch.exp(torch.arange(0, d_model, 2).float() * (-math.log(10000.0) / d_model))
    
    pe[:, 0::2] = torch.sin(position * div_term)
    pe[:, 1::2] = torch.cos(position * div_term)
    return pe

def print_embeddings(tensor: torch.Tensor, tokens: list, title: str, max_elements: int = 3) -> None:
    """
    Description:
        –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å –º–µ—Ç–∫–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤.

    Args:
        tensor: –¢–µ–Ω–∑–æ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
        tokens: –°–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞.
        max_elements: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

    Returns:
        None

    Examples:
        >>> embeddings = torch.randn(5, 512)
        >>> tokens = ["token1", "token2", "token3", "token4", "token5"]
        >>> print_embeddings(embeddings, tokens, "–ü—Ä–∏–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤")
    """
    print(f"\n{title}:")
    for idx, (vec, token) in enumerate(zip(tensor, tokens)):
        elements = vec[:max_elements].detach().numpy().round(4)
        print(f"{idx:2d} {token:15}: [{', '.join(f'{x:7.4f}' for x in elements)}...]")

# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
sentences = [
    "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –Ø —É–≤–ª–µ–∫–∞—é—Å—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º",
    "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?",
    "–ò–ò ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!"
]

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
N = len(sentences)  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
L = 9               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
D_model = 512       # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

# 1. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–∞–¥–¥–∏–Ω–≥–æ–º
batch_tokens = [
    ["[CLS]", "–í—Å–µ–º", "–ø—Ä–∏–≤–µ—Ç", "!", "–Ø", "—É–≤–ª–µ–∫–∞—é—Å—å", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º", "[SEP]"],
    ["[CLS]", "–ü—Ä–∏–≤–µ—Ç", ",", "–∫–∞–∫", "–¥–µ–ª–∞", "?", "[SEP]", "[PAD]", "[PAD]"],
    ["[CLS]", "–ò–ò", "‚Äî", "—ç—Ç–æ", "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ", "!", "[SEP]", "[PAD]", "[PAD]"]
]

# 2. –°–æ–∑–¥–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
embeddings = torch.randn(N, L, D_model)

# 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
pe = positional_encoding(L, D_model)

# 4. –ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
X_embedded = embeddings + pe  # Broadcasting –¥–ª—è –±–∞—Ç—á–∞

# ================= –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ =================
print("="*60)
print("–®–∞–≥ 1: –ò—Å—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–∫–µ–Ω–æ–≤")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {embeddings.shape}")
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx+1}: '{sentences[batch_idx]}'")
    print_embeddings(embeddings[batch_idx], batch_tokens[batch_idx], "–ò—Å—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏")

print("\n" + "="*60)
print("–®–∞–≥ 2: –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {pe.shape}")
print_embeddings(pe, [f"–ü–æ–∑–∏—Ü–∏—è {i}" for i in range(L)], "–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π")

print("\n" + "="*60)
print("–®–∞–≥ 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (X + PE)")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {X_embedded.shape}")
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx+1}: '{sentences[batch_idx]}'")
    print_embeddings(X_embedded[batch_idx], batch_tokens[batch_idx], "–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ–∂–µ–Ω–∏—è")
```

```Python
# ================= –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ =================
print("\n" + "="*60)
print("–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞:")
batch_idx = 0

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print(f"\n–¢–µ–∫—Å—Ç: '{sentences[batch_idx]}'")
print(f"–¢–æ–∫–µ–Ω—ã: {batch_tokens[batch_idx]}")

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥:  {embeddings[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä:   {pe[pos, :3].detach().numpy().round(4)}")
    print(f"–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:     {X_embedded[batch_idx, pos, :3].detach().numpy().round(4)}")
```

### 3. **–ú–Ω–æ–≥–æ–≥–æ–ª–æ–≤–æ–µ —Å–∞–º–æ–≤–Ω–∏–º–∞–Ω–∏–µ (Multi-Head Self-Attention):**
   - –ù–∞ –≤—Ö–æ–¥–µ –ø–æ–¥—Å–ª–æ—è Multi-Head Attention –Ω–∞—Ö–æ–¥–∏—Ç—Å—è $X_{embedded} = X + PE$.
   - **–õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏:** –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ $X_{embedded}$ –ª–∏–Ω–µ–π–Ω–æ –ø—Ä–æ–µ—Ü–∏—Ä—É—é—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å—ã $Q$, –∫–ª—é—á–∏ $K$ –∏ –∑–Ω–∞—á–µ–Ω–∏—è $V$ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã:
     $$
     Q_i = X_{embedded} W_{Q_i}, \quad K_i = X_{embedded} W_{K_i}, \quad V_i = X_{embedded} W_{V_i}
     $$
     
      –≥–¥–µ:
      
      - $W_{Q_i} \in \mathbb{R}^{D_{model} \times D_k}$
      - $W_{K_i} \in \mathbb{R}^{D_{model} \times D_k}$
      - $W_{V_i} \in \mathbb{R}^{D_{model} \times D_v}$ - –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è $i$-–π –≥–æ–ª–æ–≤—ã
      - $D_k$ - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∏ –∑–∞–ø—Ä–æ—Å–æ–≤
      - $D_v$ - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π
      
      –û–±—ã—á–Ω–æ $D_k = D_v = D_{model} / h$, –≥–¥–µ $h$ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤.

      –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã, –ª–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è ‚Äî —ç—Ç–æ –ª–∏–Ω–µ–π–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–µ–∫—Ç–æ—Ä –∏–∑ –æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –≤ –¥—Ä—É–≥–æ–µ. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –º–Ω–æ–≥–æ–≥–æ–ª–æ–≤–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è, –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä $X_{embedded}$, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–π $D_{model}$-–º–µ—Ä–Ω–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É, –ø–æ–¥–≤–µ—Ä–≥–∞–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–º –ø—Ä–æ–µ–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ—Ö –Ω–æ–≤—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤: $Q_i$, $K_i$ –∏ $V_i$. –≠—Ç–∏ –≤–µ–∫—Ç–æ—Ä—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å–≤–æ–∏—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö.

      **–§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:**

      1. **$X_{embedded} \in \mathbb{R}^{D_{model}}$:** –í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä –≤ $D_{model}$-–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.
      2. **$W_{Q_i} \in \mathbb{R}^{D_{model} \times D_k}$, $W_{K_i} \in \mathbb{R}^{D_{model} \times D_k}$, $W_{V_i} \in \mathbb{R}^{D_{model} \times D_v}$:** –ú–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–µ –ª–∏–Ω–µ–π–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
      3. **–õ–∏–Ω–µ–π–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø—Ä–æ–µ–∫—Ü–∏–∏):**
        - $Q_i = X_{embedded} W_{Q_i}$: –ü—Ä–æ–µ–∫—Ü–∏—è $X_{embedded}$ –≤ $D_k$-–º–µ—Ä–Ω–æ–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤.
        - $K_i = X_{embedded} W_{K_i}$: –ü—Ä–æ–µ–∫—Ü–∏—è $X_{embedded}$ –≤ $D_k$-–º–µ—Ä–Ω–æ–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∫–ª—é—á–µ–π.
        - $V_i = X_{embedded} W_{V_i}$: –ü—Ä–æ–µ–∫—Ü–∏—è $X_{embedded}$ –≤ $D_v$-–º–µ—Ä–Ω–æ–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π.

      **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**

      - **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞:** –õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã—Ö —Ç–æ—á–µ–∫ –∑—Ä–µ–Ω–∏—è.
      - **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** –ö–∞–∂–¥–æ–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–µ—Ç —Å–≤–æ—é —Ä–æ–ª—å: –∑–∞–ø—Ä–æ—Å—ã –∏—â—É—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –∫–ª—é—á–∏, –∞ –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
      - **–û–±—É—á–∞–µ–º–æ—Å—Ç—å:** –ú–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤ $W_{Q_i}$, $W_{K_i}$ –∏ $W_{V_i}$ —è–≤–ª—è—é—Ç—Å—è –æ–±—É—á–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–µ.
      - **–ú–Ω–æ–≥–æ–≥–æ–ª–æ–≤–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ–ª–æ–≤ (—Ä–∞–∑–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –º–∞—Ç—Ä–∏—Ü) –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

      –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ª–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ –º–Ω–æ–≥–æ–≥–æ–ª–æ–≤–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –∫–∞–∂–¥–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ–µ—Ç —Å–≤–æ—é —Ä–æ–ª—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω—ã—Ö –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–π, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã—Ö –æ–±—É—á–∞–µ–º—ã–º–∏ –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –≤–µ—Å–æ–≤.

   - **–í–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π, –≥–¥–µ –≤–µ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π softmax –æ—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–ª—é—á–µ–π:
     $$
     Z_i = \text{Attention}(Q_i, K_i, V_i) = \text{softmax}\left(\frac{Q_i K_i^T}{\sqrt{D_k}}\right) V_i
     $$

   - **–§—É–Ω–∫—Ü–∏—è Softmax:**

      **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è softmax ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–µ–∫—Ç–æ—Ä –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ –≤–µ–∫—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –≤–µ–∫—Ç–æ—Ä $z = [z_1, z_2, ..., z_n]$ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä $\sigma(z) = [\sigma(z_1), \sigma(z_2), ..., \sigma(z_n)]$, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç $\sigma(z_i)$ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

      $$
      \sigma(z_i) = \frac{e^{z_i}}{\sum_{j=1}^{n} e^{z_j}}
      $$

      –≥–¥–µ:
      - $z_i$ ‚Äî —ç—Ç–æ $i$-–π —ç–ª–µ–º–µ–Ω—Ç –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $z$.
      - $e$ ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞ (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ 2.71828).
      - $n$ ‚Äî —ç—Ç–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ $z$.

      **–°–≤–æ–π—Å—Ç–≤–∞ Softmax:**
      - **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:** –°—É–º–º–∞ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $\sigma(z)$ —Ä–∞–≤–Ω–∞ 1: $\sum_{i=1}^{n} \sigma(z_i) = 1$.
      - **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏:** –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $\sigma(z_i)$ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 1: $0 \leq \sigma(z_i) \leq 1$.
      - **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:** Softmax –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞ –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–µ –ø–æ–ª–µ–∑–Ω–æ–π –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –≤–Ω–∏–º–∞–Ω–∏—è.

   - **Softmax –≤ –ú–µ—Ö–∞–Ω–∏–∑–º–µ –í–Ω–∏–º–∞–Ω–∏—è:**

      –í –º–µ—Ö–∞–Ω–∏–∑–º–µ –≤–Ω–∏–º–∞–Ω–∏—è softmax –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–µ–Ω –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –í –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ $\text{softmax}\left(\frac{Q_i K_i^T}{\sqrt{D_k}}\right) V_i$:

      - $Q_i$ ‚Äî —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (queries) –¥–ª—è $i$-–π –≥–æ–ª–æ–≤—ã.
      - $K_i$ ‚Äî —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –∫–ª—é—á–µ–π (keys) –¥–ª—è $i$-–π –≥–æ–ª–æ–≤—ã.
      - $V_i$ ‚Äî —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –∑–Ω–∞—á–µ–Ω–∏–π (values) –¥–ª—è $i$-–π –≥–æ–ª–æ–≤—ã.
      - $D_k$ ‚Äî —ç—Ç–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∏ –∑–∞–ø—Ä–æ—Å–æ–≤.

      **–†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è:**
      1. **–°–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:** –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–ª—é—á–µ–π: $Q_i K_i^T$. –≠—Ç–æ –¥–∞–µ—Ç –º–∞—Ç—Ä–∏—Ü—É, –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ "—Å–æ–≤–ø–∞–¥–∞–µ—Ç" –∑–∞–ø—Ä–æ—Å —Å –∫–ª—é—á–æ–º.
      2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –¥–µ–ª–∏—Ç—Å—è –Ω–∞ $\sqrt{D_k}$. –≠—Ç–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏.
      3. **Softmax:** –§—É–Ω–∫—Ü–∏—è softmax –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è.

   - **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤:** –í—ã—Ö–æ–¥—ã –≤—Å–µ—Ö –≥–æ–ª–æ–≤ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è:
      $$
      \text{Concat}(Z_1, Z_2, ..., Z_h)
      $$
      –≥–¥–µ $Z_i = \text{Attention}(Q_i, K_i, V_i)$.
   - **–õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞:** –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$:
      $$
      \text{MultiHead}(Q, K, V) = \text{Concat}(Z_1, Z_2, ..., Z_h) W^O
      $$
      –≥–¥–µ $W^O \in \mathbb{R}^{h D_v \times D_{model}}$ - –≤–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤—ã—Ö–æ–¥–Ω–æ–π –ø—Ä–æ–µ–∫—Ü–∏–∏.

### **–î–∞–≤–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç softmax –≤–Ω—É—Ç—Ä–∏ Multi-Head Attention –Ω–∞ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∏–∂–µ.**

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–π–¥–µ–º –∫ —Å–∞–º–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–º—É ‚Äî Multi-Head Self-Attention, –≥–¥–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è softmax.

**1. –õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏:**

  - –ù–∞ –≤—Ö–æ–¥ Multi-Head Attention –ø–æ–¥–∞—é—Ç—Å—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (—Ñ–æ—Ä–º–∞ `torch.Size([3, 9, 512])`).
  - –î–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã (–≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Ö 8) –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ª–∏–Ω–µ–π–Ω–æ –ø—Ä–æ–µ—Ü–∏—Ä—É—é—Ç—Å—è –≤ —Ç—Ä–∏ –º–∞—Ç—Ä–∏—Ü—ã:
    - **Q (–∑–∞–ø—Ä–æ—Å—ã):** `torch.Size([3, 8, 9, 64])`
    - **K (–∫–ª—é—á–∏):** `torch.Size([3, 8, 9, 64])`
    - **V (–∑–Ω–∞—á–µ–Ω–∏—è):** `torch.Size([3, 8, 9, 64])`
  - –≠—Ç–∏ –ø—Ä–æ–µ–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–±—É—á–∞–µ–º—ã—Ö –º–∞—Ç—Ä–∏—Ü –≤–µ—Å–æ–≤ $W_Q$, $W_K$ –∏ $W_V$.
  - –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –¥–ª—è –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ (—Ç–æ–∫–µ–Ω `[CLS]`) –≤—ã –≤–∏–¥–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –º–∞—Ç—Ä–∏—Ü Q, K –∏ V.

  **–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ!:**

```
# –≠—Ç–æ –¥–æ –ø–æ–¥—Å–ª–æ—è Multi-Head Attention!

–ü–æ–∑–∏—Ü–∏—è 0 ([CLS]):
–ò—Å—Ö–æ–¥–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥   X:  [ 0.9007 -2.1055  0.6784]
–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä   PE:  [0. 1. 0.]
–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π X + PE:  [ 0.9007 -1.1055  0.6784]

# –≠—Ç–æ –ø–æ—Å–ª–µ Multi-Head Attention! 
  –ü–æ–∑–∏—Ü–∏—è 0 ([CLS]):
    Q: [[ 17.2809  14.7748 -11.5202]
[ -7.0419 -29.7085  54.2687]
[ 29.6011  11.744   -0.8485]
[ -6.7934 -25.4389  67.2095]
[ 28.5684 -16.4333 -13.8622]
[ -4.5139 -61.0905  -0.8532]
[-24.339   -9.4282  -5.367 ]
[  7.8296 -14.4175  16.9908]]
    K: [[  6.637  -10.3847 -29.3882]
[-22.8757 -18.3149 -65.0343]
[ 18.4063  29.4638 -34.1548]
[  5.1229   5.5592  66.0818]
[  9.9801 -20.4229  -7.4216]
[-22.0776   4.2677 -32.6255]
[-40.8423  19.4702   0.3407]
[  8.7071  27.0544 -13.8258]]
    V: [[ 25.8466  12.3776  -7.7585]
[ 32.6146  -2.0634  32.7602]
[ 25.009   11.0889  28.2676]
[ 19.9813 -11.8157  22.7189]
[ 12.4848   6.3136 -28.9884]
[ -1.6635  15.4315 -23.0705]
[ 14.6102  -1.6098 -15.4584]
[ -9.4451 -38.6892  42.4362]]
```

*   **"Q –¥–ª—è —Ç–æ–∫–µ–Ω–∞ CLS" - —ç—Ç–æ –Ω–∞–±–æ—Ä –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—Ü—ã.**
*   **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ–∫—Ç–æ—Ä–æ–≤ = –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è** (–≤ –ø—Ä–∏–º–µ—Ä–µ 8).
*   **–ö–∞–∂–¥—ã–π –≤–µ–∫—Ç–æ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–æ–ª–æ–≤–µ –≤–Ω–∏–º–∞–Ω–∏—è.**
*   **–í–µ–∫—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ–π –ø—Ä–æ–µ–∫—Ü–∏–µ–π:**  –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ CLS —Ç–æ–∫–µ–Ω–∞  **—É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É  `W_q`**  –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥–æ–ª–æ–≤—ã –≤–Ω–∏–º–∞–Ω–∏—è.

**2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è:**

  - –î–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã –∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è.
  - **–°–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:** –°–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–ª—é—á–µ–π: $Q_i K_i^T$.
    - –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ, –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ (—Ç–æ–∫–µ–Ω `[CLS]`), —ç—Ç–æ –±—É–¥–µ—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ Q (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å 64) –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä K (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å 64) –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    - –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –±—É–¥–µ—Ç –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (9, 9), –≥–¥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ "—Å–æ–≤–ø–∞–¥–∞–µ—Ç" –∑–∞–ø—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞ `[CLS]` —Å –∫–ª—é—á–æ–º –∫–∞–∂–¥–æ–≥–æ –∏–∑ 9 —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

    <div style="border: 1px solid #000; padding: 10px; margin: 10px;">
    
    **–¶–µ–ª—å —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:**

    –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ ‚Äî **–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ "—Å–æ–≤–º–µ—Å—Ç–∏–º" –∏–ª–∏ "—Ä–µ–ª–µ–≤–∞–Ω—Ç–µ–Ω" –∑–∞–ø—Ä–æ—Å (Q) –æ–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –∫ –∫–ª—é—á–∞–º (K) –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.**  –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –º—ã –ø–æ–ª—É—á–∞–µ–º "—Å—ã—Ä—ã–µ" –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–æ–º –±—É–¥—É—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã Softmax.

    **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–æ–∫–µ–Ω–∞ `[CLS]` (–ø–µ—Ä–≤–∞—è –ø–æ–∑–∏—Ü–∏—è) –∏ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã:**

    1.  **–ë–µ—Ä–µ–º –≤–µ–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ Q –¥–ª—è `[CLS]` –∏–∑ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã:**
        *   –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ 0 ([CLS]) –∏ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –±–ª–æ–∫–µ Q) —É–∫–∞–∑–∞–Ω –≤–µ–∫—Ç–æ—Ä (–ø–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 3 —ç–ª–µ–º–µ–Ω—Ç–∞): `[ 17.2809  14.7748 -11.5202 ...]`.  –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 64. –û–±–æ–∑–Ω–∞—á–∏–º –µ–≥–æ –∫–∞–∫  `Q_cls_head1`.

    2.  **–ë–µ—Ä–µ–º –≤–µ–∫—Ç–æ—Ä—ã –∫–ª—é—á–µ–π K –¥–ª—è *–≤—Å–µ—Ö* –ø–æ–∑–∏—Ü–∏–π (–æ—Ç 0 –¥–æ 8) –∏–∑ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã:**
        *   –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç 0 –¥–æ 8 –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (—Ç–æ–∫–µ–Ω—ã `[CLS]`, `–í—Å–µ–º`, `–ø—Ä–∏–≤–µ—Ç`, `!`, `–Ø`, `—É–≤–ª–µ–∫–∞—é—Å—å`, `–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º`, `–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º`, `[SEP]`) –µ—Å—Ç—å —Å–≤–æ–π –≤–µ–∫—Ç–æ—Ä –∫–ª—é—á–µ–π K, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã.  –í –ø—Ä–∏–º–µ—Ä–µ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ 0 ([CLS]) –∏ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –±–ª–æ–∫–µ K) —É–∫–∞–∑–∞–Ω –≤–µ–∫—Ç–æ—Ä: `[  6.637  -10.3847 -29.3882 ...]`.  –û–±–æ–∑–Ω–∞—á–∏–º –≤–µ–∫—Ç–æ—Ä—ã –∫–ª—é—á–µ–π –∫–∞–∫ `K_pos0_head1`, `K_pos1_head1`, `K_pos2_head1`, ..., `K_pos8_head1`. –ö–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å 64.

    3.  **–í—ã—á–∏—Å–ª—è–µ–º —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–µ–∂–¥—É `Q_cls_head1` –∏ –∫–∞–∂–¥—ã–º –≤–µ–∫—Ç–æ—Ä–æ–º –∫–ª—é—á–µ–π `K_pos_j_head1`:**
        *   –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ `j` –æ—Ç 0 –¥–æ 8 –º—ã –≤—ã—á–∏—Å–ª—è–µ–º —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:
            *   `score_0 = Q_cls_head1 * (K_pos0_head1)^T`  (–≤–Ω–∏–º–∞–Ω–∏–µ `[CLS]` –Ω–∞ `[CLS]`)
            *   `score_1 = Q_cls_head1 * (K_pos1_head1)^T`  (–≤–Ω–∏–º–∞–Ω–∏–µ `[CLS]` –Ω–∞ `–í—Å–µ–º`)
            *   `score_2 = Q_cls_head1 * (K_pos2_head1)^T`  (–≤–Ω–∏–º–∞–Ω–∏–µ `[CLS]` –Ω–∞ `–ø—Ä–∏–≤–µ—Ç`)
            *   ...
            *   `score_8 = Q_cls_head1 * (K_pos8_head1)^T`  (–≤–Ω–∏–º–∞–Ω–∏–µ `[CLS]` –Ω–∞ `[SEP]`)

        *   **–ö–∞–∂–¥–æ–µ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ `score_j` ‚Äî —ç—Ç–æ –æ–¥–Ω–æ —á–∏—Å–ª–æ (—Å–∫–∞–ª—è—Ä).** –û–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ "—Å–æ–≤–º–µ—Å—Ç–∏–º" –∑–∞–ø—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞ `[CLS]` —Å –∫–ª—é—á–æ–º —Ç–æ–∫–µ–Ω–∞ –≤ –ø–æ–∑–∏—Ü–∏–∏ `j`. –ß–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ `score_j`, —Ç–µ–º –±–æ–ª—å—à–µ –≤–Ω–∏–º–∞–Ω–∏—è (–ø–æ–∫–∞ –µ—â–µ "—Å—ã—Ä–æ–≥–æ")  —Ç–æ–∫–µ–Ω `[CLS]` –¥–æ–ª–∂–µ–Ω —É–¥–µ–ª–∏—Ç—å —Ç–æ–∫–µ–Ω—É –≤ –ø–æ–∑–∏—Ü–∏–∏ `j`.

        –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ [CLS]:
          ```python
          Q: [[-22.9001 -31.6346  6.0742]    # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 0
              [ 41.4631   5.2998  6.2346]    # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 1
              [ 29.6049 -43.8211 -13.9067]   # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 2
              [ -9.0778  17.0357  -0.9468]   # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 3
              [ 19.0137  -6.5111 -15.9635]   # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 4
              [-42.3292 -31.1711  -1.0993]   # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 5
              [ 22.1916 -19.8376  24.6427]   # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 6
              [-11.865  -57.7867 -35.5895]]  # –≤–µ–∫—Ç–æ—Ä –≥–æ–ª–æ–≤—ã 7
          ```

          –ü—Ä–æ—Ü–µ—Å—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:
          
            - –î–ª—è –≥–æ–ª–æ–≤—ã 0:
              * –ë–µ—Ä–µ–º –≤–µ–∫—Ç–æ—Ä Q –≥–æ–ª–æ–≤—ã 0: [-22.9001 -31.6346 6.0742]
              * –£–º–Ω–æ–∂–∞–µ–º –µ–≥–æ –Ω–∞ –≤—Å–µ –≤–µ–∫—Ç–æ—Ä—ã K –¢–û–õ–¨–ö–û –≥–æ–ª–æ–≤—ã 0
            - –î–ª—è –≥–æ–ª–æ–≤—ã 1:
              * –ë–µ—Ä–µ–º –≤–µ–∫—Ç–æ—Ä Q –≥–æ–ª–æ–≤—ã 1: [41.4631 5.2998 6.2346]
              * –£–º–Ω–æ–∂–∞–µ–º –µ–≥–æ –Ω–∞ –≤—Å–µ –≤–µ–∫—Ç–æ—Ä—ã K –¢–û–õ–¨–ö–û –≥–æ–ª–æ–≤—ã 1
            - –ò —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã

    4.  **–†–µ–∑—É–ª—å—Ç–∞—Ç - —Ä—è–¥ —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:**
        *   –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç—Ç–∏—Ö 9 —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –º—ã –ø–æ–ª—É—á–∞–µ–º —Ä—è–¥ —á–∏—Å–µ–ª: `[score_0, score_1, score_2, score_3, score_4, score_5, score_6, score_7, score_8]`.
        *   **–ò–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Ä—è–¥ —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–ø–æ—Å–ª–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ Softmax) —Å—Ç–∞–Ω–µ—Ç –≤–µ—Å–∞–º–∏ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è —Ç–æ–∫–µ–Ω–∞ `[CLS]` –≤ –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤–µ.**  –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ—Å–ª–µ Softmax —ç—Ç–∏ –≤–µ—Å–∞ —Å—Ç–∞–ª–∏ `[1. 0. 0. 0. 0. 0. 0. 0. 0.]`.
      </div>

  - **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –¥–µ–ª–∏—Ç—Å—è –Ω–∞ $\sqrt{D_k}$, –≥–¥–µ $D_k$ ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ $D_k = 64$). –≠—Ç–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ.
  - **Softmax:** –§—É–Ω–∫—Ü–∏—è softmax –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.
    - Softmax –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è.
    - Softmax –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –º–∞—Ç—Ä–∏—Ü—ã (9, 9), —Ç–æ –µ—Å—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.
    - **–í–∞–∂–Ω–æ:** Softmax –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤–µ—Å–∞ —Ç–∞–∫, —á—Ç–æ –∏—Ö —Å—É–º–º–∞ —Ä–∞–≤–Ω–∞ 1. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–µ–Ω –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞.
    - –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ, –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏, –≤—ã –≤–∏–¥–∏—Ç–µ, —á—Ç–æ –≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è —Ä–∞–≤–Ω—ã `[1. 0. 0. 0. 0. 0. 0. 0. 0.]`. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ `[CLS]` (–ø–µ—Ä–≤–∞—è –ø–æ–∑–∏—Ü–∏—è) –Ω–∞–∏–±–æ–ª—å—à–µ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–µ—Ç—Å—è —Å–∞–º–æ–º—É —Ç–æ–∫–µ–Ω—É `[CLS]`, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –Ω–µ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è.

**3. –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π:**

  - –ü–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è, –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π (–º–∞—Ç—Ä–∏—Ü—ã V).
  - –í–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.
  - –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞.
  - –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ, –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏, –≤—ã –≤–∏–¥–∏—Ç–µ –º–∞—Ç—Ä–∏—Ü—É Z, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π.

**4. –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤:**

  - –í—ã—Ö–æ–¥—ã –≤—Å–µ—Ö –≥–æ–ª–æ–≤ (–º–∞—Ç—Ä–∏—Ü—ã Z) –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.
  - –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ, –∫–∞–∂–¥–∞—è –º–∞—Ç—Ä–∏—Ü–∞ Z –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `torch.Size([3, 8, 9, 64])`. –ü–æ—Å–ª–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞ `torch.Size([3, 9, 512])`.
  - –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–µ–∫—Ç–æ—Ä—ã —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 64 –∏–∑ –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã "—Å–∫–ª–µ–∏–≤–∞—é—Ç—Å—è" –≤ –æ–¥–∏–Ω –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 512.

**5. –õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞:**

  - –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$ (512 –≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ) —Å –ø–æ–º–æ—â—å—é –æ–±—É—á–∞–µ–º–æ–π –º–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤ $W^O$.
  - –≠—Ç–æ –¥–∞–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ Multi-Head Attention.

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã $W^O$:**

    –ú–∞—Ç—Ä–∏—Ü–∞ $W^O$ ("W-output"") –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é **–ª–∏–Ω–µ–π–Ω–æ–π –ø—Ä–æ–µ–∫—Ü–∏–∏**, –ø–æ–¥–æ–±–Ω–æ –º–∞—Ç—Ä–∏—Ü–∞–º $W^Q$, $W_K$ –∏ $W_V$, –Ω–æ –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –æ–Ω–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ **–∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –≤—ã—Ö–æ–¥—É –≤—Å–µ—Ö –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è**.

    **–¶–µ–ª—å $W^O$**:

    * **–°–≤–µ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å:**  –ü–æ—Å–ª–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–æ–≤ –≤—Å–µ—Ö –≥–æ–ª–æ–≤, –º—ã –ø–æ–ª—É—á–∞–µ–º –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∞ (–≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —Å 64 –¥–æ 512, —Ç–∞–∫ –∫–∞–∫ 8 –≥–æ–ª–æ–≤ * 64 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã = 512). –ú–∞—Ç—Ä–∏—Ü–∞ $W^O$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–ø—Ä–æ–µ–∫—Ü–∏–∏ —ç—Ç–æ–≥–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –æ–±—Ä–∞—Ç–Ω–æ –∫ –∏—Å—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏** ($D_{model}$, –≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ 512).  –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã—Ö–æ–¥ Multi-Head Attention –∏–º–µ–ª —Ç—É –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, —á—Ç–æ –∏ –≤—Ö–æ–¥, –∏ –º–æ–≥ –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –æ—Å—Ç–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–ª–æ–∏ Feed-Forward Network –∏–ª–∏ Residual Connections).
    * **–°–º–µ—à–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç —Ä–∞–∑–Ω—ã—Ö –≥–æ–ª–æ–≤:**  –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ "—Å–∫–ª–µ–∏–≤–∞–µ—Ç" –≤—ã—Ö–æ–¥—ã —Ä–∞–∑–Ω—ã—Ö –≥–æ–ª–æ–≤. –ú–∞—Ç—Ä–∏—Ü–∞ $W^O$ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∏ —Å–º–µ—à–∏–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –ø–æ–ª—É—á–µ–Ω–Ω—É—é –æ—Ç —Ä–∞–∑–Ω—ã—Ö –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è**.  –ö–∞–∂–¥–∞—è –≥–æ–ª–æ–≤–∞ –º–æ–≥–ª–∞ —É–ª–æ–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö, –∏ $W^O$ –ø–æ–º–æ–≥–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —ç—Ç–∏ —Ä–∞–∑–Ω—ã–µ "—Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è" –≤ –µ–¥–∏–Ω–æ–µ, –æ–±–æ–±—â–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.

    **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü:**

    –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ.

    * **–í—ã—Ö–æ–¥ –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã (Z):**  –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ, –ø–æ—Å–ª–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π, –∫–∞–∂–¥–∞—è –≥–æ–ª–æ–≤–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –º–∞—Ç—Ä–∏—Ü—É $Z$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `torch.Size([3, 8, 9, 64])`.  –ï—Å–ª–∏ –º—ã –≥–æ–≤–æ—Ä–∏–º –æ–± **–æ–¥–Ω–æ–º –±–∞—Ç—á–µ, –æ–¥–Ω–æ–π –≥–æ–ª–æ–≤–µ –∏ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏—è—Ö –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**, —Ç–æ —ç—Ç–æ –±—É–¥–µ—Ç –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `[9, 64]` (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ 9 —Ç–æ–∫–µ–Ω–æ–≤, –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 64 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞).
    * **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤:**  –í—ã—Ö–æ–¥—ã –≤—Å–µ—Ö –≥–æ–ª–æ–≤ (–≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ 8 –≥–æ–ª–æ–≤) –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è **–ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏**.  –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤–µ–∫—Ç–æ—Ä—ã —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 64 –æ—Ç –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã "—Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è" —Ä—è–¥–æ–º.  –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–ª—è **–æ–¥–Ω–æ–≥–æ –±–∞—Ç—á–∞ –∏ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**, –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã—Ö–æ–¥ –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `[9, 512]` (9 —Ç–æ–∫–µ–Ω–æ–≤, –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 512 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞, –≥–¥–µ 512 = 8 –≥–æ–ª–æ–≤ * 64 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≥–æ–ª–æ–≤—ã).  –û–±–æ–∑–Ω–∞—á–∏–º —ç—Ç—É –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –∫–∞–∫ $Z_{concat}$.
    * **–ú–∞—Ç—Ä–∏—Ü–∞ $W^O$:** –ú–∞—Ç—Ä–∏—Ü–∞ $W^O$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å  $(D_{model} \times D_{model})$, –≤ –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ $(512 \times 512)$.  –û–Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$ (512 –ø–æ—Å–ª–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏) –æ–±—Ä–∞—Ç–Ω–æ –≤ –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$ (512).

    **–ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ:**

    –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ Multi-Head Attention –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø—É—Ç–µ–º **—É–º–Ω–æ–∂–µ–Ω–∏—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $Z_{concat}$ –Ω–∞ –º–∞—Ç—Ä–∏—Ü—É $W^O$**:

    $Output_{MHA} = Z_{concat} \times W^O$

    –í —Ç–µ—Ä–º–∏–Ω–∞—Ö —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π:

    `[batch_size, seq_len, num_heads * head_dim]`  —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞  `[num_heads * head_dim,  D_{model}]`  =  `[batch_size, seq_len, D_{model}]`

    –í –≤–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ:

    `[3, 9, 512]`  —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞  `[512, 512]`  =  `[3, 9, 512]`

    > –ò–∑–≤–∏–Ω—è—é—Å—å,¬†–Ω–µ —Å–∞–º—ã–π —É–¥–∞—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä, —Ç–∞–∫ –∫–∞–∫ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å. –í–æ—Ç –∫—Ä–∞—Ç–∫–∏–π –ø—Ä–∏–º–µ—Ä —Å –¥—Ä—É–≥–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é

    ```
    –í—Ö–æ–¥:  [3, 9, 256]  (D_model = 256)
    |
    |  Multi-Head Attention (num_heads=4, head_dim=128)
    |
    –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤: [3, 9, 512]  (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å –¥–æ 512 = 4 * 128)
    |
    |  –õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è W^O (–º–∞—Ç—Ä–∏—Ü–∞ 512x256)
    |
    –í—ã—Ö–æ–¥: [3, 9, 256]  (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ—Ä–Ω—É–ª–∞—Å—å –∫ D_model = 256)
    ```

    **4. –ò—Ç–æ–≥ –ø–æ $W^O$:**

    * **$W^O$ - —ç—Ç–æ –æ–±—É—á–∞–µ–º–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤.** –û–Ω–∞, –∫–∞–∫ –∏ $W^Q$, $W_K$, $W_V$, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.
    * **$W^O$ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–æ–≤ –≤—Å–µ—Ö –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è.**
    * **$W^O$ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ª–∏–Ω–µ–π–Ω—É—é –ø—Ä–æ–µ–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è:**
        * **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–π $D_{model}$.**
        * **–°–º–µ—à–∏–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –ø–æ–ª—É—á–µ–Ω–Ω—É—é –æ—Ç —Ä–∞–∑–Ω—ã—Ö –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è.**
    * **–†–µ–∑—É–ª—å—Ç–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ $W^O$ —è–≤–ª—è–µ—Ç—Å—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–º –≤—ã—Ö–æ–¥–æ–º —Å–ª–æ—è Multi-Head Attention.**

**–í–ª–∏—è–Ω–∏–µ Softmax:**

- Softmax –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ –≤–Ω–∏–º–∞–Ω–∏—è, –ø—Ä–µ–æ–±—Ä–∞–∑—É—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–ª—é—á–µ–π –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.
- –≠—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–≤–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–µ–Ω –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞.
- Softmax –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ —Å—É–º–º–∞ –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è —Ä–∞–≤–Ω–∞ 1, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏.

**–í –∏—Ç–æ–≥–µ:**

Softmax –≤–Ω—É—Ç—Ä–∏ Multi-Head Attention –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –Ω–∞ –∫–∞–∫–∏–µ —á–∞—Å—Ç–∏ –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π –∏ —Å–ø–æ—Å–æ–±–Ω–æ–π —É–ª–∞–≤–ª–∏–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö.

```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import math

# –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import numpy as np
import torch


def positional_encoding(max_len: int, d_model: int) -> torch.Tensor:
    """
    Description:
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–∏ Transformer.

    Args:
        max_len: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        d_model: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤).

    Returns:
        –¢–µ–Ω–∑–æ—Ä –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π —Ñ–æ—Ä–º—ã (max_len, d_model).

    Examples:
        >>> pe = positional_encoding(10, 512)
        >>> pe.shape
        torch.Size([10, 512])
    """
    pe = torch.zeros(max_len, d_model)
    position = torch.arange(0, max_len, dtype=torch.float).unsqueeze(1)
    div_term = torch.exp(
        torch.arange(0, d_model, 2).float() * (-math.log(10000.0) / d_model)
    )

    pe[:, 0::2] = torch.sin(position * div_term)
    pe[:, 1::2] = torch.cos(position * div_term)
    return pe


def print_embeddings(
    tensor: torch.Tensor, tokens: list, title: str, max_elements: int = 3
) -> None:
    """
    Description:
        –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å –º–µ—Ç–∫–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤.

    Args:
        tensor: –¢–µ–Ω–∑–æ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
        tokens: –°–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞.
        max_elements: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

    Returns:
        None

    Examples:
        >>> embeddings = torch.randn(5, 512)
        >>> tokens = ["token1", "token2", "token3", "token4", "token5"]
        >>> print_embeddings(embeddings, tokens, "–ü—Ä–∏–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤")
    """
    print(f"\n{title}:")
    for idx, (vec, token) in enumerate(zip(tensor, tokens)):
        elements = vec[:max_elements].detach().numpy().round(4)
        print(f"{idx:2d} {token:15}: [{', '.join(f'{x:7.4f}' for x in elements)}...]")


def print_attention_details(
    batch_idx: int,
    head_idx: int,
    pos_idx: int,
    Q: torch.Tensor,
    K: torch.Tensor,
    attention_scores: torch.Tensor,
    attention_weights: torch.Tensor,
    tokens: list,
    num_elements: int = 5,
) -> None:
    """
    Description:
        –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏.

    Args:
        batch_idx: –ò–Ω–¥–µ–∫—Å –±–∞—Ç—á–∞.
        head_idx: –ò–Ω–¥–µ–∫—Å –≥–æ–ª–æ–≤—ã –≤–Ω–∏–º–∞–Ω–∏—è.
        pos_idx: –ü–æ–∑–∏—Ü–∏—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        Q: –¢–µ–Ω–∑–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤.
        K: –¢–µ–Ω–∑–æ—Ä –∫–ª—é—á–µ–π.
        attention_scores: –¢–µ–Ω–∑–æ—Ä —Å—ã—Ä—ã—Ö –æ—Ü–µ–Ω–æ–∫ –≤–Ω–∏–º–∞–Ω–∏—è.
        attention_weights: –¢–µ–Ω–∑–æ—Ä –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ softmax.
        tokens: –°–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤.
        num_elements: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞.

    Returns:
        None
    """
    print("\n" + "=" * 60)
    print(
        f"–î–µ—Ç–∞–ª–∏ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –±–∞—Ç—á–∞ {batch_idx}, –≥–æ–ª–æ–≤—ã {head_idx}, "
        f"–ø–æ–∑–∏—Ü–∏–∏ {pos_idx} ({tokens[batch_idx][pos_idx]}):"
    )

    # –í—ã–≤–æ–¥ Q –≤–µ–∫—Ç–æ—Ä–∞
    q_vec = Q[batch_idx, head_idx, pos_idx, :num_elements].detach().numpy()
    print(f"Q –≤–µ–∫—Ç–æ—Ä (–ø–µ—Ä–≤—ã–µ {num_elements} —ç–ª–µ–º–µ–Ω—Ç–æ–≤):")
    print(f"{q_vec.round(4)}")

    # –í—ã–≤–æ–¥ K –≤–µ–∫—Ç–æ—Ä–æ–≤
    print(f"K –≤–µ–∫—Ç–æ—Ä–∞ (–ø–µ—Ä–≤—ã–µ {num_elements} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ):")
    for i, token in enumerate(tokens[batch_idx]):
        k_vec = K[batch_idx, head_idx, i, :num_elements].detach().numpy()
        print(f"{i:2d} {token:15}: {k_vec.round(4)}")

    # –†—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π
    manual_scores = []
    q = Q[batch_idx, head_idx, pos_idx]
    for i in range(len(tokens[batch_idx])):
        k = K[batch_idx, head_idx, i]
        score = torch.dot(q, k) / math.sqrt(D_k)
        manual_scores.append(score.item())

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫
    auto_scores = attention_scores[batch_idx, head_idx, pos_idx].detach().numpy()

    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print("\n–°—ã—Ä—ã–µ –æ—Ü–µ–Ω–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è:")
    print(f"–†—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç:     {np.array(manual_scores).round(4)}")
    print(f"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π:    {auto_scores.round(4)}")

    # –í—ã–≤–æ–¥ –≤–µ—Å–æ–≤ –ø–æ—Å–ª–µ softmax
    weights = attention_weights[batch_idx, head_idx, pos_idx].detach().numpy()
    print(f"\n–í–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ Softmax:")
    print(f"{weights.round(4)}")


# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
sentences = [
    "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –Ø —É–≤–ª–µ–∫–∞—é—Å—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º",
    "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?",
    "–ò–ò ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!",
]

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
N = len(sentences)  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
L = 9  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
D_model = 512  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
h = 8  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤
D_k = D_model // h  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∏ –∑–∞–ø—Ä–æ—Å–æ–≤
D_v = D_model // h  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π

# 1. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–∞–¥–¥–∏–Ω–≥–æ–º
batch_tokens = [
    ["[CLS]", "–í—Å–µ–º", "–ø—Ä–∏–≤–µ—Ç", "!", "–Ø", "—É–≤–ª–µ–∫–∞—é—Å—å", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º", "[SEP]"],
    ["[CLS]", "–ü—Ä–∏–≤–µ—Ç", ",", "–∫–∞–∫", "–¥–µ–ª–∞", "?", "[SEP]", "[PAD]", "[PAD]"],
    ["[CLS]", "–ò–ò", "‚Äî", "—ç—Ç–æ", "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ", "!", "[SEP]", "[PAD]", "[PAD]"],
]

# 2. –°–æ–∑–¥–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
embeddings = torch.randn(N, L, D_model)

# 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
pe = positional_encoding(L, D_model)

# 4. –ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
X_embedded = embeddings + pe  # Broadcasting –¥–ª—è –±–∞—Ç—á–∞

# ================= –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ =================
print("=" * 60)
print("–®–∞–≥ 1: –ò—Å—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–∫–µ–Ω–æ–≤")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {embeddings.shape}")
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    print_embeddings(embeddings[batch_idx], batch_tokens[batch_idx], "–ò—Å—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏")

print("\n" + "=" * 60)
print("–®–∞–≥ 2: –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {pe.shape}")
print_embeddings(pe, [f"–ü–æ–∑–∏—Ü–∏—è {i}" for i in range(L)], "–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π")

print("\n" + "=" * 60)
print("–®–∞–≥ 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (X + PE)")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {X_embedded.shape}")
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    print_embeddings(X_embedded[batch_idx], batch_tokens[batch_idx], "–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ–∂–µ–Ω–∏—è")

# ================= –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ =================
print("\n" + "=" * 60)
print("–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞:")
batch_idx = 0

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print(f"\n–¢–µ–∫—Å—Ç: '{sentences[batch_idx]}'")
print(f"–¢–æ–∫–µ–Ω—ã: {batch_tokens[batch_idx]}")

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥:  {embeddings[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä:   {pe[pos, :3].detach().numpy().round(4)}")
    print(f"–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:     {X_embedded[batch_idx, pos, :3].detach().numpy().round(4)}")

# ================= Multi-Head Self-Attention =================
print("\n" + "=" * 60)
print("–®–∞–≥ 4: Multi-Head Self-Attention")

# 1. –õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏
W_Q = torch.randn(h, D_model, D_k)
W_K = torch.randn(h, D_model, D_k)
W_V = torch.randn(h, D_model, D_v)

Q = torch.einsum('nlk,hkd->nhld', X_embedded, W_Q)
K = torch.einsum('nlk,hkd->nhld', X_embedded, W_K)
V = torch.einsum('nlk,hkd->nhld', X_embedded, W_V)

print("\n–õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏:")
print(f"–§–æ—Ä–º–∞ Q: {Q.shape}")
print(f"–§–æ—Ä–º–∞ K: {K.shape}")
print(f"–§–æ—Ä–º–∞ V: {V.shape}")

# –í—ã–≤–æ–¥ –ø–µ—Ä–≤—ã—Ö 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è Q, K, V
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    for pos in [0, 2, 4]:
        print(f"  –ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
        print(f"    Q: {Q[batch_idx, :, pos, :3].detach().numpy().round(4)}")
        print(f"    K: {K[batch_idx, :, pos, :3].detach().numpy().round(4)}")
        print(f"    V: {V[batch_idx, :, pos, :3].detach().numpy().round(4)}")

# –ü–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ attention_weights –¥–æ–±–∞–≤–ª—è–µ–º:
print_attention_details(
    batch_idx=0,
    head_idx=0,
    pos_idx=0,
    Q=Q,
    K=K,
    attention_scores=attention_scores,
    attention_weights=attention_weights,
    tokens=batch_tokens,
)

# 2. –í–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã
attention_scores = torch.einsum('nhld,nhmd->nhlm', Q, K) / math.sqrt(D_k)

# –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–¥–¥–∏–Ω–≥–∞
mask = torch.ones(N, 1, L, L, dtype=torch.bool)
for batch_idx, tokens in enumerate(batch_tokens):
    for i, token in enumerate(tokens):
        if token == "[PAD]":
            mask[batch_idx, :, i:, :] = False
            mask[batch_idx, :, :, i:] = False
attention_scores = attention_scores.masked_fill(~mask, float('-inf'))

attention_weights = torch.softmax(attention_scores, dim=-1)
Z = torch.einsum('nhlm,nhmd->nhld', attention_weights, V)

print("\n–í–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã:")
print(f"–§–æ—Ä–º–∞ Z: {Z.shape}")

# –í—ã–≤–æ–¥ –ø–µ—Ä–≤—ã—Ö 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è Z
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    for pos in [0, 2, 4]:
        print(f"  –ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
        print(f"    Z: {Z[batch_idx, :, pos, :3].detach().numpy().round(4)}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
print("\n–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏:")
print(f"–í–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è (–ø–µ—Ä–≤–∞—è –≥–æ–ª–æ–≤–∞, –ø–µ—Ä–≤–∞—è –ø–æ–∑–∏—Ü–∏—è): {attention_weights[0, 0, 0, :].detach().numpy().round(4)}")

# 3. –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤
Z_concat = Z.transpose(1, 2).reshape(N, L, h * D_v)

print("\n–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤:")
print(f"–§–æ—Ä–º–∞ Z_concat: {Z_concat.shape}")

# 4. –õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
W_O = torch.randn(h * D_v, D_model)
multi_head_output = torch.einsum('nlk,kd->nld', Z_concat, W_O)

print("\n–õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞:")
print(f"–§–æ—Ä–º–∞ MultiHead Output: {multi_head_output.shape}")

# –í—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞
print("\n–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Multi-Head Attention:")
batch_idx = 0
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:     {X_embedded[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"Multi-Head Output:  {multi_head_output[batch_idx, pos, :3].detach().numpy().round(4)}")
```

4. **–°–ª–æ–π Add & Norm (–ø–æ—Å–ª–µ Multi-Head Attention):**
   - **Add (–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ):** 

        *   **–°—É—Ç—å –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:**  –û—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∫–∞–∫ skip-connection –∏–ª–∏ residual connection, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ **–≤—ã—Ö–æ–¥ —Å–ª–æ—è Multi-Head Attention –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–º—É –≤—Ö–æ–¥—É**.

            –í —Ñ–æ—Ä–º—É–ª–µ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
            $$
            \text{Output}_{Add1} = X_{embedded} + \text{MultiHead}(Q, K, V)
            $$
            –≥–¥–µ:
            *   $X_{embedded}$ - —ç—Ç–æ **–≤—Ö–æ–¥** –ø–æ–¥—Å–ª–æ—è Multi-Head Attention. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Transformer, —ç—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ, —É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–µ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–ª–æ–∏ Transformer.
            *   $\text{MultiHead}(Q, K, V)$ - —ç—Ç–æ **–≤—ã—Ö–æ–¥** —Å–ª–æ—è Multi-Head Attention.
            *   $\text{Output}_{Add1}$ - —ç—Ç–æ **—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ–∂–µ–Ω–∏—è**, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Ö–æ–¥–æ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ—è.

            > –¢–æ –µ—Å—Ç—å,¬†–ø–æ —Å—É—Ç–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±—ã—á–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã –¥–≤—É—Ö –º–∞—Ç—Ä–∏—Ü, –∞ —Ç–æ—á–Ω–µ–µ –¥–≤—É—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.

        *   **–ó–∞—á–µ–º –Ω—É–∂–Ω—ã –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è?**

            *   **–ë–æ—Ä—å–±–∞ —Å –ø—Ä–æ–±–ª–µ–º–æ–π –∑–∞—Ç—É—Ö–∞–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞:**  –í –≥–ª—É–±–æ–∫–∏—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ Transformer, –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã (—Å–∏–≥–Ω–∞–ª—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è) –º–æ–≥—É—Ç –∑–∞—Ç—É—Ö–∞—Ç—å –ø–æ –º–µ—Ä–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ª–æ–µ–≤. –û—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ–º–æ–≥–∞—é—Ç **"–ø–µ—Ä–µ–ø—Ä—ã–≥–∏–≤–∞—Ç—å" —á–µ—Ä–µ–∑ —Å–ª–æ–∏**, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–æ–ª–µ–µ –ø—Ä—è–º–æ–π –ø—É—Ç—å –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –≠—Ç–æ –æ–±–ª–µ–≥—á–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –≥–ª—É–±–æ–∫–∏—Ö —Å–µ—Ç–µ–π –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É—á–∏—Ç—å—Å—è.
            *   **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è –≥–ª—É–±–æ–∫–∏—Ö —Å–µ—Ç–µ–π:**  –û—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±—É—á–∞—Ç—å **–±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–µ –∏ —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏**. –ë–µ–∑ –Ω–∏—Ö, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–ª–æ–µ–≤ –≤ –≥–ª—É–±–æ–∫—É—é —Å–µ—Ç—å —á–∞—Å—Ç–æ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —É–ª—É—á—à–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ –º–æ–∂–µ—Ç –¥–∞–∂–µ —É—Ö—É–¥—à–∏—Ç—å –µ–µ. Residual connections –ø–æ–∑–≤–æ–ª—è—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≥–ª—É–±–æ–∫–∏—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä.
            *   **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Ö–æ–¥–µ:**  –î–æ–±–∞–≤–ª—è—è –∏—Å—Ö–æ–¥–Ω—ã–π –≤—Ö–æ–¥ –∫ –≤—ã—Ö–æ–¥—É —Å–ª–æ—è –≤–Ω–∏–º–∞–Ω–∏—è, –º—ã **—Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Å—Ö–æ–¥–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–∞—Ö**.  –°–ª–æ–π –≤–Ω–∏–º–∞–Ω–∏—è —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ *–∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö* –∏ *—É—Ç–æ—á–Ω–µ–Ω–∏–∏* –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π, –∞ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∏—Å—Ö–æ–¥–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Ç–µ—Ä—è–Ω–∞.

   - **Norm (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è):** 

        *   **–°—É—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ—è:**  –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è - —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **–∫ –≤—ã—Ö–æ–¥–∞–º –Ω–µ–π—Ä–æ–Ω–Ω–æ–≥–æ —Å–ª–æ—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –æ–±—É—á–∞—é—â–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞**. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Batch Normalization, –∫–æ—Ç–æ—Ä–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–æ –±–∞—Ç—á—É, Layer Normalization –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç **–ø–æ –ø—Ä–∏–∑–Ω–∞–∫–∞–º –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞**.

            –í Transformer –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ Layer Normalization. –§–æ—Ä–º—É–ª–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
            $$
            \text{Output}_{Norm1} = \text{LayerNorm}(\text{Output}_{Add1}) = \gamma \frac{\text{Output}_{Add1} - \mu}{\sigma} + \beta
            $$
            –≥–¥–µ:
            *   $\text{Output}_{Add1}$ - —ç—Ç–æ **–≤—Ö–æ–¥** –¥–ª—è —Å–ª–æ—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
            *   $\mu$ - —ç—Ç–æ **—Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ö–æ–¥–∞ $\text{Output}_{Add1}$ **–ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏).
            *   $\sigma$ - —ç—Ç–æ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ** —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ö–æ–¥–∞ $\text{Output}_{Add1}$ **–ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏).
            *   $\gamma$ (–≥–∞–º–º–∞) –∏ $\beta$ (–±–µ—Ç–∞) - —ç—Ç–æ **–æ–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–¥–≤–∏–≥–∞**. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–µ—Ç–∏ **–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å** —Å—Ç–µ–ø–µ–Ω—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ $\gamma$ –æ–±—ã—á–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –µ–¥–∏–Ω–∏—Ü–∞–º–∏, –∞ $\beta$ - –Ω—É–ª—è–º–∏.
            *   $\text{Output}_{Norm1}$ - —ç—Ç–æ **–≤—ã—Ö–æ–¥** —Å–ª–æ—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Ö–æ–¥–æ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–¥—Å–ª–æ—è (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, Feed Forward Network).

            > –¢–æ –µ—Å—Ç—å, –ø–æ —Å—É—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è, –∞ —Ç–æ—á–Ω–µ–µ –≤—Å–µ—Ö –≤–µ—Å–æ–≤ –≤—ã—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –æ—Å—Ç–∞—Ç–∫–æ–≤ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∞ –Ω–∞ Z-score –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—É—é –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è), –∫–æ—Ç–æ—Ä–∞—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é. –§–æ—Ä–º—É–ª–∞ Layer Normalization, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏:

            $$
            \text{LayerNorm}(x) = \gamma \frac{x - \mu}{\sigma} + \beta
            $$

        *   **–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è?**

            *   **–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è:** –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è **—Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è**, –¥–µ–ª–∞—è –µ–≥–æ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–º –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–º. –û–Ω–∞ –ø–æ–º–æ–≥–∞–µ—Ç **—É–º–µ–Ω—å—à–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ (internal covariate shift)**, —Ç–æ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫ –±–æ–ª–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É –∑–Ω–∞—á–µ–Ω–∏–π (–±–ª–∏–∑–∫–æ–º—É –∫ –Ω—É–ª–µ–≤–æ–º—É —Å—Ä–µ–¥–Ω–µ–º—É –∏ –µ–¥–∏–Ω–∏—á–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—é).
            *   **–£—Å–∫–æ—Ä–µ–Ω–∏–µ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏:**  –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è (learning rates)** –∏ **—É—Å–∫–æ—Ä—è–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å** –º–æ–¥–µ–ª–∏ –∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º—É —Ä–µ—à–µ–Ω–∏—é.
            *   **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**  –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è –º–æ–∂–µ—Ç —Ç–∞–∫–∂–µ —Å–ø–æ—Å–æ–±—Å—Ç–≤–æ–≤–∞—Ç—å **–ª—É—á—à–µ–π –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏** –º–æ–¥–µ–ª–∏, —Ç–æ –µ—Å—Ç—å –µ–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –Ω–æ–≤—ã—Ö, —Ä–∞–Ω–µ–µ –Ω–µ –≤–∏–¥–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
            *   **–ú–µ–Ω—å—à–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –±–∞—Ç—á–∞:**  –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Batch Normalization, Layer Normalization **–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –±–∞—Ç—á–∞**. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–µ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ–π –≤ —Å–∏—Ç—É–∞—Ü–∏—è—Ö, –∫–æ–≥–¥–∞ —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –Ω–µ–±–æ–ª—å—à–æ–π –∏–ª–∏ –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏, –≥–¥–µ –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è.

            **–ê–Ω–∞–ª–æ–≥–∏—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å –∑–≤—É–∫–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.  –£ –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –≥—Ä–æ–º–∫–æ—Å—Ç–∏. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è - —ç—Ç–æ –∫–∞–∫ **–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –∫ –µ–¥–∏–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É** –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.  –≠—Ç–æ –æ–±–ª–µ–≥—á–∞–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–≤—É–∫–∞, –¥–µ–ª–∞—è —Å–∏—Å—Ç–µ–º—É –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã $\gamma$ –∏ $\beta$ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–µ–º–Ω–æ–≥–æ "–ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å" —ç—Ç–æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç, —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

5. **–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –ø—Ä—è–º–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è (Feed Forward Network):**

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ FFN:**

    FFN - —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ Transformer, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ **–Ω–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π**.  –í —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ Multi-Head Attention –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–∫–µ–Ω–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç, FFN –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ **–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ**, –Ω–æ —É–∂–µ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –æ—Ç —Å–ª–æ—è –≤–Ω–∏–º–∞–Ω–∏—è.

   - –ù–∞ –≤—Ö–æ–¥ –ø–æ–¥—Å–ª–æ—è FFN –ø–æ—Å—Ç—É–ø–∞–µ—Ç $\text{Output}_{Norm1}$.
   - FFN —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ–µ–≤ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ReLU, GeLU) –º–µ–∂–¥—É –Ω–∏–º–∏:
     $$
     \text{FFN}(\text{Output}_{Norm1}) = \text{Activation}(\text{Output}_{Norm1} W_1 + b_1) W_2 + b_2
     $$
     –≥–¥–µ:

        - $W_1 \in \mathbb{R}^{D_{model} \times D_{ff}}$
        - $W_2 \in \mathbb{R}^{D_{ff} \times D_{model}}$ - –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã
        - $b_1 \in \mathbb{R}^{D_{ff}}$, $b_2 \in \mathbb{R}^{D_{model}}$ - –≤–µ–∫—Ç–æ—Ä—ã —Å–º–µ—â–µ–Ω–∏–π
        - $D_{ff}$ - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å FFN (–æ–±—ã—á–Ω–æ $4 \times D_{model}$).

        **–í—ã—Ö–æ–¥:** FFN –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥ –∏ –≤—ã–¥–∞–µ—Ç —Ç–µ–Ω–∑–æ—Ä **—Ç–æ–π –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏** $(N, L, D_{model})$, –≥–¥–µ:
            
        - $N$ ‚Äî —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –±–∞—Ç—á–µ),  
        - $L$ ‚Äî –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (—á–∏—Å–ª–æ —Ç–æ–∫–µ–Ω–æ–≤),  
        - $D_{model}$ ‚Äî —Å–∫—Ä—ã—Ç–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å (—Ä–∞–∑–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤).  
        
        –≠—Ç–æ—Ç –≤—ã—Ö–æ–¥ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–æ–π Transformer –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞).

    **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ FFN:**

    FFN —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **–¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ–µ–≤** —Å **—Ñ—É–Ω–∫—Ü–∏–µ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏** –º–µ–∂–¥—É –Ω–∏–º–∏.  –≠—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –¥–≤—É—Ö—Å–ª–æ–π–Ω—É—é –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ–º—É—é –∫ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

    **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã FFN –∏ —Ñ–æ—Ä–º—É–ª–∞:**

    $$
    \text{FFN}(x) = \text{Activation}(x W_1 + b_1) W_2 + b_2
    $$

    –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—É–ª—ã:

    1.  **–ü–µ—Ä–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Expansion Layer):**  `(x W_1 + b_1)`
        *   **–í—Ö–æ–¥:**  $x$ - —ç—Ç–æ –≤—Ö–æ–¥ FFN, —Ç–æ –µ—Å—Ç—å $\text{Output}_{Norm1}$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `[batch_size, sequence_length, hidden_size]` ($D_{model}$).
        *   **–í–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $W_1$**:  $W_1 \in \mathbb{R}^{D_{model} \times D_{ff}}$ - —ç—Ç–æ **–º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ –ø–µ—Ä–≤–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è**.  –û–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è **–æ–±—É—á–∞–µ–º—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º**.
        *   **–í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è $b_1$**: $b_1 \in \mathbb{R}^{D_{ff}}$ - —ç—Ç–æ **–≤–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è**. –û–Ω —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è **–æ–±—É—á–∞–µ–º—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º**.
        *   **–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å $D_{ff}$**: $D_{ff}$ - —ç—Ç–æ **–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è) —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å FFN**.  –û–±—ã—á–Ω–æ –æ–Ω–∞ **–±–æ–ª—å—à–µ, —á–µ–º $D_{model}$**, —á–∞—Å—Ç–æ –≤ 4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ ($D_{ff} = 4 \times D_{model}$).  –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ $D_{model} = 512$, —Ç–æ $D_{ff} = 2048$.  **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏** –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **"—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º" (expansion)**.
        *   **–û–ø–µ—Ä–∞—Ü–∏—è:**  –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** –≤—Ö–æ–¥–∞ $x$ –ø—É—Ç–µ–º –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ $W_1$ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏—è $b_1$.
        *   **–í—ã—Ö–æ–¥ –ø–µ—Ä–≤–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è:**  –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `[batch_size, sequence_length, D_{ff}]`.  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ **—É–≤–µ–ª–∏—á–∏–ª–∞—Å—å** —Å $D_{model}$ –¥–æ $D_{ff}$.

    2.  **–§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (Activation Function):**  `Activation(...)`
        *   **–í—Ö–æ–¥:**  –í—ã—Ö–æ–¥ –ø–µ—Ä–≤–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `[batch_size, sequence_length, D_{ff}]`.
        *   **–§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**  $\text{Activation}$ - —ç—Ç–æ **–Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**.  –í Transformer –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
            *   **ReLU (Rectified Linear Unit):**  $\text{ReLU}(z) = \max(0, z)$.  –ü—Ä–æ—Å—Ç–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –æ–±–Ω—É–ª—è—é—â–∞—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
            *   **GeLU (Gaussian Error Linear Unit):**  –ë–æ–ª–µ–µ –≥–ª–∞–¥–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —á–µ–º ReLU.  –§–æ—Ä–º—É–ª–∞ GeLU –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ, –Ω–æ —Å—É—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∞ —Ç–∞–∫–∂–µ –≤–Ω–æ—Å–∏—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å.
        *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**  –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ **–≤–≤–æ–¥–∏—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å** –≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ.  –ë–µ–∑ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏, FFN –±—ã–ª –±—ã –ø—Ä–æ—Å—Ç–æ –µ—â–µ –æ–¥–Ω–∏–º –ª–∏–Ω–µ–π–Ω—ã–º —Å–ª–æ–µ–º, –∏ Transformer –≤ —Ü–µ–ª–æ–º –±—ã–ª –±—ã —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–µ–Ω –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏, —á—Ç–æ —Å–∏–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–ª–æ –±—ã –µ–≥–æ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.  –ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—å **—Å–ª–æ–∂–Ω—ã–µ, –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –≤ –¥–∞–Ω–Ω—ã—Ö.
        *   **–í—ã—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Ç–µ–Ω–∑–æ—Ä–∞ **–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è** –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.  –í—ã—Ö–æ–¥ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `[batch_size, sequence_length, D_{ff}]`.

    3.  **–í—Ç–æ—Ä–æ–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Contraction Layer):**  `(... ) W_2 + b_2`
        *   **–í—Ö–æ–¥:**  –í—ã—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `[batch_size, sequence_length, D_{ff}]`.
        *   **–í–µ—Å–æ–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $W_2$**:  $W_2 \in \mathbb{R}^{D_{ff} \times D_{model}}$ - —ç—Ç–æ **–º–∞—Ç—Ä–∏—Ü–∞ –≤–µ—Å–æ–≤ –≤—Ç–æ—Ä–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è**.  –¢–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è **–æ–±—É—á–∞–µ–º—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º**.
        *   **–í–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è $b_2$**: $b_2 \in \mathbb{R}^{D_{model}}$ - —ç—Ç–æ **–≤–µ–∫—Ç–æ—Ä —Å–º–µ—â–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è**.  –¢–∞–∫–∂–µ **–æ–±—É—á–∞–µ–º—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä**.
        *   **–û–ø–µ—Ä–∞—Ü–∏—è:**  –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** –≤—ã—Ö–æ–¥–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—É—Ç–µ–º –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ $W_2$ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏—è $b_2$.
        *   **–í—ã—Ö–æ–¥ –≤—Ç–æ—Ä–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è (–∏ FFN –≤ —Ü–µ–ª–æ–º):**  –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ç–µ–Ω–∑–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ `[batch_size, sequence_length, D_{model}]`.  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è** –∫ –∏—Å—Ö–æ–¥–Ω–æ–π $D_{model}$.  –≠—Ç–æ **"—Å–∂–∞—Ç–∏–µ" (contraction)** —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.

    **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ FFN –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ:**

    –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, $D_{model} = 512$ –∏ $D_{ff} = 4 \times D_{model} = 2048$.

    1.  **–í—Ö–æ–¥ $x$**:  `[batch_size, sequence_length, 512]`
    2.  **–ü–µ—Ä–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π $(x W_1 + b_1)$**:
        *   $W_1$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `[512, 2048]`
        *   –í—ã—Ö–æ–¥: `[batch_size, sequence_length, 2048]` (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–∏–ª–∞—Å—å)
    3.  **–§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ $\text{Activation}$**:
        *   –í—Ö–æ–¥: `[batch_size, sequence_length, 2048]`
        *   –í—ã—Ö–æ–¥: `[batch_size, sequence_length, 2048]` (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)
    4.  **–í—Ç–æ—Ä–æ–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π $(... ) W_2 + b_2)$**:
        *   $W_2$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å `[2048, 512]`
        *   –í—ã—Ö–æ–¥: `[batch_size, sequence_length, 512]` (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∂–∞–ª–∞—Å—å –æ–±—Ä–∞—Ç–Ω–æ –∫ –∏—Å—Ö–æ–¥–Ω–æ–π)

    **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã $W_1$ –∏ $W_2$:**

    *   **$W_1$ (–º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è):**  –ú–∞—Ç—Ä–∏—Ü–∞ $W_1$ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ **–ø—Ä–æ–µ–∫—Ü–∏—é –≤—Ö–æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$ –≤ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{ff}$**.  –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç FFN **—É–≤–µ–ª–∏—á–∏—Ç—å –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ "–∑–∞–ø–æ–º–Ω–∏—Ç—å" –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º —ç—Ç–∞–ø–µ.
    *   **$W_2$ (–º–∞—Ç—Ä–∏—Ü–∞ —Å–∂–∞—Ç–∏—è):**  –ú–∞—Ç—Ä–∏—Ü–∞ $W_2$ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ **–ø—Ä–æ–µ–∫—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–æ –∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{ff}$ –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D_{model}$**.  –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –≤—ã—Ö–æ–¥ FFN –∏–º–µ–ª —Ç—É –∂–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, —á—Ç–æ –∏ –≤—Ö–æ–¥, –∏ –º–æ–≥ –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –æ—Å—Ç–∞–ª—å–Ω—É—é —á–∞—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Transformer.  –¢–∞–∫–∂–µ, –º–∞—Ç—Ä–∏—Ü–∞ $W_2$ –ø–æ–∑–≤–æ–ª—è–µ—Ç **—Å–º–µ—à–∞—Ç—å –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**, –ø–æ–ª—É—á–µ–Ω–Ω—É—é –Ω–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º —ç—Ç–∞–ø–µ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –±–æ–ª—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.

    **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω FFN –≤ Transformer?**

    *   **–í–≤–µ–¥–µ–Ω–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏:**  FFN –≤–Ω–æ—Å–∏—Ç **–Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å** –≤ –º–æ–¥–µ–ª—å, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö.
    *   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–∑–∏—Ü–∏–π:**  FFN –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –∫ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏** –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.  –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å **–±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–µ, –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç –±—ã–ª —É—á—Ç–µ–Ω —Å–ª–æ–µ–º –≤–Ω–∏–º–∞–Ω–∏—è.
    *   **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏:**  –ó–∞ —Å—á–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –¥–æ $D_{ff}$ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∂–∞—Ç–∏—è –æ–±—Ä–∞—Ç–Ω–æ –¥–æ $D_{model}$, FFN –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ **—É–≤–µ–ª–∏—á–∏—Ç—å —Å–≤–æ—é –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—è–º.  –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –±–æ–ª—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ "—Å–∫—Ä—ã—Ç–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ", –≥–¥–µ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–æ –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import math

# –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import numpy as np
import torch
import torch.nn as nn  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å nn –¥–ª—è LayerNorm


def positional_encoding(max_len: int, d_model: int) -> torch.Tensor:
    """
    Description:
        –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–∏ Transformer.

    Args:
        max_len: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        d_model: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤).

    Returns:
        –¢–µ–Ω–∑–æ—Ä –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π —Ñ–æ—Ä–º—ã (max_len, d_model).

    Examples:
        >>> pe = positional_encoding(10, 512)
        >>> pe.shape
        torch.Size([10, 512])
    """
    pe = torch.zeros(max_len, d_model)
    position = torch.arange(0, max_len, dtype=torch.float).unsqueeze(1)
    div_term = torch.exp(
        torch.arange(0, d_model, 2).float() * (-math.log(10000.0) / d_model)
    )

    pe[:, 0::2] = torch.sin(position * div_term)
    pe[:, 1::2] = torch.cos(position * div_term)
    return pe


def print_embeddings(
    tensor: torch.Tensor, tokens: list, title: str, max_elements: int = 3
) -> None:
    """
    Description:
        –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Å –º–µ—Ç–∫–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤.

    Args:
        tensor: –¢–µ–Ω–∑–æ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.
        tokens: –°–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞.
        max_elements: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

    Returns:
        None

    Examples:
        >>> embeddings = torch.randn(5, 512)
        >>> tokens = ["token1", "token2", "token3", "token4", "token5"]
        >>> print_embeddings(embeddings, tokens, "–ü—Ä–∏–º–µ—Ä —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤")
    """
    print(f"\n{title}:")
    for idx, (vec, token) in enumerate(zip(tensor, tokens)):
        elements = vec[:max_elements].detach().numpy().round(4)
        print(f"{idx:2d} {token:15}: [{', '.join(f'{x:7.4f}' for x in elements)}...]")


def print_attention_details(
    batch_idx: int,
    head_idx: int,
    pos_idx: int,
    Q: torch.Tensor,
    K: torch.Tensor,
    attention_scores: torch.Tensor,
    attention_weights: torch.Tensor,
    tokens: list,
    num_elements: int = 5,
) -> None:
    """
    Description:
        –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏.

    Args:
        batch_idx: –ò–Ω–¥–µ–∫—Å –±–∞—Ç—á–∞.
        head_idx: –ò–Ω–¥–µ–∫—Å –≥–æ–ª–æ–≤—ã –≤–Ω–∏–º–∞–Ω–∏—è.
        pos_idx: –ü–æ–∑–∏—Ü–∏—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
        Q: –¢–µ–Ω–∑–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤.
        K: –¢–µ–Ω–∑–æ—Ä –∫–ª—é—á–µ–π.
        attention_scores: –¢–µ–Ω–∑–æ—Ä —Å—ã—Ä—ã—Ö –æ—Ü–µ–Ω–æ–∫ –≤–Ω–∏–º–∞–Ω–∏—è.
        attention_weights: –¢–µ–Ω–∑–æ—Ä –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ softmax.
        tokens: –°–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤.
        num_elements: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞.

    Returns:
        None
    """
    print("\n" + "=" * 60)
    print(
        f"–î–µ—Ç–∞–ª–∏ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –±–∞—Ç—á–∞ {batch_idx}, –≥–æ–ª–æ–≤—ã {head_idx}, "
        f"–ø–æ–∑–∏—Ü–∏–∏ {pos_idx} ({tokens[batch_idx][pos_idx]}):"
    )

    # –í—ã–≤–æ–¥ Q –≤–µ–∫—Ç–æ—Ä–∞
    q_vec = Q[batch_idx, head_idx, pos_idx, :num_elements].detach().numpy()
    print(f"Q –≤–µ–∫—Ç–æ—Ä (–ø–µ—Ä–≤—ã–µ {num_elements} —ç–ª–µ–º–µ–Ω—Ç–æ–≤):")
    print(f"{q_vec.round(4)}")

    # –í—ã–≤–æ–¥ K –≤–µ–∫—Ç–æ—Ä–æ–≤
    print(f"K –≤–µ–∫—Ç–æ—Ä–∞ (–ø–µ—Ä–≤—ã–µ {num_elements} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ):")
    for i, token in enumerate(tokens[batch_idx]):
        k_vec = K[batch_idx, head_idx, i, :num_elements].detach().numpy()
        print(f"{i:2d} {token:15}: {k_vec.round(4)}")

    # –†—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π
    manual_scores = []
    q = Q[batch_idx, head_idx, pos_idx]
    for i in range(len(tokens[batch_idx])):
        k = K[batch_idx, head_idx, i]
        score = torch.dot(q, k) / math.sqrt(D_k)
        manual_scores.append(score.item())

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –æ—Ü–µ–Ω–æ–∫
    auto_scores = attention_scores[batch_idx, head_idx, pos_idx].detach().numpy()

    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print("\n–°—ã—Ä—ã–µ –æ—Ü–µ–Ω–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è:")
    print(f"–†—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç:     {np.array(manual_scores).round(4)}")
    print(f"–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π:    {auto_scores.round(4)}")

    # –í—ã–≤–æ–¥ –≤–µ—Å–æ–≤ –ø–æ—Å–ª–µ softmax
    weights = attention_weights[batch_idx, head_idx, pos_idx].detach().numpy()
    print(f"\n–í–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ Softmax:")
    print(f"{weights.round(4)}")


# –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
sentences = [
    "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –Ø —É–≤–ª–µ–∫–∞—é—Å—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º",
    "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?",
    "–ò–ò ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!",
]

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
N = len(sentences)  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
L = 9               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
D_model = 512       # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
h = 8               # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤
D_k = D_model // h  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∏ –∑–∞–ø—Ä–æ—Å–æ–≤
D_v = D_model // h  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–π
D_ff = 4 * D_model  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å Feed Forward Network

# 1. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å –ø–∞–¥–¥–∏–Ω–≥–æ–º
batch_tokens = [
    ["[CLS]", "–í—Å–µ–º", "–ø—Ä–∏–≤–µ—Ç", "!", "–Ø", "—É–≤–ª–µ–∫–∞—é—Å—å", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º", "[SEP]"],
    ["[CLS]", "–ü—Ä–∏–≤–µ—Ç", ",", "–∫–∞–∫", "–¥–µ–ª–∞", "?", "[SEP]", "[PAD]", "[PAD]"],
    ["[CLS]", "–ò–ò", "‚Äî", "—ç—Ç–æ", "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ", "!", "[SEP]", "[PAD]", "[PAD]"],
]

# 2. –°–æ–∑–¥–∞–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
embeddings = torch.randn(N, L, D_model)

# 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
pe = positional_encoding(L, D_model)

# 4. –ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Å –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
X_embedded = embeddings + pe  # Broadcasting –¥–ª—è –±–∞—Ç—á–∞

# ================= –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ =================
print("=" * 60)
print("–®–∞–≥ 1: –ò—Å—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —Ç–æ–∫–µ–Ω–æ–≤")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {embeddings.shape}")
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    print_embeddings(embeddings[batch_idx], batch_tokens[batch_idx], "–ò—Å—Ö–æ–¥–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏")

print("\n" + "=" * 60)
print("–®–∞–≥ 2: –ü–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {pe.shape}")
print_embeddings(pe, [f"–ü–æ–∑–∏—Ü–∏—è {i}" for i in range(L)], "–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–π")

print("\n" + "=" * 60)
print("–®–∞–≥ 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (X + PE)")
print(f"–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞: {X_embedded.shape}")
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    print_embeddings(X_embedded[batch_idx], batch_tokens[batch_idx], "–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ–∂–µ–Ω–∏—è")

# ================= –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ =================
print("\n" + "=" * 60)
print("–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞:")
batch_idx = 0

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print(f"\n–¢–µ–∫—Å—Ç: '{sentences[batch_idx]}'")
print(f"–¢–æ–∫–µ–Ω—ã: {batch_tokens[batch_idx]}")

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥:  {embeddings[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"–ü–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∫–æ–¥–∏—Ä:   {pe[pos, :3].detach().numpy().round(4)}")
    print(f"–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:     {X_embedded[batch_idx, pos, :3].detach().numpy().round(4)}")

# ================= Multi-Head Self-Attention =================
print("\n" + "=" * 60)
print("–®–∞–≥ 4: Multi-Head Self-Attention")

# 1. –õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏
W_Q = torch.randn(h, D_model, D_k)
W_K = torch.randn(h, D_model, D_k)
W_V = torch.randn(h, D_model, D_v)

Q = torch.einsum('nlk,hkd->nhld', X_embedded, W_Q)
K = torch.einsum('nlk,hkd->nhld', X_embedded, W_K)
V = torch.einsum('nlk,hkd->nhld', X_embedded, W_V)

print("\n–õ–∏–Ω–µ–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–∏:")
print(f"–§–æ—Ä–º–∞ Q: {Q.shape}")
print(f"–§–æ—Ä–º–∞ K: {K.shape}")
print(f"–§–æ—Ä–º–∞ V: {V.shape}")

# –í—ã–≤–æ–¥ –ø–µ—Ä–≤—ã—Ö 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è Q, K, V
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    for pos in [0, 2, 4]:
        print(f"  –ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
        print(f"    Q: {Q[batch_idx, :, pos, :3].detach().numpy().round(4)}")
        print(f"    K: {K[batch_idx, :, pos, :3].detach().numpy().round(4)}")
        print(f"    V: {V[batch_idx, :, pos, :3].detach().numpy().round(4)}")

# 2. –í–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã
attention_scores = torch.einsum('nhld,nhmd->nhlm', Q, K) / math.sqrt(D_k)

# –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–¥–¥–∏–Ω–≥–∞
mask = torch.ones(N, 1, L, L, dtype=torch.bool)
for batch_idx, tokens in enumerate(batch_tokens):
    for i, token in enumerate(tokens):
        if token == "[PAD]":
            mask[batch_idx, :, i:, :] = False
            mask[batch_idx, :, :, i:] = False
attention_scores = attention_scores.masked_fill(~mask, float('-inf'))

attention_weights = torch.softmax(attention_scores, dim=-1)
Z = torch.einsum('nhlm,nhmd->nhld', attention_weights, V)

print("\n–í–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥–æ–ª–æ–≤—ã:")
print(f"–§–æ—Ä–º–∞ Z: {Z.shape}")

# –í—ã–≤–æ–¥ –ø–µ—Ä–≤—ã—Ö 3 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è Z
for batch_idx in range(N):
    print(f"\n–ë–∞—Ç—á {batch_idx + 1}: '{sentences[batch_idx]}'")
    for pos in [0, 2, 4]:
        print(f"  –ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
        print(f"    Z: {Z[batch_idx, :, pos, :3].detach().numpy().round(4)}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
print("\n–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –ø–µ—Ä–≤–æ–π –≥–æ–ª–æ–≤—ã –∏ –ø–µ—Ä–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏:")
print(f"–í–µ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è (–ø–µ—Ä–≤–∞—è –≥–æ–ª–æ–≤–∞, –ø–µ—Ä–≤–∞—è –ø–æ–∑–∏—Ü–∏—è): {attention_weights[0, 0, 0, :].detach().numpy().round(4)}")

# 3. –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤
Z_concat = Z.transpose(1, 2).reshape(N, L, h * D_v)

print("\n–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≥–æ–ª–æ–≤:")
print(f"–§–æ—Ä–º–∞ Z_concat: {Z_concat.shape}")

# 4. –õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
W_O = torch.randn(h * D_v, D_model)
multi_head_output = torch.einsum('nlk,kd->nld', Z_concat, W_O)

print("\n–õ–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞:")
print(f"–§–æ—Ä–º–∞ MultiHead Output: {multi_head_output.shape}")

# –í—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞
print("\n–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Multi-Head Attention:")
batch_idx = 0
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:     {X_embedded[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"Multi-Head Output:  {multi_head_output[batch_idx, pos, :3].detach().numpy().round(4)}")

# ================= Add & Norm (–ø–æ—Å–ª–µ Multi-Head Attention) =================
print("\n" + "=" * 60)
print("–®–∞–≥ 5: Add & Norm (–ø–æ—Å–ª–µ Multi-Head Attention)")

# Add (–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
# –í—ã—Ö–æ–¥ —Å–ª–æ—è Multi-Head Attention (multi_head_output) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –≤—Ö–æ–¥—É –ø–æ–¥—Å–ª–æ—è Multi-Head Attention (X_embedded)
output_add_norm_1_add = X_embedded + multi_head_output
print("\nAdd (–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ):")
print(f"–§–æ—Ä–º–∞ Output –ø–æ—Å–ª–µ Add: {output_add_norm_1_add.shape}")

# Norm (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è)
# –ü—Ä–∏–º–µ–Ω—è–µ–º Layer Normalization –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å–ª–æ–∂–µ–Ω–∏—è
layer_norm_1 = nn.LayerNorm(D_model) #  D_model - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º
output_add_norm_1_norm = layer_norm_1(output_add_norm_1_add)
print("\nNorm (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è):")
print(f"–§–æ—Ä–º–∞ Output –ø–æ—Å–ª–µ LayerNorm: {output_add_norm_1_norm.shape}")

# –í—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Add & Norm
print("\n–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Add & Norm:")
batch_idx = 0
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"Multi-Head Output:      {multi_head_output[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"Output Add:             {output_add_norm_1_add[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"Output Add & Norm:      {output_add_norm_1_norm[batch_idx, pos, :3].detach().numpy().round(4)}")


# ================= Feed Forward Network =================
print("\n" + "=" * 60)
print("–®–∞–≥ 6: Feed Forward Network")

# 1. –ü–µ—Ä–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Expansion Layer)
W_ff_1 = torch.randn(D_model, D_ff)
b_ff_1 = torch.randn(D_ff)
output_ffn_layer_1 = torch.relu(torch.einsum('nlk,kd->nld', output_add_norm_1_norm, W_ff_1) + b_ff_1)
print("\n–ü–µ—Ä–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Expansion Layer):")
print(f"–§–æ—Ä–º–∞ Output –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è: {output_ffn_layer_1.shape}")

# 2. –í—Ç–æ—Ä–æ–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Contraction Layer)
W_ff_2 = torch.randn(D_ff, D_model)
b_ff_2 = torch.randn(D_model)
output_ffn = torch.einsum('nlk,kd->nld', output_ffn_layer_1, W_ff_2) + b_ff_2
print("\n–í—Ç–æ—Ä–æ–π –ª–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π (Contraction Layer):")
print(f"–§–æ—Ä–º–∞ Output –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Å–ª–æ—è (FFN Output): {output_ffn.shape}")

# –í—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Feed Forward Network
print("\n–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Feed Forward Network:")
batch_idx = 0
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"Output Add & Norm:      {output_add_norm_1_norm[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"FFN Output:             {output_ffn[batch_idx, pos, :3].detach().numpy().round(4)}")

# ================= Add & Norm (–ø–æ—Å–ª–µ Feed Forward Network) =================
print("\n" + "=" * 60)
print("–®–∞–≥ 7: Add & Norm (–ø–æ—Å–ª–µ Feed Forward Network)")

# Add (–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
# –í—ã—Ö–æ–¥ FFN (output_ffn) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –≤—Ö–æ–¥—É –ø–æ–¥—Å–ª–æ—è FFN (output_add_norm_1_norm)
output_add_norm_2_add = output_add_norm_1_norm + output_ffn
print("\nAdd (–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ FFN):")
print(f"–§–æ—Ä–º–∞ Output –ø–æ—Å–ª–µ Add: {output_add_norm_2_add.shape}")

# Norm (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è)
# –ü—Ä–∏–º–µ–Ω—è–µ–º Layer Normalization –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å–ª–æ–∂–µ–Ω–∏—è
layer_norm_2 = nn.LayerNorm(D_model) #  D_model - —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º
output_add_norm_2_norm = layer_norm_2(output_add_norm_2_add)
print("\nNorm (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è –ø–æ—Å–ª–µ FFN):")
print(f"–§–æ—Ä–º–∞ Output –ø–æ—Å–ª–µ LayerNorm: {output_add_norm_2_norm.shape}")

# –í—ã–≤–æ–¥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Add & Norm (–ø–æ—Å–ª–µ FFN)
print("\n–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤–æ–≥–æ –±–∞—Ç—á–∞ –ø–æ—Å–ª–µ Add & Norm (–ø–æ—Å–ª–µ FFN):")
batch_idx = 0
for pos in [0, 2, 4, 6, 8]:
    print(f"\n–ü–æ–∑–∏—Ü–∏—è {pos} ({batch_tokens[batch_idx][pos]}):")
    print(f"FFN Output:             {output_ffn[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"Output Add (–ø–æ—Å–ª–µ FFN):   {output_add_norm_2_add[batch_idx, pos, :3].detach().numpy().round(4)}")
    print(f"Output Add & Norm (–ø–æ—Å–ª–µ FFN): {output_add_norm_2_norm[batch_idx, pos, :3].detach().numpy().round(4)}")
```

6. **–°–ª–æ–π Add & Norm (–ø–æ—Å–ª–µ Feed Forward):**
   - **Add (–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ):** –í—ã—Ö–æ–¥ FFN –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –≤—Ö–æ–¥—É –ø–æ–¥—Å–ª–æ—è:
     $$
     \text{Output}_{Add2} = \text{Output}_{Norm1} + \text{FFN}(\text{Output}_{Norm1})
     $$
   - **Norm (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è):** –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è:
     $$
     \text{Output}_{Norm2} = \text{LayerNorm}(\text{Output}_{Add2})
     $$

7. **–í—ã—Ö–æ–¥ –∫–æ–¥–µ—Ä–∞:**
   - –í—ã—Ö–æ–¥–æ–º –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è –∫–æ–¥–µ—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è $\text{Output}_{Norm2}$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(N, L, D_{model})$.
   - –ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö $N_{layers}$ —Å–ª–æ–µ–≤ –∫–æ–¥–µ—Ä–∞, —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∞—Ç—Ä–∏—Ü—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $(N, L, D_{model})$.

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±–∑–æ—Ä –ø–∞–ø–∏—Ä—ã...

</details> 

## üöÄ –£—Å–∫–æ—Ä—è–µ–º –≤–∞—à –∫–æ–¥–µ—Ä

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π ü§ù

–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–Ω—è—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤) ‚Äî —ç—Ç–æ –æ—Ç–º–µ—Ç–∏—Ç—å, –∫–∞–∫ –∏—Ö —á–∞—Å—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç —Å –º–æ–¥–µ–ª—è–º–∏, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–æ–≤, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

–û—á–µ–≤–∏–¥–Ω—ã–π –ø—Ä–∏–º–µ—Ä ‚Äì **RAG**. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –∑–Ω–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ LLM –æ–±—É—á–∏–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º–æ–¥–µ–ª–∏, —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è LLM –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø—Ä–æ—Å—É. –ù–æ, –∫–æ–Ω–µ—á–Ω–æ, —ç—Ç–æ —Ç–æ–ª—å–∫–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É. –ï—Å–ª–∏ LLM –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –∑–∞–ø—Ä–æ—Å—É, —Ç–æ —Å–∏—Å—Ç–µ–º–µ –Ω—É–∂–µ–Ω –∫–∞–∫–æ–π-—Ç–æ –¥—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç—Ç–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤? –î–ª—è —ç—Ç–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –±—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ–π –∏ –¥–µ—à–µ–≤–æ–π, —á—Ç–æ–±—ã –µ–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–π –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å LLM –ø–æ–ª–µ–∑–Ω—ã–º. –û–±—ã—á–Ω–æ —ç—Ç–∞ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–µ—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä **BERT**. üìö

–î—Ä—É–≥–∏–º –ø—Ä–∏–º–µ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—à–µ–≤—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. üîí

–ö–æ—Ä–æ—á–µ –≥–æ–≤–æ—Ä—è, –≤—Å—è–∫–∏–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤—ã –≤–∏–¥–∏—Ç–µ –≤ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ä–∞–∑—É–º–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–µ—Ä–∞ —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Å–∏—Å—Ç–µ–º—ã. –ù–æ –æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–µ–≤–µ—Ä–Ω–æ. üîÑ

### –°–∏—Å—Ç–µ–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤ üåê

–î–æ **GPT** —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö –∏ –Ω–∞ —Ç–∞–∫–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, –∫–∞–∫ **Netflix**. –¢–∞—Ä–≥–µ—Ç–∏–Ω–≥ —Ä–µ–∫–ª–∞–º—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–∏—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö, –≤ –ø–æ–∏—Å–∫–µ –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö. –°—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–∞–∫–∂–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —Ç–∞–∫–∏–µ –∫–∞–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–ø–∞–º–∞ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π. –≠—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –Ω–µ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö, –∞ –Ω–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤. –í—Å–µ —ç—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –¥–æ —Å–∏—Ö –ø–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥–µ–π—Å—Ç–≤—É—é—Ç –≤ –æ–≥—Ä–æ–º–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ, —Å–∫–æ–ª—å–∫–æ —Ä–µ–∫–ª–∞–º—ã —Ç–∞—Ä–≥–µ—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É! üåç

**–ó–∞–≥—Ä—É–∑–∫–∏:** –Ω–∞ **HuggingFace** **RoBERTa**, –≤–µ–¥—É—â–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ **BERT**, –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ –∑–∞–≥—Ä—É–∑–æ–∫, —á–µ–º 10 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö LLM –Ω–∞ **HuggingFace** –≤–º–µ—Å—Ç–µ –≤–∑—è—Ç—ã—Ö. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, –º–æ–¥–µ–ª—å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Ç–æ–ª—å–∫–æ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫, –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ **1 –º–∏–ª–ª–∏–∞—Ä–¥–∞ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫**, —á—Ç–æ –ø–æ—á—Ç–∏ –≤ —Ç—Ä–∏ —Ä–∞–∑–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç **397 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫** –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–π —Ç–æ–ª—å–∫–æ –¥–µ–∫–æ–¥–µ—Ä. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏—è –º–æ–¥–µ–ª–µ–π —Å –º–∞—Å–∫–æ–π –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ ¬´–±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π¬ª —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ **ModernBERT**, –≥–æ—Ç–æ–≤—ã—Ö –∫ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –º–æ–¥–µ–ª–µ–π –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –º–æ–¥–µ–ª–µ–π. üì•

**–°—Ç–æ–∏–º–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞:** –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –≤ —Ä–∞—Å—á–µ—Ç–µ –Ω–∞ –∫–∞–∂–¥—ã–π –≤—ã–≤–æ–¥ –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤ —Ç—Ä–µ–±—É—é—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –≤—ã–≤–æ–¥–æ–≤ –≤ –≥–æ–¥, —á–µ–º –º–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏. –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –ø—Ä–∏–º–µ—Ä–æ–º —è–≤–ª—è–µ—Ç—Å—è **FineWeb-Edu**, –≥–¥–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–æ–¥–µ–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –±–æ–ª–µ–µ —á–µ–º **15 —Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤**. –ö–æ–º–∞–Ω–¥–∞ **FineWeb-Edu** —Ä–µ—à–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å **Llama-3-70b-Instruct**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—É—é —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ **BERT** –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –≠—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–Ω—è–ª–∞ **6000 —á–∞—Å–æ–≤ H100** –Ω–∞ –æ–±—â—É—é —Å—É–º–º—É **60 000 –¥–æ–ª–ª–∞—Ä–æ–≤ –°–®–ê** –ø—Ä–∏ —Ü–µ–Ω–µ —Ç–æ—á–∫–∏ –≤—ã–≤–æ–¥–∞ **HuggingFace** **10 –¥–æ–ª–ª–∞—Ä–æ–≤ –°–®–ê** –≤ —á–∞—Å. –° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –¥–∞–∂–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å–∞–º–æ–≥–æ –¥–µ—à–µ–≤–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ **Google Gemini Flash** –∏ –µ–≥–æ –Ω–∏–∑–∫–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤—ã–≤–æ–¥–∞ –≤ —Ä–∞–∑–º–µ—Ä–µ **0,075 –¥–æ–ª–ª–∞—Ä–∞ –°–®–ê** –∑–∞ –º–∏–ª–ª–∏–æ–Ω —Ç–æ–∫–µ–Ω–æ–≤ –ø–µ—Ä–µ–¥–∞—á–∞ **15 —Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤** –≤ –ø–æ–ø—É–ª—è—Ä–Ω—É—é –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–∫–æ–¥–µ—Ä–∞ –æ–±–æ–π–¥–µ—Ç—Å—è –±–æ–ª–µ–µ —á–µ–º –≤ **–º–∏–ª–ª–∏–æ–Ω –¥–æ–ª–ª–∞—Ä–æ–≤**! üí∏

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å üöÄ

### –û–±–∑–æ—Ä üìä

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 1 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ **ModernBERT** –∏ —Ä—è–¥–∞ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á, –∏–∑–º–µ—Ä–µ–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤. üìà –î–∞–Ω–Ω—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç, —á—Ç–æ **ModernBERT** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é –¥–ª—è –∑–∞–¥–∞—á, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞. üèÜ

![Table_1](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-04/assets/Table_1.png)

–ú–æ–¥–µ–ª—å **DeBERTaV3** –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è —è–≤–ª—è–ª–∞—Å—å —ç—Ç–∞–ª–æ–Ω–æ–º –≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è—Ö –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (NLP), –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Kaggle. ü•á –û–¥–Ω–∞–∫–æ, **ModernBERT** –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Ç–∞–ª–∞ –ø–µ—Ä–≤–æ–π –º–æ–¥–µ–ª—å—é –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –ø—Ä–µ–≤–∑–æ—à–µ–¥—à–µ–π **DeBERTaV3** –≤ –±–µ–Ω—á–º–∞—Ä–∫–µ GLUE, –Ω–æ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–µ –º–µ–Ω–µ–µ 1/5 –æ—Ç –æ–±—ä–µ–º–∞, —Ç—Ä–µ–±—É–µ–º–æ–≥–æ **DeBERTa**. üíæ

–ú–æ–¥–µ–ª—å **ModernBERT** —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç—ã. ‚è© –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –æ–Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –¥–≤—É–∫—Ä–∞—Ç–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å **DeBERTa**, –∞ –≤ —Ç–∏–ø–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Å–º–µ—à–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏–≥–∞—Ç—å —á–µ—Ç—ã—Ä–µ—Ö–∫—Ä–∞—Ç–Ω–æ–≥–æ. üöÄ –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ç–∞–∫–∂–µ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã—à–µ, –ø–æ—á—Ç–∏ –≤ —Ç—Ä–∏ —Ä–∞–∑–∞, —á–µ–º —É –¥—Ä—É–≥–∏—Ö –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ **NomicBERT** –∏ **GTE-en-MLM**. üèéÔ∏è

–î–ª–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–æ–¥–µ–ª–∏ **ModernBERT** –¥–æ—Å—Ç–∏–≥–∞–µ—Ç **8192 —Ç–æ–∫–µ–Ω–æ–≤**, —á—Ç–æ –±–æ–ª–µ–µ —á–µ–º –≤ 16 —Ä–∞–∑ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤. üìè –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–∞—Ö Retrieval-Augmented Generation (RAG), –≥–¥–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∑–∞—Ç—Ä—É–¥–Ω—è—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ. üß© **ModernBERT** —Ç–∞–∫–∂–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –º–µ—Ç–æ–¥–æ–º –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ColBERT, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–æ –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ 9 –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤. üìä –ü—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ –¥–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –æ–±–ª–∞–¥–∞—é—â–∞—è –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –æ–±—É—á–µ–Ω–∏—è –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –∑–∞–¥–∞—á —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –±–∞–∑–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –¥–∞–∂–µ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ–∏—Å–∫–∞ –≤ –∑–∞–¥–∞—á–∞—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. üéØ

–ú–æ–¥–µ–ª—å **ModernBERT** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –∑–∞–¥–∞—á–∞—Ö –ø–æ–∏—Å–∫–∞ –∫–æ–¥–∞. üíª –í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –º–æ–¥–µ–ª–∏-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏, –æ–±—É—á–µ–Ω–Ω—ã–µ –Ω–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –∫–æ–¥. üìö –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –º–æ–∂–Ω–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö StackOverflow-QA (SQA), –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ–±–æ–π –≥–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ—Å—É—Ä—Å, —Å–æ—á–µ—Ç–∞—é—â–∏–π –∫–æ–¥ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —è–∑—ã–∫. üåê –í —ç—Ç–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø–æ–Ω–∏–º–∞–Ω–∏—é –∫–æ–¥–∞ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, **ModernBERT** —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –Ω–µ–º–Ω–æ–≥–∏—Ö –º–æ–¥–µ–ª–µ–π, –¥–æ—Å—Ç–∏–≥—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤—ã—à–µ 80 –±–∞–ª–ª–æ–≤. üéâ

–£–∫–∞–∑–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ **ModernBERT** –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–æ–≥–æ —Ä—è–¥–∞ –Ω–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. üåü –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (IDE), –∫–æ—Ç–æ—Ä–∞—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é –≤—Å–µ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, –∏—Å–ø–æ–ª—å–∑—É—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ **ModernBERT** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ —Ç–æ—á–Ω–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ –∫–æ–¥–∞ —Å —É—á–µ—Ç–æ–º –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤. üîç –î—Ä—É–≥–∏–º –ø—Ä–∏–º–µ—Ä–æ–º –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å —Å–µ—Ä–≤–∏—Å —á–∞—Ç-–±–æ—Ç–∞ –¥–ª—è –∫–æ–¥–∞, —Å–ø–æ—Å–æ–±–Ω—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞–≥—Ä–µ–≥–∏—Ä—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. ü§ñ

–í —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –±–∞–∑–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, **ModernBERT** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ç—Ä–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö –∑–∞–¥–∞—á: –ø–æ–∏—Å–∫, –ø–æ–Ω–∏–º–∞–Ω–∏–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –∏ –ø–æ–∏—Å–∫ –∫–æ–¥–∞. üîé –í –æ–±–ª–∞—Å—Ç–∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –º–æ–¥–µ–ª—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å—Ç—É–ø–∞–µ—Ç **DeBERTaV3**, –æ–¥–Ω–∞–∫–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –µ–µ –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏. ‚ö° –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ **ModernBERT**, –∫–∞–∫ –∏ –ª—é–±–∞—è –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —è–∑—ã–∫–æ–≤–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è. üé≠ –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏. üõ†Ô∏è

–í —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –ø–µ—Ä–µ–¥–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏, **ModernBERT** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã–µ –∏–ª–∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –∑–∞–¥–∞—á. üìà –ö—Ä–æ–º–µ —Ç–æ–≥–æ, **ModernBERT** –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å–ø–æ—Å–æ–±–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª–∏–Ω–æ–π –¥–æ 8192 —Ç–æ–∫–µ–Ω–æ–≤, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π. üöÄ

## –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚ö°

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ 2 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ–± —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞, BS) –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—ã–≤–æ–¥–∞ (—Ç—ã—Å—è—á–∏ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É) –¥–ª—è **ModernBERT** –∏ —Ä—è–¥–∞ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π-–¥–µ–∫–æ–¥–µ—Ä–æ–≤, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ NVIDIA RTX 4090. üìä –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —Å–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è –Ω–∞ —à–∏—Ä–æ–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞, –∞ –Ω–µ –Ω–∞ –Ω–æ–≤–µ–π—à–µ–º –∏ —Ç—Ä—É–¥–Ω–æ–¥–æ—Å—Ç—É–ø–Ω–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏. üíª –≠—Ç–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ —Ç–µ–º, —á—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ **ModernBERT** –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å, –∞ –Ω–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞. üéØ

![Table_2](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-04/assets/Table_2.png)

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–∏–Ω—Ü–∏–ø–æ–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ **ModernBERT** —Å—Ç—Ä–µ–º–∏–ª–∏—Å—å –æ–±–µ—Å–ø–µ—á–∏—Ç—å –µ–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —É—Å–ª–æ–≤–∏—è—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤. üß™ –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —á–∞—Å—Ç–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —á—Ç–æ –æ—Ç—Ä–∞–∂–µ–Ω–æ –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ¬ª –≤ —Ç–∞–±–ª–∏—Ü–µ. üìè –û–¥–Ω–∞–∫–æ, –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —Ä–∞–∑–º–µ—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –±—ã–ª–æ —É–¥–µ–ª–µ–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —É—Å–ª–æ–≤–∏—è—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –æ—Ç—Ä–∞–∂–µ–Ω–æ –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è¬ª. üîÑ –î–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ **ModernBERT** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã. üöÄ

**ModernBERT** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å, –≤ 2-3 —Ä–∞–∑–∞ –ø—Ä–µ–≤—ã—à–∞—é—â—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –±–ª–∏–∂–∞–π—à–µ–π –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–µ–π –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–ª–∏–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –±—É–¥—É—Ç –∏–≥—Ä–∞—Ç—å –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –Ω–∞–∏–±–æ–ª–µ–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –±—É–¥—É—â–µ–≥–æ. üåü –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, **ModernBERT** –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —à–∏—Ä–æ–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Flash Attention. üìö

–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å **ModernBERT** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö —Å –º–µ–Ω—å—à–µ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å—é. üí∞ –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤—ã—Å–æ–∫–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±–∞–∑–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö, –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö –∏ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. üì±

## –ü–æ—á–µ–º—É ModernBERT, –Ω—É, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π? ü§î

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ –¥–∞–Ω–Ω—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–¥–µ–ª–µ–Ω–∏—è –±–æ–ª—å—à–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –º–æ–¥–µ–ª—è–º-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞–º. üß† –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å–≤–æ—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ —Ä–∞–∑–≤–∏–≤–∞–ª–∞—Å—å –º–µ–Ω–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ BERT –≤ 2018 –≥–æ–¥—É. üìÖ

–ü—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ RoBERTa, –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤ –Ω–µ –ø—Ä–∏–≤–µ–ª–æ –∫ –æ–±—â–µ–º—É —É–ª—É—á—à–µ–Ω–∏—é (—Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º–æ–º—É "—É–ª—É—á—à–µ–Ω–∏—é –ø–æ –ü–∞—Ä–µ—Ç–æ") –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–æ–≤. üìâ –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–¥–µ–ª—å DeBERTaV3 –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –±–µ–Ω—á–º–∞—Ä–∫–µ GLUE –∏ –∑–∞–¥–∞—á–∞—Ö –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –æ–¥–Ω–∞–∫–æ —É—Å—Ç—É–ø–∞–µ—Ç –≤ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∑–∞–¥–∞—á–∞—Ö –ø–æ–∏—Å–∫–∞. üîç –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ AlBERT –∏ GTE-en-MLM, —É–ª—É—á—à–∞—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∏—Å—Ö–æ–¥–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π BERT –∏ RoBERTa, –Ω–æ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—é—Ç –≤ –¥—Ä—É–≥–∏—Ö. üé≤

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤—ã—Ö –º–æ–¥–µ–ª–µ–π BERT –∏ RoBERTa, –≤ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –±—ã–ª –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å. üöÄ –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤ —Å—Ñ–µ—Ä–µ –º–æ–¥–µ–ª–µ–π-–¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤, –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è –∫ "—É–ª—É—á—à–µ–Ω–∏—é –ø–æ –ü–∞—Ä–µ—Ç–æ", –∫–æ–≥–¥–∞ –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º. üìà –°–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∫–∞–∫ –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π, —Ç–∞–∫ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö —É—Å–∏–ª–∏–π. üõ†Ô∏è

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–ª—å—é –ø—Ä–æ–µ–∫—Ç–∞ **ModernBERT** —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –º–æ–¥–µ–ª–µ–π-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤. üéØ –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç—Ä–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤:

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Transformer. ü§ñ
2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. ‚ö°
3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö. üìä

### –í—Å—Ç—Ä–µ—á–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∏—á–µ–º –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞ ü§ñ

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Transformer —Å—Ç–∞–ª–∞ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–π –∏ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø–æ–¥–∞–≤–ª—è—é—â–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π. üåç –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞—Ü–∏–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Transformer. üîÑ –û–±—â–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–º –¥–ª—è –≤—Å–µ—Ö –Ω–∏—Ö —è–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è, —á—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å, –∏ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è —Å—Ç—Ä–æ—è—Ç—Å—è –≤–æ–∫—Ä—É–≥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞. üéØ

**ModernBERT** –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Transformer++ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–π Mamba), –∫–æ—Ç–æ—Ä–∞—è –≤–ø–µ—Ä–≤—ã–µ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –≤ —Å–µ—Ä–∏–∏ –º–æ–¥–µ–ª–µ–π Llama2. ü¶ô –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤ **ModernBERT** –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –∑–∞–º–µ–Ω–∞ —Ä—è–¥–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã BERT –Ω–∞ –∏—Ö —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏, –∞ –∏–º–µ–Ω–Ω–æ:

- –ó–∞–º–µ–Ω–∞ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –Ω–∞ —Ä–æ—Ç–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ (RoPE), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –º–µ–∂–¥—É —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. üîÑ
- –ó–∞–º–µ–Ω–∞ —Å–ª–æ—è MLP –Ω–∞ —Å–ª–æ–π GeGLU –∏ —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ GeLU, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ BERT. üß†
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∑–∞ —Å—á–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–º–µ—â–µ–Ω–∏—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã. üíª
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–ª–æ—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è, —á—Ç–æ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è. üìä

### –ü–æ–≤—ã—à–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–ö–∞–∫ –æ—Ç–º–µ—á–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ, –º–æ–¥–µ–ª–∏-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏, –≤–∫–ª—é—á–∞—è **ModernBERT**, –Ω–µ –æ–±–ª–∞–¥–∞—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º—ã–º–∏ —Å –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏. üèéÔ∏è –û–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã. ‚è© –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –ø–æ–µ–∑–¥–æ–∫ –ø–æ —à–æ—Å—Å–µ, –æ–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –Ω–∞–¥–µ–∂–Ω–∞—è –º–æ–¥–µ–ª—å-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ –±—É–¥–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –∑–∞–¥–∞—á–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. üöó

–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –≤ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å. ‚è±Ô∏è –ú–æ–¥–µ–ª–∏-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω—ã –≤ –∑–∞–¥–∞—á–∞—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –≥–¥–µ –¥–∞–∂–µ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–º—É –ø–æ–≤—ã—à–µ–Ω–∏—é –æ–±—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. üìà –í —Å–∏—Ç—É–∞—Ü–∏—è—Ö, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ (CPU), —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ—â–µ –±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø—Ä–∏–µ–º–ª–µ–º–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. ‚öôÔ∏è

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π, –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ **ModernBERT** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏—Ö —Ä–∞–±–æ—Ç, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ Flash Attention 2. üöÄ –ü–æ–≤—ã—à–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ **ModernBERT** –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç—Ä–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

1. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏. üîÑ
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –æ—Ç–º–µ–Ω—ã –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —É–ø–∞–∫–æ–≤–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç. üì¶
3. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏ —Å —É—á–µ—Ç–æ–º –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. üíª

### –ê–ø–≥—Ä–µ–π–¥ –≤–∞—à–µ–≥–æ Honda Civic –¥–ª—è —Ç—Ä–µ–∫–∞ üèéÔ∏è

–ú—ã —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª–∏ –æ–± —ç—Ç–æ–º: –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ ‚Äî —ç—Ç–æ –Ω–µ **Ferrari**, –∏ **ModernBERT** ‚Äî –Ω–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –æ–Ω –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–æ. –ö–æ–≥–¥–∞ –≤—ã –≤—ã–µ–∑–∂–∞–µ—Ç–µ –Ω–∞ —à–æ—Å—Å–µ, –≤—ã –æ–±—ã—á–Ω–æ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç–µ –∏ –Ω–µ –º–µ–Ω—è–µ—Ç–µ —Å–≤–æ—é –º–∞—à–∏–Ω—É –Ω–∞ –≥–æ–Ω–æ—á–Ω—É—é, –∞ —Å–∫–æ—Ä–µ–µ –æ–∂–∏–¥–∞–µ—Ç–µ, —á—Ç–æ –≤–∞—à–∞ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–∞—è, –Ω–∞–¥–µ–∂–Ω–∞—è –º–∞—à–∏–Ω–∞ –±—É–¥–µ—Ç –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å –ø—Ä–µ–¥–µ–ª —Å–∫–æ—Ä–æ—Å—Ç–∏. üöó

–§–∞–∫—Ç–∏—á–µ—Å–∫–∏, –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —É–ø–æ–º—è–Ω—É–ª–∏ –≤—ã—à–µ, —Å–∫–æ—Ä–æ—Å—Ç—å –∏–º–µ–µ—Ç —Ä–µ—à–∞—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ö–æ–¥–µ—Ä—ã –æ—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω—ã –≤ —Ç–µ—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ –ø—Ä–∏—Ä–∞—â–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –º–æ–≥—É—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è –∏–ª–∏ –≥–¥–µ –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, **RAG**. –í–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö –∫–æ–¥–µ—Ä –¥–∞–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ, –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –µ—â–µ –±–æ–ª–µ–µ –≤–∞–∂–Ω–∞, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ä–∞–∑—É–º–Ω—ã–µ —Å—Ä–æ–∫–∏. ‚è±Ô∏è

–ö–∞–∫ –∏ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –¥—Ä—É–≥–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π, –º—ã –æ–ø–∏—Ä–∞–µ–º—Å—è –Ω–∞ –ø–ª–µ—á–∏ –≥–∏–≥–∞–Ω—Ç–æ–≤ –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º –≤—ã–≥–æ–¥—É –∏–∑ —É–ª—É—á—à–µ–Ω–∏–π —Å–∫–æ—Ä–æ—Å—Ç–∏ **Flash Attention 2**. –ù–∞—à–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ç—Ä–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:

1. **–ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. **–û—Ç–º–µ–Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —É–ø–∞–∫–æ–≤–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π** –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç
3. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª–µ–π —Å —É—á–µ—Ç–æ–º –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

### –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –∏ –º–µ—Å—Ç–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ üåç

–û–¥–Ω–æ–π –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π **ModernBERT** —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –æ–±—Ä–∞—â–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ–ª–Ω—ã–π –≤–≤–æ–¥ —Ç–æ–ª—å–∫–æ –∫–∞–∂–¥—ã–µ **3 —Å–ª–æ—è** (–≥–ª–æ–±–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ), –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –æ–±—Ä–∞—â–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –ª–∏—à—å –Ω–∞ **128 –±–ª–∏–∂–∞–π—à–∏—Ö –∫ —Å–µ–±–µ —Ç–æ–∫–µ–Ω–æ–≤** (–ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ).  –ü–æ—Å–∫–æ–ª—å–∫—É –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è —Ä–µ–∑–∫–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç —Å –∫–∞–∂–¥—ã–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º, —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç **ModernBERT** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å. ‚ö°

–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –ø—Ä–∏—á–∏–Ω–∞ —Ç–∞–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–µ—Å—å–º–∞ –ø—Ä–æ—Å—Ç–∞: –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —á–∏—Ç–∞–µ—Ç–µ –∫–Ω–∏–≥—É. –ù—É–∂–Ω–æ –ª–∏ –≤–∞–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å–æ–∑–Ω–∞–≤–∞—Ç—å –≤–µ—Å—å —Å—é–∂–µ—Ç –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å (–≥–ª–æ–±–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ)? –ò–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω–æ—Å—Ç–∏ –æ —Ç–µ–∫—É—â–µ–π –≥–ª–∞–≤–µ (–ª–æ–∫–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ), –µ—Å–ª–∏ –≤—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç–µ –µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å—é–∂–µ—Ç–∞ (–≥–ª–æ–±–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ)? –í –ø–æ–¥–∞–≤–ª—è—é—â–µ–º –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –≤–µ—Ä–Ω–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ. üìö

### –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∏ —É–ø–∞–∫–æ–≤–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ üì¶

–ï—â–µ –æ–¥–Ω–∏–º –∫–ª—é—á–µ–≤—ã–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º, –ø–æ–≤—ã—à–∞—é—â–∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å **ModernBERT**, —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ —É–ø–∞–∫–æ–≤–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

–î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –≤ –æ–¥–Ω–æ–º –ø–∞–∫–µ—Ç–µ –º–æ–¥–µ–ª–∏-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –≤—Å–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–º–µ–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∏ –∫ –æ—Å—Ç–∞–ª—å–Ω—ã–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã (—Ç–æ–∫–µ–Ω—ã –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è) –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è –¥–ª–∏–Ω—ã. üß©

–•–æ—Ç—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º: –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ —Ç—Ä–∞—Ç–∏—Ç—Å—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω–µ—Å—É—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. üí°

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è, —É–ø–∞–∫–æ–≤–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (¬´—Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞¬ª) –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ —Ç–æ–∫–µ–Ω–∞—Ö –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è, –∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–∏–º—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª–µ–µ –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–º –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–±—Ä–∞–∑—Ü—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏. üéØ

–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É: –≤–º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –æ–Ω–∏ —É–¥–∞–ª—è—é—Ç—Å—è, –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ –º–∏–Ω–∏-–ø–∞–∫–µ—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–º –≤ **1**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–Ω—É–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.  –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ **Flash Attention** —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –µ—â–µ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–ª–∞–≥–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å–ø–∞–∫–æ–≤–∫—É –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –µ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ **RoPE Flash Attention**.  –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç **ModernBERT** —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –µ–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ **10‚Äì20 % –±—ã—Å—Ç—Ä–µ–µ** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏. ‚ö°

–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å —É–ø–∞–∫–æ–≤–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –£–ø–∞–∫–æ–≤–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —è–≤–ª—è–µ—Ç—Å—è –ª–æ–≥–∏—á–Ω—ã–º —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º: –ø–æ—Å–∫–æ–ª—å–∫—É –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∞ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø–æ–ª—É—á–∞–µ–º—É—é –æ—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞ –º–æ–¥–µ–ª–∏. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∂–∞–¥–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –¥–ª–∏–Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∞ –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—Ö–æ–¥–Ω–æ–π –¥–ª–∏–Ω–µ –º–æ–¥–µ–ª–∏. üß†

### –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ üíª

–ù–∞–∫–æ–Ω–µ—Ü, —Ç—Ä–µ—Ç—å–∏–º –∞—Å–ø–µ–∫—Ç–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ **ModernBERT** —è–≤–ª—è–µ—Ç—Å—è —É—á–µ—Ç –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è.

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –¥–≤–∞ –≤—ã–≤–æ–¥–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π:

1. **–ì–ª—É–±–∏–Ω–∞ –∏ —à–∏—Ä–∏–Ω–∞ —Å–ª–æ–µ–≤.** –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–µ –º–æ–¥–µ–ª–∏ —Å –±–æ–ª–µ–µ —É–∑–∫–∏–º–∏ —Å–ª–æ—è–º–∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –ª—É—á—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —á–µ–º –º–µ–Ω–µ–µ –≥–ª—É–±–æ–∫–∏–µ –º–æ–¥–µ–ª–∏ —Å –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–º–∏ —Å–ª–æ—è–º–∏. –û–¥–Ω–∞–∫–æ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã –º–æ–¥–µ–ª–∏ –∏–º–µ–µ—Ç –∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É: —á–µ–º –≥–ª—É–±–∂–µ –º–æ–¥–µ–ª—å, —Ç–µ–º –º–µ–Ω—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è, –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –ø—Ä–∏ —Ç–æ–º –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ.
2. **–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.** –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã —Ä–∞–∑–º–µ—Ä—ã –º–æ–¥–µ–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º —Ü–µ–ª–µ–≤–æ–≥–æ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –ø—Ä–∏—á–µ–º —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –∏–º–µ—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.

–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª–æ –±—ã –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞—Ö, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –û–¥–Ω–∞–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–ü—Ä–∏–º–µ—Ä—ã —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏ —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ–º¬ª, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å–∞–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤. –í –∫–∞—á–µ—Å—Ç–≤–µ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–∏—Ç—å —ç—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≥—Ä—É–ø–ø –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤, —Å–æ–±–ª—é–¥–∞—è –ø—Ä–∏ —ç—Ç–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.  –õ–æ–≥–∏—á–Ω–æ, —á—Ç–æ –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤–∫–ª—é—á–∞—é—Ç:

- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –∫–∞–∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –≤—ã–≤–æ–¥–∞ (**RTX 3090/4090**, **A10**, **T4**, **L4**).
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —Ü–µ–ª–µ–≤–æ–π –º–æ–¥–µ–ª–∏: –æ—Ç **130 –¥–æ 150 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –¥–ª—è **ModernBERT-Base** –∏ –æ—Ç **350 –¥–æ 420 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –¥–ª—è **ModernBERT-Large**.
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞–º –∏—Å—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ **BERT** (**768** –¥–ª—è –±–∞–∑–æ–≤–æ–π, **1024** –¥–ª—è –±–æ–ª—å—à–æ–π) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—â–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≥—Ä—É–ø–ø –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤.

–î–∞–ª–µ–µ –±—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ —Å–µ—Ç–∫–µ, –≤–∞—Ä—å–∏—Ä—É—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —à–∏—Ä–∏–Ω—É —Å–ª–æ–µ–≤.  –ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –±—ã–ª–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤, –∏ –±—ã–ª –≤—ã–±—Ä–∞–Ω –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏. üõ†Ô∏è

–ï—â–µ –æ–¥–Ω–æ–π –≤–∞–∂–Ω–æ–π –æ–±–ª–∞—Å—Ç—å—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ –∏–º–µ—é—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è, —è–≤–ª—è—é—Ç—Å—è –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ. –ß–∞—Å—Ç–æ –ø–æ–¥ —ç—Ç–∏–º –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–º –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ —ç—Ç–æ –Ω–µ —Å–æ–≤—Å–µ–º —Ç–∞–∫. –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –º–æ–¥–µ–ª–∏-–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ **DeBERTaV3**, –æ–±—É—á–∞–ª–∏—Å—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–ª–≥–æ –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –¥–∞–∂–µ –ø—Ä–µ–≤—ã—Å–∏–ª–∏ –ø–æ—Ä–æ–≥ –≤ —Ç—Ä–∏–ª–ª–∏–æ–Ω —Ç–æ–∫–µ–Ω–æ–≤! üìö

–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–∏ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö: –º–Ω–æ–≥–∏–µ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏–µ –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞–ª–∏—Å—å –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö, —á–∞—Å—Ç–æ —Å–æ—Å—Ç–æ—è—â–∏—Ö –∏–∑ **–í–∏–∫–∏–ø–µ–¥–∏–∏** –∏ **–í–∏–∫–∏–∫–Ω–∏–≥**.  –≠—Ç–∏ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Ç–µ–∫—Å—Ç–æ–≤—É—é –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç. üìñ

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –Ω–∏—Ö, **ModernBERT** –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –≤–∫–ª—é—á–∞—è –≤–µ–±-–¥–æ–∫—É–º–µ–Ω—Ç—ã, –∫–æ–¥ –∏ –Ω–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏.  –û–±—â–∏–π –æ–±—ä–µ–º –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç **2 —Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ —Ç–æ–∫–µ–Ω–æ–≤**, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —è–≤–ª—è—é—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏, –∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è **20‚Äì40 —Ä–∞–∑**, –∫–∞–∫ –≤ —Å–ª—É—á–∞–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞–º–∏. üìä

–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –æ—á–µ–≤–∏–¥–µ–Ω: —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–æ–≤ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º **ModernBERT** –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –≤ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º.  –û—Å–æ–±—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ–º–æ—â–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏. üíª

## –ü—Ä–æ—Ü–µ—Å—Å üõ†Ô∏è

–ú—ã –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ–º—Å—è –º–µ—Ç–æ–¥–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ **BERT**, —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏, –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º–∏. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –º—ã –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å –æ—Ç —Ü–µ–ª–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ –µ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç –∏–∑–ª–∏—à–Ω—é—é –Ω–∞–≥—Ä—É–∑–∫—É –±–µ–∑ –∑–∞–º–µ—Ç–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –º—ã –∏–∑–º–µ–Ω–∏–ª–∏ –¥–æ–ª—é –º–∞—Å–∫–∏—Ä—É–µ–º—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤, —É–≤–µ–ª–∏—á–∏–≤ –µ–µ —Å **15%** –¥–æ **30%**. üìà

–û–±—É—á–µ–Ω–∏–µ –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ —Ç—Ä–∏ —ç—Ç–∞–ø–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏—Ö –≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É.  –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –Ω–∞ **1,7 —Ç—Ä–∏–ª–ª–∏–æ–Ω–∞ —Ç–æ–∫–µ–Ω–æ–≤** –ø—Ä–∏ –¥–ª–∏–Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ **1024**. –ó–∞—Ç–µ–º —Å–ª–µ–¥—É–µ—Ç —ç—Ç–∞–ø –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –∫ –¥–ª–∏–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, –≤ —Ö–æ–¥–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –Ω–∞ **250 –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö —Ç–æ–∫–µ–Ω–æ–≤** —Å –¥–ª–∏–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ **8192**.  –ü—Ä–∏ —ç—Ç–æ–º, –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –≤ –∫–∞–∂–¥–æ–º –ø–∞–∫–µ—Ç–µ, –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –∑–∞ —Å—á–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–∞.  –ù–∞ –∑–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è ¬´–æ—Ç–∂–∏–≥¬ª –Ω–∞ **50 –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö —Ç–æ–∫–µ–Ω–æ–≤**, –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π, –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç–æ –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ **ProLong**. üß†

–¢–∞–∫–æ–π —Ç—Ä–µ—Ö—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ–±—É—á–µ–Ω–∏—é –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≤ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –µ–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏:  **ModernBERT** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤ –∑–∞–¥–∞—á–∞—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —É—Å—Ç—É–ø–∞–µ—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ—Ä–æ—Ç–∫–∏–º–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏. üìä

‚Ä¶–Ω–æ –µ—Å—Ç—å –∏ –µ—â–µ –æ–¥–Ω–æ –≤–∞–∂–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –Ω–∞ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö —ç—Ç–∞–ø–∞—Ö, –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ–∞–∑—ã –ø—Ä–æ–≥—Ä–µ–≤–∞, –æ–±—É—á–µ–Ω–∏–µ –≤–µ–¥–µ—Ç—Å—è —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é. –°–Ω–∏–∂–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö **50 –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö —Ç–æ–∫–µ–Ω–æ–≤**, –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–∞–ø–µ—Ü–∏–µ–≤–∏–¥–Ω–æ–π —Å—Ö–µ–º–æ–π (–∏–ª–∏ —Å—Ö–µ–º–æ–π ¬´—Ä–∞–∑–º–∏–Ω–∫–∞-—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è-—Å–ø–∞–¥¬ª).  –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—è—Å—å –ø–æ–¥—Ö–æ–¥–æ–º **Pythia**, –º—ã –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ —É–¥–∞–ª—è–µ–º –∫–∞–∂–¥—É—é –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É, —Å–æ–∑–¥–∞–Ω–Ω—É—é –≤ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ñ–∞–∑–∞—Ö –æ–±—É—á–µ–Ω–∏—è.  –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–¥–∏–∫—Ç–æ–≤–∞–Ω–æ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ–º –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –±—É–¥—É—â–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:  –ª—é–±–æ–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–∂–µ—Ç –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ —Å –ª—é–±–æ–π –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø–µ—Ä–µ–¥ —Ñ–∞–∑–æ–π —Å–ø–∞–¥–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –µ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∑–∞–¥–∞—á–∞–º! üöÄ

### –ù–æ—É-—Ö–∞—É ‚Äì –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É! üß†

–ï—Å–ª–∏ –≤—ã –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Ö–æ–¥–æ–º –∏–∑–ª–æ–∂–µ–Ω–∏—è, —Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, —É–∂–µ –ø—Ä–µ–¥–≤–∏–¥–∏—Ç–µ: –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –º—ã, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, –ø—Ä–∏–º–µ–Ω—è–µ–º —Ä—è–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫.  –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –≤ –Ω–∞—à–µ–º –∞—Ä—Å–µ–Ω–∞–ª–µ –∏–º–µ—é—Ç—Å—è –¥–≤–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏.

–ù–∞—á–Ω–µ–º —Å –ø–µ—Ä–≤–æ–π, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–π:  –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—á–∞–ª—å–Ω—ã–π —ç—Ç–∞–ø –æ–±—É—á–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω —Å —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ—Å–æ–≤, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–∞.  –ù–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å –º–∞–ª—ã–º —Ä–∞–∑–º–µ—Ä–æ–º –ø–∞–∫–µ—Ç–∞, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–æ–ª–µ–µ —á–∞—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö. –ó–∞—Ç–µ–º, –ø–æ –º–µ—Ä–µ –æ–±—É—á–µ–Ω–∏—è, –º—ã –ø–ª–∞–≤–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.  –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —ç—Ç–∞–ø –æ–±—É—á–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ —É—Å–≤–∞–∏–≤–∞–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏. üìö

–í—Ç–æ—Ä–∞—è —Ç–µ—Ö–Ω–∏–∫–∞, –Ω–∞–ø—Ä–æ—Ç–∏–≤, —è–≤–ª—è–µ—Ç—Å—è –º–µ–Ω–µ–µ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–π:  –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–µ–π —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º ¬´–º–æ–∑–∞–∏—á–Ω–æ–≥–æ¬ª –ø–æ–¥—Ö–æ–¥–∞, –≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–∏–µ–π –º–æ–¥–µ–ª–µ–π **Microsoft Phi**.  –í –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –ª–µ–∂–∏—Ç –ø—Ä–æ—Å—Ç–∞—è, –Ω–æ –≤–∞–∂–Ω–∞—è –∏–¥–µ—è:  –∑–∞—á–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å–∞ **ModernBERT-large** —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏, –µ—Å–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π (–ø–æ–∑–≤–æ–ª–∏–º —Å–µ–±–µ —Ç–∞–∫—É—é –æ—Ü–µ–Ω–∫—É) –Ω–∞–±–æ—Ä –≤–µ—Å–æ–≤ **ModernBERT-base**? üß©

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ–ø—ã—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Å–æ–≤ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ **ModernBERT** –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–∏ –¥–ª—è **ModernBERT-large** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, —á–µ–º —Å–ª—É—á–∞–π–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è.  –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ —É–¥–∞—á–Ω–æ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–∞, —á—Ç–æ –≤ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∏—Ç—å—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —ç—Ç–∞–ø–∞ –æ–±—É—á–µ–Ω–∏—è. ‚ö°

## –í –∑–∞–∫–ª—é—á–µ–Ω–∏–µ üéØ

–í –¥–∞–Ω–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –º—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∏ **ModernBERT** ‚Äì –Ω–æ–≤–æ–µ —Å–µ–º–µ–π—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∏ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ.  **ModernBERT** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–æ–ª–≥–æ–∂–¥–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–¥–∏–≥–º—ã **BERT**. üöÄ