# –ú–∞—à–∏–Ω—ã –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –º—ã—à–ª–µ–Ω–∏—è (Continuous Thought Machines)

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ  
1. [–í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è](#–≤–≤–µ–¥–µ–Ω–∏–µ-–∏-–º–æ—Ç–∏–≤–∞—Ü–∏—è)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Continuous Thought Machine](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-continuous-thought-machine)
3. [–†–∞–∑–±–æ—Ä –º–∞—Ç.–∞–ø–ø–∞—Ä–∞—Ç–∞ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º CTM](#—Ä–∞–∑–±–æ—Ä-–º–∞—Ç.–∞–ø–ø–∞—Ä–∞—Ç–∞-–ø–æ–¥-–∫–∞–ø–æ—Ç–æ–º-ctm)
4. [–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –≤—Ä–µ–º—è –∏ —Å–∏–Ω–∞–ø—Å—ã](#–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ-—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ-–≤—Ä–µ–º—è-–∏-—Å–∏–Ω–∞–ø—Å—ã)
5. [–ú–æ–¥–µ–ª–∏ —É—Ä–æ–≤–Ω—è –Ω–µ–π—Ä–æ–Ω–∞ –∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–π —Ç–∞–π–º–∏–Ω–≥](#–º–æ–¥–µ–ª–∏-—É—Ä–æ–≤–Ω—è-–Ω–µ–π—Ä–æ–Ω–∞-–∏-–Ω–µ–π—Ä–æ–Ω–Ω—ã–π-—Ç–∞–π–º–∏–Ω–≥)
6. [–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤](#–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏-–Ω–µ–π—Ä–æ–Ω–æ–≤)
7. [–§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å](#—Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è-—Ñ—É–Ω–∫—Ü–∏–∏-–ø–æ—Ç–µ—Ä—å)
8. [–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è](#–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è-–≥–ª—É–±–∏–Ω–∞-—Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è)
9. [–ó–∞–∫–ª—é—á–µ–Ω–∏–µ](#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ)

---

### **TWRB_FM üìª**

<audio controls>
  <source src="https://github.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/raw/refs/heads/develop/2025/week-20/TWRB_FM.wav" type="audio/mpeg">
  –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ—ç–ª–µ–º–µ–Ω—Ç.
</audio>

---

## **1. –í–≤–µ–¥–µ–Ω–∏–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è**

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–æ–±–∏–ª–∏—Å—å –±–æ–ª—å—à–∏—Ö —É—Å–ø–µ—Ö–æ–≤, –Ω–æ –æ—Å—Ç–∞—é—Ç—Å—è —É–ø—Ä–æ—â—ë–Ω–Ω—ã–º–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –º–æ–∑–≥–æ–º. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –æ–Ω–∏ –æ–±—ã—á–Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç **–≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É –Ω–µ–π—Ä–æ–Ω–æ–≤** ‚Äì **—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è —Å–ø–∞–π–∫–æ–≤ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—ã–µ –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç—è—Ö. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω—ã –≤—ã–¥–∞—é—Ç –ª–∏—à—å –æ–¥–Ω–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É—è *–∫–æ–≥–¥–∞* –Ω–µ–π—Ä–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥–∏—Ö. –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤—Ä–æ–¥–µ –∑–∞–≤–∏—Å–∏–º–æ–π –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å–ø–∞–π–∫–æ–≤ –ø–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ (STDP) —É–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Ç–∞–π–º–∏–Ω–≥ –≤–∞–∂–µ–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–æ–∑–≥–æ–º. –†–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É –≥–∏–±–∫–∏–º —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º –º—ã—à–ª–µ–Ω–∏–µ–º –∏ —Ç–µ–∫—É—â–∏–º –ò–ò –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –≤ –º–æ–¥–µ–ª—è—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å **–≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π** —Å–∏–≥–Ω–∞–ª–æ–≤.

**Continuous Thought Machine (CTM)** ‚Äì —ç—Ç–æ –Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è Sakana AI, –∫–æ—Ç–æ—Ä–∞—è *–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –≤ –æ—Å–Ω–æ–≤—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏*. –ú–æ–¥–µ–ª—å CTM —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤ –∫–∞–∫ –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, CTM —Å–Ω–∞–±–∂–∞–µ—Ç –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –µ–≥–æ –ø—Ä–æ—à–ª—ã—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏—è—Ö, –ø–æ–∑–≤–æ–ª—è—è –µ–º—É –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É CTM –º–æ–∂–µ—Ç ¬´—Ä–∞–∑–º—ã—à–ª—è—Ç—å¬ª –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π –ø–æ—à–∞–≥–æ–≤–æ, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—è –Ω–µ–π—Ä–æ–Ω—ã –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–µ–ª–∞—è —Ö–æ–¥ —Ä–µ—à–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–º –¥–ª—è —á–µ–ª–æ–≤–µ–∫–∞. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —É–ª—É—á—à–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫ —Ä–µ—à–µ–Ω–∏—é —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –∏ –ø–æ–≤—ã—à–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä—è–¥–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á. CTM —è–≤–ª—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —à–∞–≥–æ–º –∫ —Å–±–ª–∏–∂–µ–Ω–∏—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π, —Ä–∞—Å–∫—Ä—ã–≤–∞—è –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ò–ò.

## **2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Continuous Thought Machine**

**Continuous Thought Machine** –≤–≤–æ–¥–∏—Ç —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö –Ω–æ–≤–æ–≤–≤–µ–¥–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–µ–π—Ä–æ—Å–µ—Ç–∏: 

1. *–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏* (–æ—Ç–¥–µ–ª—ë–Ω–Ω–æ–µ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö), –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º–æ–≥—É—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏–∫–∏ ¬´–º—ã—à–ª–µ–Ω–∏—è¬ª –º–æ–¥–µ–ª–∏; 
2. *–º–æ–¥–µ–ª–∏ —É—Ä–æ–≤–Ω—è –Ω–µ–π—Ä–æ–Ω–∞* (Neuron-Level Models, NLMs) ‚Äì –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–µ –∏—Å—Ç–æ—Ä–∏—é –≤—Ö–æ–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏; 
3. *–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤* ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ –≤ –∞–∫—Ç–∏–≤–∞—Ü–∏—è—Ö** –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π. –ù–∏–∂–µ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã CTM –∏ –∏—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é.

![–†–∏—Å—É–Ω–æ–∫ 1](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-20/assets/Image_01.jpeg)

**–†–∏—Å. 1:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Continuous Thought Machine (CTM) —Å –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ–º –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.  

1. **Synapse model** ‚Äì –º–æ–¥–µ–ª—å —Å–∏–Ω–∞–ø—Å–æ–≤ (—Å–∏–Ω–∏–µ —Å–≤—è–∑–∏) –≤—ã—á–∏—Å–ª—è–µ—Ç *–ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏* $a^t$ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞, –º–æ–¥–µ–ª–∏—Ä—É—è –º–µ–∂–Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–≤—è–∑–∏;
2. **History (pre-activations)** ‚Äì –±—É—Ñ–µ—Ä –∏–∑ $M$ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $A^t$ (–æ—Ç–æ–±—Ä–∞–∂—ë–Ω –≤–æ–ª–Ω–∞–º–∏);
3. **Neuron-Level Models** ‚Äì –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤ (–∫—Ä–∞—Å–Ω—ã–º) $g_{\theta_d}$ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∏—Å—Ç–æ—Ä–∏—é $A^t_d$ –∏ –≤—ã–¥–∞—é—Ç *–ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏* $z^{t+1}_d$;
4. **Post-activations** ‚Äì –≤–µ–∫—Ç–æ—Ä –≤—ã—Ö–æ–¥–Ω—ã—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏–π $z^{t+1}$ –≤—Å–µ—Ö $D$ –Ω–µ–π—Ä–æ–Ω–æ–≤ –Ω–∞ —Ç–µ–∫—É—â–µ–º —à–∞–≥–µ;
5. **History (post-activations)** ‚Äì –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –∏—Å—Ç–æ—Ä–∏—è –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $Z^t$;
6. **Synchronization matrix $S^t$** ‚Äì –º–∞—Ç—Ä–∏—Ü–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏, –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –∫–∞–∫ —Å–∫–∞–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–µ–∂–¥—É –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–µ–π—Ä–æ–Ω–æ–≤;
7. **Selected neuron pairs** ‚Äì –≤—ã–±–æ—Ä –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ $S^t$ (–ø–∞—Ä—ã –Ω–µ–π—Ä–æ–Ω–æ–≤), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ª–∞—Ç–µ–Ω—Ç–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏;
8. **Latent representation** ‚Äì –≤–µ–∫—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–∑–µ–ª—ë–Ω—ã–π) –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $S^t$, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–π –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏ –¥–ª—è –≤–Ω–∏–º–∞–Ω–∏—è;
9. **OUT/ATTN projections** ‚Äì –ª–∏–Ω–µ–π–Ω—ã–µ —Å–ª–æ–∏: $W_{\text{out}}$ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –≤ –≤—ã—Ö–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∞—Å—Å—ã), $W_{\text{in}}$ ‚Äì –≤ –≤–µ–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è *q*;
10. **Data modulation (Attention output)** ‚Äì —Å –ø–æ–º–æ—â—å—é *q* –º–æ–¥–µ–ª—å –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (—á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è *ATTN*, –∂—ë–ª—Ç—ã–π –±–ª–æ–∫ $o^t$), –∏ —ç—Ç–∞ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —Ç–µ–∫—É—â–∏–º–∏ –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—è–º–∏, –∑–∞–º—ã–∫–∞—è —Ü–∏–∫–ª –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–∏–∫.

## **3. –†–∞–∑–±–æ—Ä –º–∞—Ç.–∞–ø–ø–∞—Ä–∞—Ç–∞ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º CTM**

**–ü—Ä–∏–º–µ—Ä –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è CTM –∫ –∑–∞–¥–∞—á–µ NLP: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–∏–ø–∏—á–Ω—É—é –∑–∞–¥–∞—á—É –∏–∑ –æ–±–ª–∞—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞: **–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞** –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ü—É—Å—Ç—å –≤—Ö–æ–¥–æ–º –º–æ–¥–µ–ª–∏ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–∞:

$$
\text{Input: } \quad x = (x_1, x_2, \dots, x_{t})
$$

–ó–∞–¥–∞—á–∞ –º–æ–¥–µ–ª–∏ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ç–æ–∫–µ–Ω $x_{t+1}$. –î–ª—è —ç—Ç–æ–≥–æ CTM –±—É–¥–µ—Ç **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —Ä–∞–∑–º—ã—à–ª—è—Ç—å –Ω–∞–¥ –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é** –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —à–∞–≥–æ–≤ $\tau = 1, 2, \dots, T$, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∏ —É—Ç–æ—á–Ω—è—è –µ–≥–æ –ø–æ –º–µ—Ä–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤.

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã CTM:

<details> 
    <summary><em><strong>1. Synapse model</strong></em></summary>

### **1. Synapse model**

–ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —à–∞–≥–µ $\tau$, –º–æ–¥–µ–ª—å —Å–∏–Ω—Ç–µ–∑–∏—Ä—É–µ—Ç –≤–µ–∫—Ç–æ—Ä *–ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π* $a^\tau \in \mathbb{R}^D$ —á–µ—Ä–µ–∑ —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫—É—é –º–æ–¥–µ–ª—å:

$$
a^\tau = f_{\theta_{\text{syn}}}([z^\tau, o^\tau])
$$

–≥–¥–µ:

* $z^\tau \in \mathbb{R}^D$ ‚Äî –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ;
* $o^\tau \in \mathbb{R}^{d_{\text{attn}}}$ ‚Äî –≤–µ–∫—Ç–æ—Ä –≤–Ω–∏–º–∞–Ω–∏—è (–º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –≤—Ö–æ–¥–∞);
* $f_{\theta_{\text{syn}}}$ ‚Äî MLP —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π —Ç–∏–ø–∞ U-Net.

–í NLP-–∑–∞–¥–∞—á–µ:

* –≤—Ö–æ–¥ $o^\tau$ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤ $x = (x_1, ..., x_t)$, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞–∫ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —á–µ—Ä–µ–∑ —ç–Ω–∫–æ–¥–µ—Ä $F(x) \in \mathbb{R}^{t \times d_{\text{attn}}}$.
* –≤—ã—Ö–æ–¥ $a^\tau$ –º–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ ¬´–æ—Ü–µ–Ω–∫—É –Ω–µ–π—Ä–æ–Ω–æ–≤¬ª –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –≤–Ω–∏–º–∞–Ω–∏—è –∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

<details> 
    <summary><em><strong>üß† MLP —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π —Ç–∏–ø–∞ U-Net</strong></em></summary>

### **MLP —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π —Ç–∏–ø–∞ U-Net –¥–ª—è —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏**

–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ CTM –ø–æ–¥ **U-Net-–ø–æ–¥–æ–±–Ω—ã–º MLP** –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É ¬´–∫–æ–Ω—Ç—Ä–∞–∫—Ü–∏–∏ ‚Äì —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è¬ª —Å *–ø—Ä–æ–ø—É—Å–∫–∞–º–∏* (skip connections), –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º—É U-Net –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–º –∑—Ä–µ–Ω–∏–∏, –Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–∞—è –∫ –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–º—É –≤–µ–∫—Ç–æ—Ä—É –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–ù–∏–∂–µ –ø–æ—ç—Ç–∞–ø–Ω–æ —Ä–∞–∑–±–µ—Ä—ë–º, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç—Ä–æ–µ–Ω —Ç–∞–∫–æ–π –º–æ–¥—É–ª—å $f_{\theta_{\text{syn}}}$.

---

### 1. –í—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä –∏ –µ–≥–æ —Ä–∞–∑–º–µ—Ä—ã

–ù–∞ —à–∞–≥–µ $\tau$ –º—ã –∏–º–µ–µ–º –¥–≤–∞ –≤–µ–∫—Ç–æ—Ä–∞:

* $z^\tau \in \mathbb{R}^D$ ‚Äî –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤—Å–µ—Ö $D$ –Ω–µ–π—Ä–æ–Ω–æ–≤ —Å –ø—Ä–æ—à–ª–æ–≥–æ —à–∞–≥–∞.
* $o^\tau \in \mathbb{R}^{d_{\text{attn}}}$ ‚Äî –≤—ã—Ö–æ–¥ –≤–Ω–∏–º–∞–Ω–∏—è, –∏–∑–≤–ª–µ—á—ë–Ω–Ω—ã–π –∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–û–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö –≤ –µ–¥–∏–Ω—ã–π –≤–µ–∫—Ç–æ—Ä:

$$
v^\tau = 
\begin{bmatrix}
z^\tau \\[4pt]
o^\tau
\end{bmatrix}
\;\in\;
\mathbb{R}^{\,D + d_{\text{attn}}}\
$$

#### **–ü—Ä–∏–º–µ—Ä:**

1. –ó–∞–¥–∞—ë–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏: $D=3$, $d_{\text{attn}}=2$

2. –í—ã–±–∏—Ä–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã:

   $$
   z^œÑ = (0.1,\;-0.4,\;0.7)
   $$

   $$
   o^œÑ = (0.5,\;-0.2)
   $$

3. –û–±—ä–µ–¥–∏–Ω—è–µ–º:

   $$
   v^œÑ = 
   \begin{bmatrix}
     0.1\\
     -0.4\\
     0.7\\
     0.5\\
     -0.2
   \end{bmatrix}
   \in \mathbb R^5
   $$

**Python-–ø—Å–µ–≤–¥–æ–∫–æ–¥:**

```python
import numpy as np

# –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏
D = 3
d_attn = 2

# –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
z = np.array([0.1, -0.4, 0.7])       # —Ñ–æ—Ä–º–∞ (3,)
o = np.array([0.5, -0.2])            # —Ñ–æ—Ä–º–∞ (2,)

# –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è
v = np.concatenate([z, o])           # —Ñ–æ—Ä–º–∞ (5,)
print("v =", v)                      # [ 0.1 -0.4  0.7  0.5 -0.2]
print("Shape of v:", v.shape)        # (5,)
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤–µ–∫—Ç–æ—Ä $v^œÑ$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D + d\_{\text{attn}}$ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ –∫–∞–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—è—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤, —Ç–∞–∫ –∏ —Å–≤–µ–¥–µ–Ω–∏—è –∏–∑ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –≤–Ω–∏–º–∞–Ω–∏—è.

---

### 2. –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω—ã–π (—Å–∂–∞—Ç—ã–π) –ø—É—Ç—å

–¶–µ–ª—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏ ‚Äî –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –∏–∑–≤–ª–µ–∫–∞—è –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –ü—É—Å—Ç—å —É –Ω–∞—Å –∑–∞–¥–∞–Ω–æ $L$ —É—Ä–æ–≤–Ω–µ–π —Å–∂–∞—Ç–∏—è. –ù–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ $\ell = 1,2,\dots,L$ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

1. **–ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π** (Linear) —Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏:

   $$
     e^\ell = \sigma\bigl(W_e^\ell\,e^{\ell-1} + b_e^\ell\bigr),
     \quad
     e^0 \equiv v^\tau,
   $$

   –≥–¥–µ:

   - $\sigma(\cdot)$ ‚Äî –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å (ReLU, GELU –∏ —Ç.–ø.);
   - $W_e^\ell$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $\;d_{\ell}\times d_{\ell-1}$;
   - $d_0 = D + d_{\text{attn}}$;
   - $d_\ell < d_{\ell-1}$.

2. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–∂–∞—Ç–∏–π** (–ø–æ –∂–µ–ª–∞–Ω–∏—é) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Ç–æ—Ä–æ–π Linear –∏–ª–∏ BatchNorm+ReLU, –Ω–æ –∫–ª—é—á–µ–≤–æ–µ ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ ¬´–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω—ã–π¬ª –≤—ã—Ö–æ–¥ —É—Ä–æ–≤–Ω—è:

   $$
     \tilde e^\ell = \sigma\bigl(W_{\tilde e}^\ell\,e^\ell + b_{\tilde e}^\ell\bigr).
   $$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ—Å–ª–µ $L$-–≥–æ —É—Ä–æ–≤–Ω—è –∏–º–µ–µ–º ¬´–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª:

$$
b = \tilde e^L \in \mathbb{R}^{d_L},
$$

–≥–¥–µ $d_L$ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å.

#### **–ü—Ä–∏–º–µ—Ä:**

–í–æ–∑—å–º—ë–º:

- $d_0 = D + d_{\mathrm{attn}} = 5$;  
- —á–∏—Å–ª–æ —É—Ä–æ–≤–Ω–µ–π $L = 2$;  
- –Ω–∞ –ø–µ—Ä–≤–æ–º —É—Ä–æ–≤–Ω–µ $d_1 = 4$, –Ω–∞ –≤—Ç–æ—Ä–æ–º $d_2 = 2$.

–ü—É—Å—Ç—å –≤–µ–∫—Ç–æ—Ä –Ω–∞ –≤—Ö–æ–¥–µ:

$$
e^0 = v^\tau = \begin{pmatrix}0.1\\ -0.4\\ 0.7\\ 0.5\\ -0.2\end{pmatrix}
$$

–ó–∞–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏ —Å–º–µ—â–µ–Ω–∏—è:

1. **–£—Ä–æ–≤–µ–Ω—å $\ell=1$:**

   $$
   W_e^1 = 
   \begin{pmatrix}
     1 & 0 & 0 & 0 & 0 \\
     0 & 1 & 0 & 0 & 0 \\
     0 & 0 & 1 & 0 & 0 \\
     0 & 0 & 0 & 1 & 0 
   \end{pmatrix},\quad
   b_e^1 = \begin{pmatrix}0\\0\\0\\0\end{pmatrix}
   $$

   –¢–æ–≥–¥–∞:

   $$
   e^1 = \mathrm{ReLU}(W_e^1 e^0 + b_e^1)
       = \mathrm{ReLU}\!\bigl([0.1,\,-0.4,\,0.7,\,0.5]^\top\bigr)
       = [0.1,\,0,\,0.7,\,0.5]^\top
   $$

   –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–∂–∞—Ç–∏–µ:

   $$
   W_{\tilde e}^1 = I_{4},\quad b_{\tilde e}^1=0,\qquad
   \tilde e^1 = \mathrm{ReLU}(e^1) = [0.1,\,0,\,0.7,\,0.5]^\top
   $$

2. **–£—Ä–æ–≤–µ–Ω—å $\ell=2$:**

   $$
   W_e^2 = 
   \begin{pmatrix}
     0 & 1 & 0 & 0 \\
     0 & 0 & 1 & 0 
   \end{pmatrix},\quad
   b_e^2 = \begin{pmatrix}0\\0\end{pmatrix}
   $$

   –¢–æ–≥–¥–∞:

   $$
   e^2 = \mathrm{ReLU}(W_e^2 \tilde e^1 + b_e^2)
       = \mathrm{ReLU}\!\bigl([0,\,0.7]^\top\bigr)
       = [0,\,0.7]^\top
   $$

   –ò –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ:

   $$
   W_{\tilde e}^2 = I_{2},\quad b_{\tilde e}^2=0,\qquad
   \tilde e^2 = \mathrm{ReLU}(e^2) = [0,\,0.7]^\top
   $$

–í –∏—Ç–æ–≥–µ ¬´–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª:

$$
b = \tilde e^2 = \begin{pmatrix}0\\0.7\end{pmatrix}
\;\in\;\mathbb R^{d_2},\quad d_2=2.
$$


#### **–í—ã–≤–æ–¥:**

1. –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è:

   $$
   v^\tau = 
   \begin{bmatrix}
     z^\tau \\[4pt]
     o^\tau
   \end{bmatrix}
   \;\in\;
   \mathbb{R}^{D + d_{\text{attn}}}
   $$

   –≥–¥–µ —Å–≤–µ—Ä—Ö—É –∏–¥—É—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã $z^\tau\in\mathbb R^D$, –∞ —Å–Ω–∏–∑—É $o^\tau\in\mathbb R^{d\_{\text{attn}}}$

2. ¬´–ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª:

   –ü–æ—Å–ª–µ –¥–≤—É—Ö —É—Ä–æ–≤–Ω–µ–π —Å–∂–∞—Ç–∏—è $L=2$ –º—ã –ø–æ–ª—É—á–∏–ª–∏:

   $$
   b = \tilde e^2 = 
   \begin{pmatrix}
     0\\
     0.7
   \end{pmatrix}
   \;\in\;
   \mathbb{R}^{d_2},
   \quad d_2 = 2
   $$

–≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, –∫ —á–µ–º—É —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å: –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $d\_0=D+d\_{\mathrm{attn}}$ –ø–æ—ç—Ç–∞–ø–Ω–æ —Å–∂–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ $d\_L$, –∑–¥–µ—Å—å –¥–æ 2.

---

### 3. –†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏

–¢–µ–ø–µ—Ä—å –Ω–∞—á–∏–Ω–∞–µ–º **—Ä–∞—Å—à–∏—Ä—è—Ç—å** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –∫ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D$. –ü—Ä–∏ —ç—Ç–æ–º –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ø—Ä–æ–ø—É—Å–∫** (skip connection) –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏ —Ç–æ–≥–æ –∂–µ —É—Ä–æ–≤–Ω—è:

–î–ª—è $\ell = L, L-1, \dots, 1$:

1. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è** —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–∫–æ–¥–µ—Ä–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ:

   $$
     c^\ell = 
     \begin{bmatrix}
       \tilde e^\ell \\[4pt]
       d^{\ell+1}
     \end{bmatrix},
     \quad
     d^{L+1} \equiv b.
   $$

   –ó–¥–µ—Å—å $c^\ell \in \mathbb{R}^{\,d_\ell + d_\ell}$.

2. **–ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è**:

   $$
     d^\ell = \sigma\bigl(W_d^\ell\,c^\ell + b_d^\ell\bigr),
   $$

   –≥–¥–µ $W_d^\ell\colon \mathbb{R}^{d_\ell + d_\ell} \to \mathbb{R}^{d_{\ell-1}}$.

–ò—Ç–æ–≥–æ–º –ø–æ—Å–ª–µ —É—Ä–æ–≤–Ω—è $\ell=1$ –±—É–¥–µ—Ç –≤–µ–∫—Ç–æ—Ä:

$$
d^1 \in \mathbb{R}^{d_0} = \mathbb{R}^{\,D + d_{\text{attn}}}.
$$

#### **–ü—Ä–∏–º–µ—Ä:**

–ü—Ä–∏ —Ä–∞—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–∏ –º—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –∫ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $d_0 = D + d_{\mathrm{attn}}$, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ–ø—É—Å–∫–∏ (skip connections) –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏.

> **–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞:**
>
> * $D = 3$, $d_{\mathrm{attn}} = 2$ ‚Üí $d_0 = 5$
> * –ß–∏—Å–ª–æ —É—Ä–æ–≤–Ω–µ–π $L = 2$
> * –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —É—Ä–æ–≤–Ω–µ–π —Å–∂–∞—Ç–∏—è: $d_1 = 4$, $d_2 = 2$
> * ¬´–ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª $b = \tilde e^2 = [0,\;0.7]^\top$

#### –®–∞–≥ ‚Ñì = 2 (—É—Ä–æ–≤–µ–Ω—å $L$)

1. **–ü—Ä–æ–ø—É—Å–∫ –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏:**
   $\tilde e^2 = [0,\;0.7]^\top$

2. **–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –¥–µ–∫–æ–¥–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
   $d^3 \equiv b = [0,\;0.7]^\top$

3. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è:**

   $$
     c^2 =
     \begin{bmatrix}
       \tilde e^2 \\[4pt]
       d^3
     \end{bmatrix}
     =
     \begin{bmatrix}
       0 \\[2pt]
       0.7 \\[2pt]
       0 \\[2pt]
       0.7
     \end{bmatrix}
     \;\in\;\mathbb R^{\,d_2 + d_2} = \mathbb R^4
   $$

4. **–õ–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:**
   –í—ã–±–∏—Ä–∞–µ–º –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã:

   $$
   W_d^2 =
   \begin{pmatrix}
     1 & 0 & 0 & 0 \\
     0 & 1 & 0 & 0 \\
     0 & 0 & 1 & 0 \\
     0 & 0 & 0 & 1 \\
     0 & 0 & 0 & 0
   \end{pmatrix}_{5\times 4},\quad
   b_d^2 = \mathbf{0}_{5}.
   $$

   –¢–æ–≥–¥–∞:

   $$
   d^2 = \mathrm{ReLU}(W_d^2\,c^2 + b_d^2)
       = \mathrm{ReLU}\!\bigl([\,0,\;0.7,\;0,\;0.7,\;0\,]^\top\bigr)
       = [\,0,\;0.7,\;0,\;0.7,\;0\,]^\top
   \;\in\;\mathbb R^5.
   $$

#### –®–∞–≥ ‚Ñì = 1

1. **–ü—Ä–æ–ø—É—Å–∫ –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏:**
   $\tilde e^1 = [0.1,\;0,\;0.7,\;0.5]^\top$

2. **–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –¥–µ–∫–æ–¥–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
   $d^2 = [0,\;0.7,\;0,\;0.7,\;0]^\top$

3. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è:**

   $$
     c^1 =
     \begin{bmatrix}
       \tilde e^1 \\[4pt]
       d^2
     \end{bmatrix}
     =
     \begin{bmatrix}
       0.1 \\[2pt]
       0 \\[2pt]
       0.7 \\[2pt]
       0.5 \\[2pt]
       0 \\[2pt]
       0 \\[2pt]
       0.7 \\[2pt]
       0 \\[2pt]
       0.7 \\[2pt]
       0
     \end{bmatrix}
     \;\in\;\mathbb R^{\,d_1 + d_1} = \mathbb R^8
   $$

4. **–õ–∏–Ω–µ–π–Ω—ã–π —Å–ª–æ–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:**
   –ü—É—Å—Ç—å:

   $$
   W_d^1 \colon \mathbb R^8 \to \mathbb R^5,\quad
   W_d^1 = 
   \begin{pmatrix}
     I_5 & \mathbf{0}_{5\times3}
   \end{pmatrix},
   \quad b_d^1 = \mathbf{0}_5.
   $$

   –¢–æ–≥–¥–∞:

   $$
   d^1 = \mathrm{ReLU}(W_d^1\,c^1 + b_d^1)
       = \mathrm{ReLU}\!\bigl([\,0.1,\;0,\;0.7,\;0.5,\;0\,]^\top\bigr)
       = [\,0.1,\;0,\;0.7,\;0.5,\;0\,]^\top
   = v^\tau.
   $$

–í –∏—Ç–æ–≥–µ –ø–æ—Å–ª–µ —É—Ä–æ–≤–Ω—è ‚Ñì=1 –º—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –≤–µ–∫—Ç–æ—Ä $d^1\in\mathbb R^5$, —Å–æ–≤–ø–∞–¥–∞—é—â–∏–π —Å –∏—Å—Ö–æ–¥–Ω—ã–º $v^\tau$, —á—Ç–æ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å.

```python
import numpy as np

# –ü—Ä–∏–º–µ—Ä —Ä–∞—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è L=2, D=3, d_attn=2
tilde_e2 = np.array([0, 0.7])
d3 = tilde_e2.copy()  # bottleneck

# –®–∞–≥ ‚Ñì=2
c2 = np.concatenate([tilde_e2, d3])       # —Ñ–æ—Ä–º–∞ (4,)
d2 = np.maximum(np.dot(np.vstack([np.eye(4), np.zeros((1,4))]), c2), 0)

# –®–∞–≥ ‚Ñì=1
tilde_e1 = np.array([0.1, 0, 0.7, 0.5])
c1 = np.concatenate([tilde_e1, d2])      # —Ñ–æ—Ä–º–∞ (8,)
d1 = np.maximum(np.dot(np.hstack([np.eye(5), np.zeros((5,3))]), c1), 0)

print("d1 =", d1)  # –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π v = [0.1, 0, 0.7, 0.5, 0]
```

#### **–í—ã–≤–æ–¥:**

1. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è**

   $$
   v^\tau = 
   \begin{bmatrix}
     z^\tau \\[4pt]
     o^\tau
   \end{bmatrix}
   \;\in\;
   \mathbb{R}^{D + d_{\text{attn}}}
   $$

   –≥–¥–µ —Å–≤–µ—Ä—Ö—É –∏–¥—É—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã $z^\tau\in\mathbb R^D$, –∞ —Å–Ω–∏–∑—É $o^\tau\in\mathbb R^{d\_{\text{attn}}}$.

2. **¬´–ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª**

   –ü–æ—Å–ª–µ –¥–≤—É—Ö —É—Ä–æ–≤–Ω–µ–π —Å–∂–∞—Ç–∏—è $L=2$ –º—ã –ø–æ–ª—É—á–∏–ª–∏:

   $$
   b = \tilde e^2 = 
   \begin{pmatrix}
     0\\
     0.7
   \end{pmatrix}
   \;\in\;
   \mathbb{R}^{d_2},
   \quad d_2 = 2.
   $$

3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ (skip connections)**

   –ü–æ—Å–ª–µ —Ä–∞—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö $\ell=2$ –∏ $\ell=1$ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º —Å–∫—Ä—ã—Ç—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—É—Ç–∏ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ—ë–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–ª—É—á–∞–µ–º:

   $$
   d^1 = 
   \mathrm{ReLU}\bigl(W_d^1\,c^1 + b_d^1\bigr)
   = v^\tau
   \;\in\;
   \mathbb{R}^{D + d_{\text{attn}}}.
   $$

   –¢–æ –µ—Å—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ä–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –º—ã **–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –≤–µ–∫—Ç–æ—Ä** $v^\tau$, —á—Ç–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ü–∏–∫–ª ¬´—Å–∂–∞—Ç–∏–µ‚Äì—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ¬ª —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–ø—É—Å–∫–∏.

---

### 4. –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **–ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏** $a^\tau \in \mathbb{R}^D$, –∏–∑–≤–ª–µ–∫–∞–µ–º –∏–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –ø–µ—Ä–≤—ã–µ $D$ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π Linear-—Å–ª–æ–π):

$$
a^\tau = W_{\text{out}}^{\text{syn}}\;d^1 + b_{\text{out}}^{\text{syn}},
\qquad
W_{\text{out}}^{\text{syn}}\colon \mathbb{R}^{D + d_{\text{attn}}}\to\mathbb{R}^D.
$$

#### **–ü—Ä–∏–º–µ—Ä:**

* –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏: $D=3$, $d_{\mathrm{attn}}=2$;$\Rightarrow$; $D + d_{\mathrm{attn}} = 5$.
* –ü—É—Å—Ç—å –ø–æ—Å–ª–µ —Ä–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –º—ã –ø–æ–ª—É—á–∏–ª–∏:

  $$
    d^1 = 
    \begin{pmatrix}
      0.1\\
      0\\
      0.7\\
      0.5\\
      0
    \end{pmatrix}
    \in\mathbb R^5.
  $$
* –ó–∞–¥–∞—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è:

  $$
    W_{\text{out}}^{\text{syn}}
      = \bigl[I_3\;\bigm|\;\mathbf{0}_{3\times2}\bigr]
      = 
      \begin{pmatrix}
        1 & 0 & 0 & 0 & 0\\
        0 & 1 & 0 & 0 & 0\\
        0 & 0 & 1 & 0 & 0
      \end{pmatrix},
    \quad
    b_{\text{out}}^{\text{syn}}
      = 
      \begin{pmatrix}
        0.05\\
       -0.05\\
        0.10
      \end{pmatrix}.
  $$
* –¢–æ–≥–¥–∞:

  $$
    a^\tau
    = W_{\text{out}}^{\text{syn}}\,d^1 + b_{\text{out}}^{\text{syn}}
    = 
    \begin{pmatrix}
      1 & 0 & 0 & 0 & 0\\
      0 & 1 & 0 & 0 & 0\\
      0 & 0 & 1 & 0 & 0
    \end{pmatrix}
    \begin{pmatrix}
      0.1\\0\\0.7\\0.5\\0
    \end{pmatrix}
    +
    \begin{pmatrix}
      0.05\\-0.05\\0.10
    \end{pmatrix}
    =
    \begin{pmatrix}
      0.1 + 0.05\\
      0   - 0.05\\
      0.7 + 0.10
    \end{pmatrix}
    =
    \begin{pmatrix}
      0.15\\
     -0.05\\
      0.80
    \end{pmatrix}.
  $$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤—ã—Ö–æ–¥–Ω–æ–π –±–ª–æ–∫ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $a^\tau$ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D$, –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ —Å–ª–µ–¥—É—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —à–∞–≥ CTM.

---

### 5. –°—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π –ø—Å–µ–≤–¥–æ–∫–æ–¥

```python
def f_syn(v: Tensor) -> Tensor:
    # v.shape = (batch_size, D + d_attn)
    
    # –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å
    e = v
    enc_skips = []
    for ‚Ñì in range(1, L+1):
        e = ReLU(Linear_e[‚Ñì](e))        # d_{‚Ñì} <-- d_{‚Ñì-1}
        enc_skips.append(e)             # —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è skip
        e = ReLU(Linear_e_tilde[‚Ñì](e))  

    b = e  # bottleneck vector, shape=(batch, d_L)

    # –†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
    d = b
    for ‚Ñì in reversed(range(1, L+1)):
        skip = enc_skips[‚Ñì-1]          # —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
        d = torch.cat([skip, d], dim=-1)
        d = ReLU(Linear_d[‚Ñì](d))       # d_{‚Ñì-1} <-- 2*d_{‚Ñì}

    # –í—ã—Ö–æ–¥
    a = Linear_out(d)                  # (batch, D)
    return a
```

---

### 6. –ó–∞—á–µ–º —Å—Ç–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤?

* **–ö–æ–Ω—Ç—Ä–∞–∫—Ü–∏—è** –ø–æ–∑–≤–æ–ª—è–µ—Ç $f_{\theta_{\text{syn}}}$ —É–ª–∞–≤–ª–∏–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ, –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —á–∞—Å—Ç—è–º–∏ –≤–µ–∫—Ç–æ—Ä–∞ $[z^\tau, o^\tau]$, —Å–∂–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —É–∑–∫–æ–µ ¬´–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª.
* **–ü—Ä–æ–ø—É—Å–∫–∏ (skip connections)** –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç, —á—Ç–æ —Ç–æ—á–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è (–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è) –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏: –æ–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–ª–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π.
* **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ** –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞, –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.

#### –ò—Ç–æ–≥–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞

–°—É–º–º–∞—Ä–Ω–æ:

$$
\begin{aligned}
e^0 &= [z^\tau; o^\tau],\\
e^\ell &= \sigma\bigl(W_e^\ell\,e^{\ell-1} + b_e^\ell\bigr),\quad
\tilde e^\ell = \sigma\bigl(W_{\tilde e}^\ell\,e^\ell + b_{\tilde e}^\ell\bigr),\\
b &= \tilde e^L,\\
c^\ell &= [\,\tilde e^\ell; d^{\ell+1}],\quad
d^\ell = \sigma\bigl(W_d^\ell\,c^\ell + b_d^\ell\bigr),\\
a^\tau &= W_{\text{out}}^{\text{syn}}\,d^1 + b_{\text{out}}^{\text{syn}}.
\end{aligned}
$$

### 7. –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥

MLP —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π ¬´–∫–æ–Ω—Ç—Ä–∞–∫—Ü–∏—è‚Äì—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ¬ª –∏ skip-—Å–≤—è–∑—è–º–∏ –≤ CTM –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–µ –ø—Ä–æ—Å—Ç–æ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ $z^\tau$ –∏ $o^\tau$, –∞ –¥–ª—è **–º–Ω–æ–≥–æ–º–∞—Å—à—Ç–∞–±–Ω–æ–π, –≥–∏–±–∫–æ–π –∏ —É—Å—Ç–æ–π—á–∏–≤–æ–π** –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Ö —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –û–Ω —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–∑ –Ω–∏—Ö –±–æ–≥–∞—Ç—ã–π, –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –º–∞–ø–ø–∏–Ω–≥, —Å–ª—É–∂–∞—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $a^\tau$, —Å —É—á—ë—Ç–æ–º –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö, —Ç–∞–∫ –∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–∏:

#### 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–Ω–æ–≥–æ–º–∞—Å—à—Ç–∞–±–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

* **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å ¬´—Å–∂–∏–º–∞–µ—Ç¬ª –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä $\bigl[z^\tau; o^\tau\bigr]$ –≤ —É–∑–∫–æ–µ ¬´–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª $b$, –≥–¥–µ —Å–µ—Ç—å –≤—ã—á–ª–µ–Ω—è–µ—Ç –æ–±–æ–±—â—ë–Ω–Ω—ã–µ, –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
* **–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:** –±–ª–∞–≥–æ–¥–∞—Ä—è skip-—Å–≤—è–∑—è–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —É—Ä–æ–≤–Ω–µ–π, –Ω–∞ —ç—Ç–∞–ø —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞–µ—Ç ¬´—Å—ã—Ä–æ–π¬ª —Å–∏–≥–Ω–∞–ª —Å–∂–∞—Ç–∏—è, —á—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ—á–Ω—ã–µ, –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –∫–∞–∂–¥–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞.

#### 2. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ
   
–†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å ¬´—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç¬ª –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –∫ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $D + d_{\text{attn}}$, –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ —Å–º–µ—à–∏–≤–∞—è –≤ —Å–µ–±–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ –∏–∑ —É–∑–ª–∞ $b$, –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ skip-—Å–≤—è–∑–µ–π. –í –∏—Ç–æ–≥–µ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $a^\tau$ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∏ ¬´—à–∏—Ä–æ–∫—É—é –∫–∞—Ä—Ç–∏–Ω—É¬ª, –∏ —Ç–æ–Ω–∫–∏–µ –Ω—é–∞–Ω—Å—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤.

#### 3. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
   
Skip-connections –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø—Ä—è–º–æ–π –ø—É—Ç—å –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –æ—Ç –≥–ª—É–±–æ–∫–∏—Ö —Å–ª–æ—ë–≤ –æ–±—Ä–∞—Ç–Ω–æ –∫ –≤—Ö–æ–¥—É, —á—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –ø—Ä–∏ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –º–æ–¥—É–ª—è –≤ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –ø–µ—Ç–ª–µ CTM. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è ¬´–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö¬ª –∏—Ç–µ—Ä–∞—Ü–∏–π –º–æ–¥–µ–ª–∏.

#### 4. –ì–∏–±–∫–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
   
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π $L$ –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $d_\ell$ –º–æ–≥—É—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –∏–ª–∏ —É–º–µ–Ω—å—à–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –±–æ–≥–∞—Ç—É—é –≤—ã—Ä–∞–∂–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å. –¢–∞–∫–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å–∏–Ω–æ–ø—Ç–∏—á–µ—Å–∫—É—é U-Net-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∫ —Å–∞–º—ã–º —Ä–∞–∑–Ω—ã–º –æ–±—ä—ë–º–∞–º –∏ —Ç–∏–ø–∞–º –≤—Ö–æ–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤.

#### 5. –ë–∞–ª–∞–Ω—Å –æ–±–æ–±—â–µ–Ω–∏—è –∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
   
¬´–ë—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—á–∏—Ç—å –æ–±–æ–±—â—ë–Ω–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–µ–π—Ä–æ–Ω–∞–º–∏, –∞ skip-—Å–≤—è–∑–∏ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–µ–ª–∫–∏–µ –¥–µ—Ç–∞–ª–∏. –≠—Ç–æ—Ç –±–∞–ª–∞–Ω—Å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–∞–∫ —á—Ä–µ–∑–º–µ—Ä–Ω—É—é –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $a^\tau$ –∏ –≤—Å–µ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è CTM.

---

### 8. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **MLP —Ç–∏–ø–∞ U-Net** –≤ CTM ‚Äî —ç—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, –Ω–æ –º–æ—â–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º ¬´—Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–æ–π¬ª –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –º–Ω–æ–≥–æ–º–∞—Å—à—Ç–∞–±–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ, –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏ –≤ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ $[z^\tau, o^\tau]$, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –∏ –≥–∏–±–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á, —Ñ–æ—Ä–º–∏—Ä—É—è –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —ç—Ç–∞–ø–æ–≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è.

</details>

<!-- Checkpoint: üß† U-Net-MLP -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî üß† U-Net-MLP:</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –ö–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—É—Ç—å —É—á–∏—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º, ¬´–±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ¬ª –¥–∞—ë—Ç –æ–±–æ–±—â–µ–Ω–∏–µ, –∞ —Ä–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å —Å skip-—Å–≤—è–∑—è–º–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏; —Ç–∞–∫–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–≥–∞—Ç–æ–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ <em>a<sup>œÑ</sup></em>.
  </p>
</div>

</details>

–ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ç–∏–∫–µ œÑ –±–ª–æ–∫ **Synapse model**

1. **–ü—Ä–∏–Ω–∏–º–∞–µ—Ç** —Å–≤—è–∑–∫—É —Ç–µ–∫—É—â–µ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–æ–≤ $z^{\tau}$ –∏ ¬´–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ¬ª –≤—Ö–æ–¥–∞ –≤–Ω–∏–º–∞–Ω–∏—è $o^{\tau}$;
2. **–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç** –µ—ë —á–µ—Ä–µ–∑ U-Net-MLP c –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ-—Ä–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å–Ω–æ–π —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π –∏ skip-—Å–≤—è–∑—è–º–∏;
3. **–í—ã–¥–∞—ë—Ç** –≤–µ–∫—Ç–æ—Ä –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $a^{\tau}\in\mathbb{R}^{D}$.

–≠—Ç–æ—Ç $a^{\tau}$:

* –∫–æ–¥–∏—Ä—É–µ—Ç *—Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è* –º–µ–∂–¥—É –Ω–µ–π—Ä–æ–Ω–∞–º–∏ –Ω–∞ —à–∞–≥–µ œÑ (—É—á–∏—Ç—ã–≤–∞—è –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –≤ ¬´–±—É—Ç—ã–ª–æ—á–Ω–æ–º –≥–æ—Ä–ª—ã—à–∫–µ¬ª);
* —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **–æ–ø–æ—Ä–Ω–æ–π —Ç–æ—á–∫–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —à–∫–∞–ª—ã –≤—Ä–µ–º–µ–Ω–∏**: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $\{a^{1},a^{2},\dots\}$ –æ–±—Ä–∞–∑—É–µ—Ç –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–π ¬´–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ö—Ä–æ–Ω–æ—Ç–∞–∫—Ç¬ª –º–æ–¥–µ–ª–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∏–ª–∏ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

–¢–æ –µ—Å—Ç—å —Å–∞–º **–≤–µ–∫—Ç–æ—Ä $a^{\tau}$ ‚Äî —ç—Ç–æ ¬´—Å—Ä–µ–∑¬ª —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ —Ç–µ–∫—É—â–µ–º —Ç–∏–∫–µ**; –∞ *–≤—Ä–µ–º–µ–Ω–Ω—É—é –æ—Å—å* —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–º–µ–Ω–Ω–æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Synapse model (œÑ ‚Üí œÑ+1) –≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –±—É—Ñ–µ—Ä–∞–º–∏ History –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤ Neuron-Level Models.

<!-- Checkpoint: Synapse model -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî Synapse model:</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    U-Net-–ø–æ–¥–æ–±–Ω—ã–π MLP –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–≤—è–∑–∫—É –ø—Ä–æ—à–ª—ã—Ö –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–π <em>z<sup>œÑ</sup></em> –∏ –≤—ã—Ö–æ–¥–∞ –≤–Ω–∏–º–∞–Ω–∏—è <em>o<sup>œÑ</sup></em>, –º–Ω–æ–≥–æ–º–∞—Å—à—Ç–∞–±–Ω–æ —Å–∂–∏–º–∞–µ—Ç-—Ä–∞—Å—à–∏—Ä—è–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ skip-—Å–≤—è–∑–∏ –∏ –≤—ã–¥–∞—ë—Ç –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ <em>a<sup>œÑ</sup></em>; –∏–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è ¬´—Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∏–µ¬ª –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —à–∫–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–∏ –º–æ–¥–µ–ª–∏.
  </p>
</div>

<details> 
    <summary><em><strong>2. History (pre-activations)</strong></em></summary>

### **2. History (pre-activations)**

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $d = 1, \dots, D$, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è **–∏—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö $M$** –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π:

$$
A^\tau_d = [\, a^{\tau - M + 1}_d,\; \dots,\; a^{\tau}_d \,] \in \mathbb{R}^M
$$

–∞ –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤:

$$
A^\tau \in \mathbb{R}^{D \times M}
$$

–≠—Ç–æ—Ç –±—É—Ñ–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞–∂–¥–æ–º—É –Ω–µ–π—Ä–æ–Ω—É –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É —Å–≤–æ–µ–≥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —à–∞–≥–∏).

**–ß—Ç–æ —Ç–∞–∫–æ–µ ¬´History (pre-activations)¬ª?**  
1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**  
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $d$ (–≥–¥–µ $d=1,\dots,D$) —Ö—Ä–∞–Ω–∏—Ç—Å—è –±—É—Ñ–µ—Ä –∏–∑ $M$ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –µ–≥–æ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $a_d^\tau$ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —à–∞–≥–∞—Ö –º–æ–¥–µ–ª–∏.  
   - –≠—Ç–æ—Ç –±—É—Ñ–µ—Ä –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–æ–º  
     $$
       A_d^\tau = [\,a_d^{\tau-M+1},\,a_d^{\tau-M+2},\,\dots,\,a_d^\tau] \in \mathbb{R}^M.
     $$  
   - –î–ª—è –≤—Å–µ—Ö $D$ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤–º–µ—Å—Ç–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞  
     $$
       A^\tau = 
       \begin{pmatrix}
         A_1^\tau\\
         A_2^\tau\\
         \vdots\\
         A_D^\tau
       \end{pmatrix}
       \in \mathbb{R}^{D\times M}.
     $$

2. **–ß–∏—Å–ª–æ–≤–æ–π –ø—Ä–∏–º–µ—Ä**
   –ü—É—Å—Ç—å $D=2$ (–¥–≤–∞ –Ω–µ–π—Ä–æ–Ω–∞), $M=3$ (—Ç—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —à–∞–≥–∞). –ù–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —à–∞–≥–∞—Ö $\tau=5$ —É –Ω–∞—Å –º–æ–≥–ª–∏ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏:

   * –ù–µ–π—Ä–æ–Ω 1: 
   - $a\_1^3=0.2$
   - $a\_1^4=-0.1$
   - $a\_1^5=0.5$

   * –ù–µ–π—Ä–æ–Ω 2: 
   - $a\_2^3=1.0$
   - $a\_2^4=0.8$
   - $a\_2^5=0.9$

   –¢–æ–≥–¥–∞

   $$
     A_1^5 = [\,0.2,\,-0.1,\,0.5\,],\quad
     A_2^5 = [\,1.0,\,0.8,\,0.9\,],
   $$

   –∏

   $$
     A^5 = 
     \begin{pmatrix}
       0.2 & -0.1 & 0.5\\
       1.0 &  0.8 & 0.9
     \end{pmatrix}.
   $$

3. **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**

   * –ú–æ–¥–µ–ª—å —É—Ä–æ–≤–Ω—è –Ω–µ–π—Ä–æ–Ω–∞ $g_{\theta_d}$ –ø–æ–ª—É—á–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–µ–µ $a_d^\tau$, –Ω–æ –≤–µ—Å—å –≤–µ–∫—Ç–æ—Ä $A_d^\tau$.
   * –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å **–≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É**: –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ $M$ —à–∞–≥–æ–≤ –≤–ª–∏—è—é—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é $z_d^{,\tau+1}$.
   * –¢–∞–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ CTM.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –±–ª–æ–∫ ¬´History (pre-activations)¬ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —à–∞–≥–æ–≤–æ–≥–æ ¬´—Ä–∞–∑–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ¬ª –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ Continuous Thought Machine.

```python
"""
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π encoder-decoder –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–æ–π 
–ø–µ—Ä–µ–¥–∞—á–∏ —Å–∏–≥–Ω–∞–ª–æ–≤. –ö–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. SynapseModel - –∫–ª–∞—Å—Å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
2. PreActivationHistory - –∫–ª–∞—Å—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–∏

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å 
–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –Ω–µ–π—Ä–æ–Ω–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤.
"""

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
from typing import List, Tuple

# –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏
import torch
import torch.nn as nn


# –ú–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤—è–∑–µ–π
class SynapseModel(nn.Module):
    """
    Description:
    ---------------
        –ú–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π encoder-decoder —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
        –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏. –ú–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ,
        –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ —Å–ª–æ–∏ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
        skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

    Args:
    ---------------
        d_model: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –º–æ–¥–µ–ª–∏
        d_attn: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è
        hidden_dims: –°–ø–∏—Å–æ–∫ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–µ–π —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞

    Returns:
    ---------------
        –û–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏

    Raises:
    ---------------
        ValueError: –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ hidden_dims –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –º–æ–¥–µ–ª–∏

    Examples:
    ---------------
        >>> model = SynapseModel(d_model=2, d_attn=2, hidden_dims=[3, 2])
        >>> z = torch.ones(1, 2)
        >>> o = torch.ones(1, 2)
        >>> output = model(z, o)
    """

    def __init__(
        self,
        d_model: int,
        d_attn: int,
        hidden_dims: List[int] = [3, 2],
    ) -> None:
        super().__init__()
        in_dim = d_model + d_attn
        self.d_model = d_model

        # –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–µ–≤ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ (encoder)
        enc_layers = []
        prev = in_dim
        for i, h in enumerate(hidden_dims, 1):
            enc_layers += [
                nn.Linear(prev, h),
                nn.LayerNorm(h),
                nn.ReLU(inplace=True)
            ]
            prev = h
        self.encoder = nn.ModuleList(enc_layers)

        # –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–µ–≤ –¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ (decoder)
        rev = hidden_dims[::-1]  # –û–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞
        dec_layers = []
        prev = rev[0] * 2        # –†–∞–∑–º–µ—Ä –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏
        for i, h in enumerate(rev[1:], 1):
            dec_layers += [
                nn.Linear(prev, h),
                nn.LayerNorm(h),
                nn.ReLU(inplace=True)
            ]
            # –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º
            prev = h + rev[i]
        dec_layers.append(nn.Linear(prev, d_model))
        self.decoder = nn.ModuleList(dec_layers)

    # –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å
    def forward(
        self,
        z: torch.Tensor,
        o: torch.Tensor
    ) -> torch.Tensor:
        """
        Description:
        ---------------
            –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å, –æ–±—ä–µ–¥–∏–Ω—è—è –≤—Ö–æ–¥–Ω—ã–µ
            —Ç–µ–Ω–∑–æ—Ä—ã z –∏ o, –∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö
            —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –Ω–∞ –∫–∞–∂–¥–æ–º —Å–ª–æ–µ.

        Args:
        ---------------
            z: –í—Ö–æ–¥–Ω–æ–π —Ç–µ–Ω–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏
            o: –í—Ö–æ–¥–Ω–æ–π —Ç–µ–Ω–∑–æ—Ä –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è

        Returns:
        ---------------
            –¢–µ–Ω–∑–æ—Ä –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–∞ –≤—ã—Ö–æ–¥–µ —Å–µ—Ç–∏

        Examples:
        ---------------
            >>> model = SynapseModel(2, 2)
            >>> z = torch.ones(1, 2)
            >>> o = torch.ones(1, 2)
            >>> a = model(z, o)
        """
        # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–µ–Ω–∑–æ—Ä–æ–≤ –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏
        x = torch.cat([z, o], dim=-1)
        print(f"\n=== Step œÑ ===")
        print(f">>> Input x (z||o): {x.tolist()}")

        # –ü—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å–ª–æ–∏ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞
        skips = []  # –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
        cur = x     # –¢–µ–∫—É—â–∏–π —Ç–µ–Ω–∑–æ—Ä
        layer_idx = 0
        for layer in self.encoder:
            cur = layer(cur)
            if isinstance(layer, nn.Linear):
                print(
                    f"  Enc Linear {layer_idx:02d}: shape {tuple(cur.shape)} "
                    f"‚Üí {cur.tolist()}"
                )
            elif isinstance(layer, nn.LayerNorm):
                print(f"  Enc LayerNorm {layer_idx:02d}: ‚Üí {cur.tolist()}")
            elif isinstance(layer, nn.ReLU):
                print(f"  Enc ReLU      {layer_idx:02d}: ‚Üí {cur.tolist()}")
                skips.append(cur)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã—Ö–æ–¥ –ø–æ—Å–ª–µ ReLU –¥–ª—è skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
            layer_idx += 1

        # –ü—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å–ª–æ–∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞
        # –ù–∞—á–∏–Ω–∞–µ–º —Å –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º
        cur = torch.cat([cur, skips[-1]], dim=-1)
        print(f"  Dec Input (with skip[-1]): ‚Üí {cur.tolist()}")

        skip_idx = -2  # –ò–Ω–¥–µ–∫—Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        layer_idx = 0
        for layer in self.decoder:
            cur = layer(cur)
            if isinstance(layer, nn.Linear):
                print(f"  Dec Linear {layer_idx:02d}: ‚Üí {cur.tolist()}")
            elif isinstance(layer, nn.LayerNorm):
                print(f"  Dec LayerNorm {layer_idx:02d}: ‚Üí {cur.tolist()}")
            elif isinstance(layer, nn.ReLU):
                print(f"  Dec ReLU      {layer_idx:02d}: ‚Üí {cur.tolist()}")
                # –î–æ–±–∞–≤–ª—è–µ–º skip-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ
                if skip_idx >= -len(skips):
                    cur = torch.cat([cur, skips[skip_idx]], dim=-1)
                    print(f"    + skip[{skip_idx}]: ‚Üí {cur.tolist()}")
                    skip_idx -= 1
            layer_idx += 1

        a = cur  # –í—ã—Ö–æ–¥–Ω—ã–µ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
        print(f"<<< Output pre-activations a: {a.tolist()}")
        return a


# –ö–ª–∞—Å—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π
class PreActivationHistory(nn.Module):
    """
    Description:
    ---------------
        –ú–æ–¥—É–ª—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.
        –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ M –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞
        –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è —Å–±—Ä–æ—Å–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏.

    Args:
    ---------------
        d_model: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π
        M: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

    Returns:
    ---------------
        –û–±—ä–µ–∫—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π

    Examples:
    ---------------
        >>> history = PreActivationHistory(d_model=2, M=3)
        >>> history.reset(batch_size=1)
        >>> a = torch.tensor([[0.1, 0.2]])
        >>> history.update(a)
    """

    def __init__(self, d_model: int, M: int) -> None:
        super().__init__()
        self.M = M
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏
        buf = torch.zeros(1, d_model, M)
        self.register_buffer('history', buf)

    # –°–±—Ä–æ—Å –±—É—Ñ–µ—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏
    def reset(self, B: int) -> None:
        """
        Description:
        ---------------
            –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –±—É—Ñ–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—è –µ–≥–æ
            –Ω—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–∞—Ç—á–∞.

        Args:
        ---------------
            B: –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞

        Returns:
        ---------------
            None

        Examples:
        ---------------
            >>> history = PreActivationHistory(2, 3)
            >>> history.reset(1)
        """
        self.history = torch.zeros(
            B, *self.history.shape[1:], device=self.history.device
        )
        print(f"\n*** History reset ‚Üí shape {tuple(self.history.shape)}")

    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏
    def update(self, a: torch.Tensor) -> torch.Tensor:
        """
        Description:
        ---------------
            –û–±–Ω–æ–≤–ª—è–µ—Ç –±—É—Ñ–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π, –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            –∏ —É–¥–∞–ª—è—è —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ. –í—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±—É—Ñ–µ—Ä–∞.

        Args:
        ---------------
            a: –¢–µ–Ω–∑–æ—Ä –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é

        Returns:
        ---------------
            –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π

        Examples:
        ---------------
            >>> history = PreActivationHistory(2, 3)
            >>> history.reset(1)
            >>> a = torch.tensor([[0.1, 0.2]])
            >>> updated_history = history.update(a)
        """
        # –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –∏–∑–º–µ–Ω–∏–ª—Å—è, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
        if self.history.size(0) != a.size(0):
            self.reset(a.size(0))
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –±—É—Ñ–µ—Ä, –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —É–¥–∞–ª—è—è —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ
        self.history = torch.cat(
            [self.history[:, :, 1:], a.unsqueeze(-1)], dim=2
        )
        
        # –í—ã–≤–æ–¥ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±—É—Ñ–µ—Ä–∞ –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—Ü—ã
        mat = self.history[0].tolist()
        print(f"*** History buffer (–ø–æ—Å–ª–µ–¥–Ω–∏–µ {self.M} —à–∞–≥–æ–≤):")
        for d, row in enumerate(mat, 1):
            print(f"    Neuron {d}: {row}")
        
        return self.history


# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏
def main() -> None:
    """
    Description:
    ---------------
        –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –º–æ–¥–µ–ª–∏ SynapseModel
        –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π.

    Args:
    ---------------
        None

    Returns:
    ---------------
        None

    Examples:
    ---------------
        >>> main()
    """
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
    torch.manual_seed(0)

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏
    d_model, d_attn, M = 2, 2, 3
    model = SynapseModel(d_model, d_attn, hidden_dims=[3, 2])
    history = PreActivationHistory(d_model, M)

    # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
    B = 1
    history.reset(B)
    
    # –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
    for tau in range(1, 4):
        print(f"\n>>> Internal Step œÑ = {tau}")
        # –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
        z = torch.full((B, d_model), tau, dtype=torch.float32)
        o = torch.full((B, d_attn), tau * 0.1, dtype=torch.float32)
        # –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å
        a = model(z, o)
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥–∞–∫—Ç–∏–≤–∞—Ü–∏–π
        history.update(a)

main()
```

</details>

–ù–∞ —ç—Ç–æ–º —à–∞–≥–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è ¬´–∫—É–± –ø–∞–º—è—Ç–∏¬ª –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö $M$ –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π. –§–æ—Ä–º–∞–ª—å–Ω–æ

$$
A^{\tau}\;=\;\bigl[a^{\tau-M+1},\,a^{\tau-M+2},\,\dots,\,a^{\tau}\bigr]\;\in\;\mathbb R^{D\times M},
\qquad a^{t}\in\mathbb R^{D}.
$$

* **–°—Ç–æ–ª–±—Ü—ã** ‚Äî —ç—Ç–æ —Å–∞–º–∏ ¬´—Å—Ä–µ–∑—ã¬ª —Å–∏–Ω–æ–ø—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è: –∫–∞–∂–¥—ã–π —Å—Ç–æ–ª–±–µ—Ü $a^{t}$ —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ $D$ –Ω–µ–π—Ä–æ–Ω–æ–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç–∏–∫–∞ $t$.
* **–°—Ç—Ä–æ–∫–∏** ‚Äî —ç—Ç–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –æ–¥–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $d$ –¥–ª–∏–Ω–æ–π $M$ —à–∞–≥–æ–≤:

  $$
  A^{\tau}_{d,\: :}\;=\;\bigl[a^{\tau-M+1}_{d},\,\dots,\,a^{\tau}_{d}\bigr].
  $$

–ò–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –Ω–∞–±–æ—Ä $M$ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, $M$ ¬´—Å—Ä–µ–∑–æ–≤¬ª $a^{t}$) –ø–æ–¥–∞—ë—Ç—Å—è –¥–∞–ª–µ–µ –≤ **Neuron-Level Models**, –ø–æ–∑–≤–æ–ª—è—è –∫–∞–∂–¥–æ–º—É –Ω–µ–π—Ä–æ–Ω—É –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É –∏ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞—Å—á—ë—Ç–µ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

<!-- Checkpoint: History (pre-activations) -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî History (pre-activations):</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –ö–∞–∂–¥–æ–º—É –Ω–µ–π—Ä–æ–Ω—É —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ –∏–∑ <em>M</em> –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π <a href="https://example.com">(A<sup>œÑ</sup>)</a>, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –º–æ–¥–µ–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–µ –∏ —Å–æ–∑–¥–∞–≤–∞—è –æ—Å–Ω–æ–≤—É –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ Neuron-Level Models.
  </p>
</div>

<details> 
    <summary><em><strong>3. Neuron-Level Models</strong></em></summary>

### **3. Neuron-Level Models**

–ö–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω $d$ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é $g_{\theta_d}$, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–≥–æ –∏—Å—Ç–æ—Ä–∏—é $A^\tau_d$ –≤ –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—é:

$$
z^{\tau+1}_d = g_{\theta_d}(A^\tau_d)
$$

–ó–¥–µ—Å—å $g_{\theta_d}$ ‚Äî —ç—Ç–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π MLP –Ω–µ–π—Ä–æ–Ω–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–π $M$-–¥–ª–∏–Ω—É –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–Ω –º–æ–∂–µ—Ç –≤—ã—É—á–∏—Ç—å —à–∞–±–ª–æ–Ω: ¬´–µ—Å–ª–∏ –Ω–µ–π—Ä–æ–Ω –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω 3 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥ ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–π—Å—è —Å–Ω–æ–≤–∞¬ª. –≠—Ç–æ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫ **—Å–ø–∞–π–∫–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤.

#### **–ü—Ä–∏–º–µ—Ä**

–ß—Ç–æ–±—ã –ø—Ä–æ–∏–ª–ª—é—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Ñ—É–Ω–∫—Ü–∏–∏ $g_{\theta_d}$, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å–ª—É—á–∞–π —Å –æ–¥–Ω–∏–º ¬´Neuron-Level Model¬ª ‚Äì –æ–¥–Ω–æ—Å–ª–æ–π–Ω—ã–º MLP, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–º –∏—Å—Ç–æ—Ä–∏—é –¥–ª–∏–Ω—ã $M=3$.

–î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $d$ –º–æ–¥–µ–ª—å

$$
z_d^{\tau+1} = g_{\theta_d}\bigl(A_d^\tau\bigr),
$$

–≥–¥–µ

$$
A_d^\tau = \bigl[a_d^{\tau-2},\,a_d^{\tau-1},\,a_d^{\tau}\bigr]^\top\in\mathbb R^3.
$$

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã MLP

–ü—É—Å—Ç—å $g_{\theta_d}$ ‚Äî –¥–≤—É—Ö—Å–ª–æ–π–Ω—ã–π MLP —Å –æ–¥–Ω–æ–π —Å–∫—Ä—ã—Ç–æ–π –µ–¥–∏–Ω–∏—Ü–µ–π –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π ReLU:

$$
\begin{aligned}
h &= \mathrm{ReLU}\bigl(W^{(1)}\,A_d^\tau + b^{(1)}\bigr),\quad
W^{(1)}\in\mathbb R^{1\times3},\;b^{(1)}\in\mathbb R,\\
z_d^{\tau+1} &= W^{(2)}\,h + b^{(2)},\quad
W^{(2)}\in\mathbb R^{1\times1},\;b^{(2)}\in\mathbb R.
\end{aligned}
$$

–í–æ–∑—å–º—ë–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —á–∏—Å–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

$$
W^{(1)} = \begin{pmatrix}0.4 & -0.3 & 0.5\end{pmatrix},\quad
b^{(1)} = 0.1;\qquad
W^{(2)}=1.2,\quad
b^{(2)}=-0.05.
$$

#### –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –Ω–∞ —Ç—Ä—ë—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —à–∞–≥–∞—Ö $\tau$ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–∞ $d$ –±—ã–ª–∏:

$$
a_d^{\tau-2} = 0.2,\quad
a_d^{\tau-1} = -0.1,\quad
a_d^{\tau}   = 0.5.
$$

–¢–æ–≥–¥–∞

$$
A_d^\tau = \begin{pmatrix}0.2\\-0.1\\0.5\end{pmatrix}.
$$

#### –ü–æ—ç—Ç–∞–ø–Ω—ã–π —Ä–∞—Å—á—ë—Ç

1. **–õ–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ + —Å–º–µ—â–µ–Ω–∏–µ (–ø–µ—Ä–≤—ã–π —Å–ª–æ–π):**

   $$
   u = W^{(1)}\,A_d^\tau + b^{(1)}
     = [\,0.4,\,-0.3,\;0.5\,]\;\begin{pmatrix}0.2\\-0.1\\0.5\end{pmatrix}
     + 0.1
     = (0.08 + 0.03 + 0.25) + 0.1
     = 0.46.
   $$

2. **ReLU-–∞–∫—Ç–∏–≤–∞—Ü–∏—è:**

   $$
   h = \mathrm{ReLU}(u) = \max(0,\,0.46) = 0.46.
   $$

3. **–í—ã—Ö–æ–¥ –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–æ—è:**

   $$
   z_d^{\tau+1} = W^{(2)}\,h + b^{(2)}
                = 1.2 \times 0.46 - 0.05
                = 0.552 - 0.05
                = 0.502.
   $$

#### –ü–æ—è—Å–Ω–µ–Ω–∏–µ

* **–ü–µ—Ä–≤—ã–π —Å–ª–æ–π** ¬´—Å–≤—ë—Ä—Ç—ã–≤–∞–µ—Ç¬ª —Ç—Ä—ë—Ö—à–∞–≥–æ–≤—É—é –∏—Å—Ç–æ—Ä–∏—é $A_d^\tau$ –≤ –æ–¥–Ω–æ —á–∏—Å–ª–æ $u$, –≤–∑–≤–µ—à–∏–≤–∞—è –ø—Ä–æ—à–ª—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ (–≤–µ—Å–∞ $W^{(1)}$) –∏ –ø—Ä–∏–±–∞–≤–ª—è—è —Å–º–µ—â–µ–Ω–∏–µ $b^{(1)}$.
* **ReLU** –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ¬´—à—É–º–∏—Ö–∏¬ª –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–∑–¥–µ—Å—å $u>0$).
* **–í—Ç–æ—Ä–æ–π —Å–ª–æ–π** –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ $h$ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ $b^{(2)}$, –≤—ã–¥–∞–≤–∞—è –Ω–æ–≤—É—é –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—é $z_d^{\tau+1}$.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–∞–∂–µ –≤ —Ç–∞–∫–æ–º –ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ MLP –Ω–∞ —É—Ä–æ–≤–Ω–µ –Ω–µ–π—Ä–æ–Ω–∞ —É–º–µ–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—à–ª—ã—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏–π –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Ö–æ–¥ —Å —É—á—ë—Ç–æ–º –≤—ã—É—á–µ–Ω–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤.

</details>

–ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ç–∏–∫–µ $\tau$ –±–ª–æ–∫ **Neuron-Level Models (NLM)**

1. **–ü–æ–ª—É—á–∞–µ—Ç** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $d$ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏—Å—Ç–æ—Ä–∏–∏
   $A^{\tau}_{d}=[\,a^{\tau-M+1}_{d},\dots ,a^{\tau}_{d}] \in\mathbb R^{M}$.
2. **–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç** —ç—Ç–æ—Ç $M$-–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä —á–µ—Ä–µ–∑ –∫—Ä–æ—à–µ—á–Ω—ã–π MLP
   $g_{\theta_d}\!=\!\text{(Linear ‚Üí Act ‚Üí Linear)}$ ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞.
3. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç** –Ω–æ–≤—É—é –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—é

   $$
     z^{\tau+1}_{d}=g_{\theta_d}\bigl(A^{\tau}_{d}\bigr)\in\mathbb R,
     \qquad
     z^{\tau+1}=[z^{\tau+1}_{1},\dots ,z^{\tau+1}_{D}]\in\mathbb R^{D}.
   $$

–≠—Ç–∏ $z^{\tau+1}_{d}$:

* —Ä–µ–∞–ª–∏–∑—É—é—Ç **–≤—Ä–µ–º–µ–Ω–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é**: –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω —Ä–µ—à–∞–µ—Ç, ¬´—Å–ø–∞–π–∫–Ω—É—Ç—å¬ª –ª–∏ —Å–µ–π—á–∞—Å, –≥–ª—è–¥—è –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–µ–¥–∞–≤–Ω–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π (–∞–Ω–∞–ª–æ–≥ STDP);
* –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç ¬´–∫—É–± –ø–∞–º—è—Ç–∏¬ª $A^{\tau}$ –≤ –æ—á–µ—Ä–µ–¥–Ω–æ–π **—Å—Ä–µ–∑ –¥–∏–Ω–∞–º–∏–∫–∏** $z^{\tau+1}$, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º —É—á–∞—Å—Ç–≤—É–µ—Ç
  ‚Äì –≤ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ $Z^{\tau+1}=[z^{1},\dots ,z^{\tau+1}]$ –∏
  ‚Äì –≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –º–∞—Ç—Ä–∏—Ü—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ $S^{\tau+1}=Z^{\tau+1}(Z^{\tau+1})^{\!\top}$.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **NLM-–±–ª–æ–∫ –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π ¬´–≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–µ—Ç–µ–∫—Ç–æ—Ä¬ª**: –æ–Ω –∫–æ–¥–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ –≤ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø–æ–∑–≤–æ–ª—è—è —Å–µ—Ç–∏ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏ –ø—Ä–æ–¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —à–∫–∞–ª–µ –≤—Ä–µ–º–µ–Ω–∏.

<!-- Checkpoint: Neuron-Level Models -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî Neuron-Level Models:</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π MLP <em>g<sub>Œ∏d</sub></em> —á–∏—Ç–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é <A<sub>d</sub><sup>œÑ</sup></A> –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –µ–≥–æ –Ω–æ–≤—É—é –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—é <em>z<sub>d</sub><sup>œÑ+1</sup></em>, –æ–±—É—á–∞—è—Å—å –≤—ã—è–≤–ª—è—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (–∞–Ω–∞–ª–æ–≥ STDP) –∏ –ø—Ä–µ–≤—Ä–∞—â–∞—è ¬´—Å—ã—Ä—ã–µ¬ª —Å–∏–≥–Ω–∞–ª—ã –≤ –¥–∏–Ω–∞–º–∏–∫—É, –ø—Ä–∏–≥–æ–¥–Ω—É—é –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
  </p>
</div>

### **4. Post-activations**

–ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ç–∏–∫–µ $\tau{+}1$ –±–ª–æ–∫ **Post-activations**

1. **–°–æ–±–∏—Ä–∞–µ—Ç** –≤—ã—Ö–æ–¥—ã Neuron-Level Models –≤ –µ–¥–∏–Ω—ã–π –≤–µ–∫—Ç–æ—Ä

   $$
     z^{\tau+1}=\bigl[z^{\tau+1}_{1},\dots ,z^{\tau+1}_{D}\bigr]\in\mathbb R^{D}.
   $$
2. **–§–∏–∫—Å–∏—Ä—É–µ—Ç** —ç—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä –∫–∞–∫ ¬´–º–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–Ω–∏–º–æ–∫¬ª *–Ω–µ–π—Ä–æ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è* —Å–µ—Ç–∏: –æ–Ω –æ—Ç—Ä–∞–∂–∞–µ—Ç, –∫–∞–∫–∏–µ –Ω–µ–π—Ä–æ–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø–æ—Å–ª–µ —É—á—ë—Ç–∞ —Å–≤–æ–µ–π –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏.
3. **–ü–µ—Ä–µ–¥–∞—ë—Ç** $z^{\tau+1}$ –¥–∞–ª—å—à–µ –ø–æ –∫–æ–Ω–≤–µ–π–µ—Ä—É:

   * –≤ –º–∞—Ç—Ä–∏—Ü—É –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç–∏ $Z$ (—Å–º. —Ä–∏—Å—É–Ω–æ–∫);
   * –≤ —Ä–∞—Å—á—ë—Ç –º–∞—Ç—Ä–∏—Ü—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ $S^{\tau+1}=Z^{\tau+1}(Z^{\tau+1})^{\!\top}$;
   * –æ–±—Ä–∞—Ç–Ω–æ –≤ **Synapse model** –≤–º–µ—Å—Ç–µ —Å –Ω–æ–≤—ã–º –≤–µ–∫—Ç–æ—Ä–æ–º –≤–Ω–∏–º–∞–Ω–∏—è $o^{\tau+1}$, –∑–∞–º—ã–∫–∞—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ü–∏–∫–ª.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º **$z^{\tau+1}$ ‚Äî —ç—Ç–æ ¬´—Å—Ä–µ–∑¬ª –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** –≤—Å–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤, —Å–ª—É–∂–∞—â–∏–π —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º –±–ª–æ–∫–æ–º –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –≤—ã–≤–æ–¥–æ–≤ –º–æ–¥–µ–ª–∏.

–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤—ã—Ö–æ–¥—ã –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –Ω–∞ —à–∞–≥–µ $\tau+1$ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç:

$$
z^{\tau+1} = [z^{\tau+1}_1, z^{\tau+1}_2, \dots, z^{\tau+1}_D] \in \mathbb{R}^D
$$

–≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä ‚Äî **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–¥–µ–ª–∏**, —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É—é—â–µ–µ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.

<!-- Checkpoint: Post-activations -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî Post-activations:</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –í–µ–∫—Ç–æ—Ä <em>z<sup>œÑ+1</sup></em> —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤—ã–µ –≤—ã—Ö–æ–¥—ã –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –ø–æ—Å–ª–µ –∏—Ö ¬´–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏¬ª; –≠—Ç–æ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å–Ω–∏–º–æ–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –∏–¥—ë—Ç –≤ –ø–∞–º—è—Ç—å <em>Z</em> –∏ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —Ä–∞—Å—á—ë—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏.
  </p>
</div>

### **5. History (post-activations)**

–ù–∞ —à–∞–≥–µ **History (post-activations)**

1. **–†–∞—Å—à–∏—Ä—è–µ—Ç** –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –ø–∞–º—è—Ç–∏, –¥–æ–ø–∏—Å—ã–≤–∞—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü:

   $$
     Z^{\tau+1}= \bigl[\,z^{1},\,z^{2},\,\dots ,\,z^{\tau+1}\bigr]\in\mathbb R^{D\times(\tau+1)}.
   $$
2. **–•—Ä–∞–Ω–∏—Ç** –ø–æ–ª–Ω—É—é —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–µ—Ç–∏: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞, –∫–∞–∂–¥—ã–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî ¬´–∫–∞–¥—Ä¬ª –≤—Å–µ–π —Å–µ—Ç–∏.
3. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –¥–≤—É–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏:

   * –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ $S^{\tau+1}$;
   * –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ / –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏ –ª–∏–º–∏—Ç —Ç–∏–∫–æ–≤).

–ò–º–µ–Ω–Ω–æ –º–∞—Ç—Ä–∏—Ü–∞ $Z$ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö ¬´—Å—Ä–µ–∑–æ–≤¬ª $z^{t}$ –≤ **–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é –ª–µ–Ω—Ç—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –≤—ã—è–≤–ª—è—Ç—å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ-–ø–∞—Ç—Ç–µ—Ä–Ω—ã.

<!-- Checkpoint: History (post-activations) -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî History (post-activations):</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –ú–∞—Ç—Ä–∏—Ü–∞ <em>Z<sup>œÑ+1</sup></em> –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –≤—Å–µ –≤–µ–∫—Ç–æ—Ä—ã <em>z</em> —Å –Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è, —Ñ–æ—Ä–º–∏—Ä—É—è ¬´–ª–µ–Ω—Ç—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏¬ª —Å–µ—Ç–∏; –∏–º–µ–Ω–Ω–æ –æ–Ω–∞ –ø–∏—Ç–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ <em>S</em> –∏ —Å–ª—É–∂–∏—Ç –±–∞–∑–æ–π –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ç–∏–∫–æ–≤.
  </p>
</div>

### **6. Synchronization matrix $S^{\tau+1}$**

–ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Ç–∏–∫–µ $\tau{+}1$ –±–ª–æ–∫ **Synchronization matrix**

1. **–ë–µ—Ä—ë—Ç** –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é –ª–µ–Ω—Ç—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ $Z^{\tau+1}\in\mathbb R^{D\times(\tau+1)}$.
2. **–£–º–Ω–æ–∂–∞–µ—Ç** –µ—ë –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–æ–ø–∏—é

   $$
     S^{\tau+1}=Z^{\tau+1}(Z^{\tau+1})^{\!\top}\in\mathbb R^{D\times D},
   $$

   –ø–æ–ª—É—á–∞—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –ø–æ–ø–∞—Ä–Ω—ã—Ö —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π.
3. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç** —ç–ª–µ–º–µ–Ω—Ç $S^{\tau+1}_{ij}$ –∫–∞–∫ –º–µ—Ä—É —Å—Ö–æ–¥—Å—Ç–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –Ω–µ–π—Ä–æ–Ω–æ–≤ $i$ –∏ $j$:

   * –≤–µ–ª–∏—á–∏–Ω–∞ $\kern0.1em\uparrow$ ‚Äî –Ω–µ–π—Ä–æ–Ω—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ;
   * –≤–µ–ª–∏—á–∏–Ω–∞ $\kern0.1em\downarrow$ ‚Äî –∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã.
4. **–ü–æ–¥–∞—ë—Ç** $S^{\tau+1}$ –≤ –º–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞ –ø–∞—Ä, –∞ —Ç–∞–∫–∂–µ (–ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏) –ø–æ–¥–≤–µ—Ä–≥–∞–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É –∑–∞—Ç—É—Ö–∞–Ω–∏—é –∏–ª–∏ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–µ, —á—Ç–æ–±—ã –Ω–µ–¥–∞–≤–Ω–∏–µ ¬´–∫–∞–¥—Ä—ã¬ª –≤–µ—Å–∏–ª–∏ –±–æ–ª—å—à–µ –¥–∞–ª—ë–∫–∏—Ö.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º **$S^{\tau+1}$ –∫–æ–Ω–¥–µ–Ω—Å–∏—Ä—É–µ—Ç –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É** –≤ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –¥–∞–ª–µ–µ —Å—Ç—Ä–æ—è—Ç—Å—è –≤—ã–≤–æ–¥ –∏ —É–ø—Ä–∞–≤–ª—è—é—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã –≤–Ω–∏–º–∞–Ω–∏—è.

<!-- Checkpoint: Synchronization matrix -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî Synchronization matrix:</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –ú–∞—Ç—Ä–∏—Ü–∞ <em>S<sup>œÑ+1</sup></em> = <em>Z</em><sup>œÑ+1</sup>(<em>Z</em><sup>œÑ+1</sup>)<sup>T</sup> —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤. –í—ã—Å–æ–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî —Å–∏–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∏–π ‚Äî —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ. –≠—Ç–æ –±–∞–∑–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ ¬´–∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞–∑—É–º–∞¬ª —Å–µ—Ç–∏.
  </p>
</div>

### **7. Selected neuron pairs**

–ù–∞ —à–∞–≥–µ **Selected neuron pairs**

1. **–í—ã–±–∏—Ä–∞–µ—Ç** –¥–≤–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–Ω–∞–±–æ—Ä–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

   $$
     \mathcal I_{\text{out}},\,\mathcal I_{\text{action}}\subset\bigl\{(i,j)\,|\,0\!\le i\!<\!j\!<\!D\bigr\},
   $$

   –∑–∞–¥–∞–Ω–Ω—ã—Ö –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å–ª—É—á–∞–π–Ω—ã–π –∏–ª–∏ top-k —Ä–µ–∂–∏–º).
2. **–ò–∑–≤–ª–µ–∫–∞–µ—Ç** –ø–æ —ç—Ç–∏–º –∏–Ω–¥–µ–∫—Å–∞–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏, —Ñ–æ—Ä–º–∏—Ä—É—è –¥–≤–∞ –≤–µ–∫—Ç–æ—Ä–∞:

   $$
     S^{\tau+1}_{\text{out}}\in\mathbb R^{D_{\text{out}}},\qquad
     S^{\tau+1}_{\text{action}}\in\mathbb R^{D_{\text{action}}}.
   $$
3. **–ü–µ—Ä–µ–¥–∞—ë—Ç**

   * $S^{\tau+1}_{\text{out}}$ ‚Üí –ª–∏–Ω–µ–π–Ω—ã–π –ø—Ä–æ–µ–∫—Ç–æ—Ä $W_{\text{out}}$ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (–ª–æ–≥–∏—Ç—ã –∫–ª–∞—Å—Å–æ–≤ / —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞);
   * $S^{\tau+1}_{\text{action}}$ ‚Üí –ø—Ä–æ–µ–∫—Ç–æ—Ä $W_{\text{in}}$ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è $q^{\tau+1}$.
4. **–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç** —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π: –æ–¥–Ω–∞ –ø–æ–¥–≤—ã–±–æ—Ä–∫–∞ —É—á–∏—Ç ¬´—á—Ç–æ —Å–∫–∞–∑–∞—Ç—å¬ª, –¥—Ä—É–≥–∞—è ‚Äî ¬´–∫—É–¥–∞ —Å–º–æ—Ç—Ä–µ—Ç—å¬ª –≤ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—è –º–æ–¥–µ–ª—å –ø–æ–ª–Ω—ã–º $D^2$ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–≤—è–∑–µ–π.

–ò–Ω–∞—á–µ –≥–æ–≤–æ—Ä—è, **–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $S$ —Å–≤–µ—Ä—à–∞–µ—Ç—Å—è –≤ –¥–≤–∞ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–∞**, –∫–æ—Ç–æ—Ä—ã–µ –ø–∏—Ç–∞—é—Ç –≤—ã–≤–æ–¥ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ, –¥–µ–ª–∞—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–º–∏.

<!-- Checkpoint: Selected neuron pairs -->
<div style="border: 2px solid #3498db; border-radius: 8px; padding: 12px; background-color: #f8f9fa; margin: 10px 0;">
  <p style="margin: 0; font-weight: bold; color: #2c3e50;">Checkpoint ‚Äî Selected neuron pairs:</p>
  <p style="margin: 8px 0 0 0; color: #2c3e50;">
    –ò–∑ <em>S</em> –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –¥–≤–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –ø–æ–¥–Ω–∞–±–æ—Ä–∞ –ø–∞—Ä –Ω–µ–π—Ä–æ–Ω–æ–≤: –æ–¥–∏–Ω (<em>I</em><sub>out</sub>) –∏–¥—ë—Ç –≤ –≤—ã–≤–æ–¥, –≤—Ç–æ—Ä–æ–π (<em>I</em><sub>action</sub>) ‚Äî –≤ –∑–∞–ø—Ä–æ—Å –≤–Ω–∏–º–∞–Ω–∏—è. –ò—Ç–æ–≥–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã <em>S<sub>out</sub></em> –∏ <em>S<sub>action</sub></em> –∫–æ–º–ø–∞–∫—Ç–Ω–æ –∫–æ–¥–∏—Ä—É—é—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–≤—è–∑–∏, –æ—Ç—á–µ–≥–æ –º–æ–¥–µ–ª—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ, –∞ –Ω–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ –ø–æ —á–∏—Å–ª—É –Ω–µ–π—Ä–æ–Ω–æ–≤.
  </p>
</div>

### **8. Latent representation**

–ù–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–∞—Ä:

* $S^{\tau+1}_{\text{out}}$ —Å–ª—É–∂–∏—Ç –∫–∞–∫ **–≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è;
* $S^{\tau+1}_{\text{action}}$ ‚Äî –∫–∞–∫ **–≤–µ–∫—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è**.

–û–±–∞ –≤–µ–∫—Ç–æ—Ä–∞ —è–≤–ª—è—é—Ç—Å—è –Ω–∏–∑–∫–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–º–∏ —Å–∂–∞—Ç—ã–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏ **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –¥–∏–Ω–∞–º–∏–∫–∏** —Å–µ—Ç–∏.

### **9. OUT/ATTN projections**

–î–≤–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–ª–æ—è:

* –î–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞:

  $$
  y^{\tau+1} = W_{\text{out}} \cdot S^{\tau+1}_{\text{out}} \in \mathbb{R}^{V}
  $$

  –≥–¥–µ $V$ ‚Äî —Ä–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è —Ç–æ–∫–µ–Ω–æ–≤;

* –î–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∫ –≤–Ω–∏–º–∞–Ω–∏—é:

  $$
  q^{\tau+1} = W_{\text{in}} \cdot S^{\tau+1}_{\text{action}} \in \mathbb{R}^{d_{\text{attn}}}
  $$

### **10. Data modulation (Attention output)**

–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è **–≤–Ω–∏–º–∞–Ω–∏–µ** –∫ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ $F(x) \in \mathbb{R}^{t \times d_{\text{attn}}}$ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º $q^{\tau+1}$ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å–∞:

$$
o^{\tau+1} = \text{Attention}(q^{\tau+1}, K = F(x), V = F(x)) \in \mathbb{R}^{d_{\text{attn}}}
$$

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è dot-product attention:

$$
\text{Attention}(q, K, V) = \text{softmax}\left( \frac{qK^\top}{\sqrt{d}} \right) V
$$

–í–µ–∫—Ç–æ—Ä $o^{\tau+1}$ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å $z^{\tau+1}$ –∏ –ø–æ–¥–∞—ë—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–∏–∫ $\tau+2$, —Ñ–æ—Ä–º–∏—Ä—É—è –≤—Ö–æ–¥ –≤ —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫—É—é –º–æ–¥–µ–ª—å:

$$
[z^{\tau+1}, o^{\tau+1}] \longrightarrow f_{\theta_{\text{syn}}}
$$

### **–û–±—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ —à–∞–≥–µ $\tau$:**

1. $z^\tau, o^\tau \rightarrow a^\tau$ —á–µ—Ä–µ–∑ —Å–∏–Ω–∞–ø—Å
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ $A^\tau$
3. $A^\tau_d \rightarrow z_d^{\tau+1}$ —á–µ—Ä–µ–∑ NLM
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ $Z^{\tau+1}$
5. $Z^{\tau+1} \rightarrow S^{\tau+1}$
6. $S^{\tau+1} \rightarrow S_{\text{out}}, S_{\text{action}}$
7. $S_{\text{out}} \rightarrow y^{\tau+1}$, $S_{\text{action}} \rightarrow q^{\tau+1}$
8. $q^{\tau+1} \rightarrow o^{\tau+1}$
9. –ü–æ–¥–∞—ë–º $[z^{\tau+1}, o^{\tau+1}]$ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç–∏–∫.

#### **–ü—Ä–∏–º–µ—Ä:**

–î–æ–ø—É—Å—Ç–∏–º, CTM —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ —Ç–µ–∫—Å—Ç–æ–º:

```
"Albert Einstein was a ..."
```

#### –≠—Ç–∞–ø—ã:

* $x = (\text{‚ÄúAlbert‚Äù}, \text{‚ÄúEinstein‚Äù}, \text{‚Äúwas‚Äù}, \text{‚Äúa‚Äù})$
* –ó–∞–¥–∞—á–∞: –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω $x_5$ (–æ–∂–∏–¥–∞–µ—Ç—Å—è ‚Äúphysicist‚Äù)
* –ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —à–∞–≥–µ $\tau$, CTM –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–æ–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –Ω–µ–π—Ä–æ–Ω–æ–≤.
* –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ $\tau=1$: $z^1$ ‚Äì —Å–ª—É—á–∞–π–Ω—ã, $S^1$ ‚Äì –ø–æ—á—Ç–∏ –Ω—É–ª–µ–≤–∞—è.
* –ö $\tau=5$: –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è, –ø–∞—Ä—ã –Ω–µ–π—Ä–æ–Ω–æ–≤, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∫ —à–∞–±–ª–æ–Ω–∞–º ‚Äú–ø–µ—Ä—Å–æ–Ω–∞ ‚Üí –ø—Ä–æ—Ñ–µ—Å—Å–∏—è‚Äù, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è.
* $y^5 = \text{softmax}(W_{\text{out}} \cdot S^5_{\text{out}})$ ‚Äî —É–∂–µ —Å –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ ‚Äúphysicist‚Äù.
* –ï—Å–ª–∏ $C^5 = 0.95$, –∞ –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ $\tau = 0.9$, –º–æ–¥–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ü–∏–∫–ª.

---

### **4. –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ –≤—Ä–µ–º—è –∏ —Å–∏–Ω–∞–ø—Å—ã**

CTM –≤–≤–æ–¥–∏—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –≤—Ä–µ–º—è, –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ —à–∞–≥–∏, –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Ç–∏–∫–∞–º–∏** (*internal ticks*). –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–∏–∫ ‚Äì —ç—Ç–æ —à–∞–≥ ¬´–º—ã—Å–ª–∏¬ª –º–æ–¥–µ–ª–∏, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ–∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –¥–∞–∂–µ –µ—Å–ª–∏ –≤–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–Ω—ã. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **CTM —É–º–µ–µ—Ç –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–∞—Ç—å —Å–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º–µ–Ω–∏**, –ø—Ä–∏–±–ª–∏–∂–∞—è –ø—Ä–æ—Ü–µ—Å—Å –º—ã—à–ª–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –º–æ–∑–≥ –æ–±–¥—É–º—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É. –ï—Å–ª–∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç), –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ç–∏–∫–∏ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—è –º–æ–¥–µ–ª–∏ —Ä–∞—Å—Å—É–∂–¥–∞—Ç—å –¥–æ–ª—å—à–µ, —á–µ–º –¥–ª–∏–Ω–∞ –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ù–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —à–∞–≥–µ $t$ –≤—Å–µ –Ω–µ–π—Ä–æ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç —Å–≤–æ–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–µ—Ä–µ–∑ –æ–±—â–∏–π **—Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å**. –°–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å ‚Äì —ç—Ç–æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Å–µ–ø—Ç—Ä–æ–Ω (MLP), —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ —Ç–∏–ø—É U-Net (—Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏). –û–Ω –≤—ã—á–∏—Å–ª—è–µ—Ç **–ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏** ($a^t$) –≤—Å–µ—Ö $D$ –Ω–µ–π—Ä–æ–Ω–æ–≤ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ, –∏—Å—Ö–æ–¥—è –∏–∑ —Ç–µ–∫—É—â–∏—Ö –∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–µ–π—Ä–æ–Ω–æ–≤ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –§–æ—Ä–º–∞–ª—å–Ω–æ, —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å $f_{\theta_{\text{syn}}}$ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –≤–µ–∫—Ç–æ—Ä–∞ —Ç–µ–∫—É—â–∏—Ö –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–π $z^t \in \mathbb{R}^D$ –∏ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ $o^t$ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ –¥–∞–Ω–Ω—ã–µ, –ø–æ–¥—Ä–æ–±–Ω–µ–µ –Ω–∏–∂–µ), –∏ –≤—ã–¥–∞—ë—Ç –Ω–æ–≤—ã–π –≤–µ–∫—Ç–æ—Ä –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π:

$$
a^t \;=\; f_{\theta_{\text{syn}}}\!\Big(\big[z^t,\, o^t\big]\Big)\;\in\;\mathbb{R}^D\,,
$$

–≥–¥–µ $[z^t, o^t]$ –æ–∑–Ω–∞—á–∞–µ—Ç –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –¥–≤—É—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤. –í–µ–∫—Ç–æ—Ä $a^t = (a^t_1, \dots, a^t_D)$ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ $D$ –Ω–µ–π—Ä–æ–Ω–æ–≤. –≠—Ç–æ—Ç —à–∞–≥ –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤ —á–µ—Ä–µ–∑ —Å–∏–Ω–∞–ø—Å—ã –æ—Ç –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É: $f_{\theta_{\text{syn}}}$ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –º–µ–∂–Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è –≤—Å–µ–≥–æ —Å–ª–æ—è –Ω–µ–π—Ä–æ–Ω–æ–≤ (–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã $\theta_{\text{syn}}$ –æ–±—â–∏–µ –¥–ª—è –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ —Å–ª–æ—è). –ë–ª–∞–≥–æ–¥–∞—Ä—è U-Net –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∏–π MLP —Å–æ—á–µ—Ç–∞–µ—Ç –≥–ª—É–±–æ–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–ø—É—Å–∫–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏ –æ—Ö–≤–∞—Ç —Ä–∞–∑–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –º–µ–∂–¥—É –Ω–µ–π—Ä–æ–Ω–∞–º–∏.

–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ $a^t$ —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π **–∏—Å—Ç–æ—Ä–∏–∏ –≤—Ö–æ–¥–æ–≤ –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞**. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $d$ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –æ–∫–Ω–æ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö $M$ –∑–Ω–∞—á–µ–Ω–∏–π –µ–≥–æ –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–π:

$$
A^t_d \;=\; [\,a^{t-M+1}_d,\; a^{t-M+2}_d,\; \dots,\; a^t_d\,] \;\in\; \mathbb{R}^{M}\,
$$

–∞ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å —Ç–∞–∫–∏—Ö –æ–∫–æ–Ω –¥–ª—è –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –æ–±—Ä–∞–∑—É–µ—Ç –º–∞—Ç—Ä–∏—Ü—É $A^t \in \mathbb{R}^{D\times M}$. –ó–¥–µ—Å—å –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —à–∞–≥–æ–≤, –∫–æ–≥–¥–∞ –∏—Å—Ç–æ—Ä–∏–∏ –µ—â—ë –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω—É–ª—è–º–∏ –∏–ª–∏ –Ω–∞—á–∞–ª–æ –∏—Å—Ç–æ—Ä–∏–∏ –Ω–µ–ø–æ–ª–Ω–æ–µ (–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–æ –∫–∞–∫ –∫–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä –¥–ª–∏–Ω—ã $M$ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã). –≠—Ç–∞ –∏—Å—Ç–æ—Ä–∏—è $A^t$ —Å–ª—É–∂–∏—Ç –≤—Ö–æ–¥–æ–º –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–µ–π—Ä–æ–Ω–æ–≤, –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–∞–ª–µ–µ. –ü–∞—Ä–∞–º–µ—Ç—Ä $M$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–∞–ª–µ–∫–æ –≤ –ø—Ä–æ—à–ª–æ–µ ‚Äú–ø–æ–º–Ω–∏—Ç‚Äù –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω ‚Äì –¥–ª–∏–Ω—É –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –≤–ª–∏—è—é—â–µ–≥–æ –Ω–∞ –µ–≥–æ —Ç–µ–∫—É—â—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é.

### **5. –ú–æ–¥–µ–ª–∏ —É—Ä–æ–≤–Ω—è –Ω–µ–π—Ä–æ–Ω–∞ –∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–π —Ç–∞–π–º–∏–Ω–≥**

–ì–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ CTM ‚Äì —É –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ –µ—Å—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è **–Ω–µ–π—Ä–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (NLM)**, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –µ–≥–æ –≤—ã—Ö–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –µ–≥–æ –≤—Ö–æ–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤. –í —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–µ—Ç—è—Ö —Ä–æ–ª—å —Ç–∞–∫–æ–π –º–æ–¥–µ–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (ReLU, —Å–∏–≥–º–æ–∏–¥–∞ –∏ —Ç.–ø.), –∑–∞–≤–∏—Å—è—â–∞—è –ª–∏—à—å –æ—Ç —Ç–µ–∫—É—â–µ–π –ø—Ä–µ-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏. –í CTM –≤–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—É—á–∞–µ–º—ã–π *–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π MLP –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞*.

–î–ª—è $d$-–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ –æ–±–æ–∑–Ω–∞—á–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –µ–≥–æ –º–æ–¥–µ–ª–∏ –∫–∞–∫ $\theta_d$. –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ $t$ –º–æ–¥–µ–ª—å $d$-–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ $g_{\theta_d}$ –±–µ—Ä—ë—Ç —Å–≤–æ–π –≤–µ–∫—Ç–æ—Ä –∏—Å—Ç–æ—Ä–∏–∏ –≤—Ö–æ–¥–æ–≤ $A^t_d \in \mathbb{R}^M$ –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç **–ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏—é** (—Ç.–µ. –∏—Ç–æ–≥–æ–≤—É—é –∞–∫—Ç–∏–≤–∞—Ü–∏—é –Ω–µ–π—Ä–æ–Ω–∞) –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ $t+1$:

$$
z_d^{t+1} \;=\; g_{\theta_d}\!\big(A^t_d\big)\,,
$$

–≥–¥–µ $z_d^{t+1}$ ‚Äì —Å–∫–∞–ª—è—Ä (–∞–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ–π—Ä–æ–Ω–∞ $d$ –Ω–∞ –≤—ã—Ö–æ–¥–µ). –í–µ–∫—Ç–æ—Ä –≤—Å–µ—Ö –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–∞ —à–∞–≥–µ $t+1$ –µ—Å—Ç—å $z^{t+1} = (z_1^{t+1}, \dots, z_D^{t+1}) \in \mathbb{R}^D$ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –±–ª–æ–∫—É **4** –Ω–∞ —Ä–∏—Å. 1).

–ö–∞–∂–¥–∞—è —Ç–∞–∫–∞—è –º–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ–Ω–∞ ‚Äì –Ω–µ–±–æ–ª—å—à–æ–π MLP, –∏–º–µ—é—â–∏–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –≤–µ—Å–æ–≤ $\theta_d$ (–Ω–µ —Ä–∞–∑–¥–µ–ª—è–µ–º—ã—Ö —Å –¥—Ä—É–≥–∏–º–∏ –Ω–µ–π—Ä–æ–Ω–∞–º–∏). **–ù–µ–π—Ä–æ–Ω–Ω—ã–π —Ç–∞–π–º–∏–Ω–≥** –∏ –¥–∏–Ω–∞–º–∏–∫–∞ –¥–æ—Å—Ç–∏–≥–∞—é—Ç—Å—è —Ç–µ–º, —á—Ç–æ $g_{\theta_d}$ –º–æ–∂–µ—Ç –≤—ã—É—á–∏–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–≤–æ–∏—Ö –≤—Ö–æ–¥–æ–≤ $A^t_d$. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–π—Ä–æ–Ω –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ–≥–æ –≤—Ö–æ–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∞–±–ª–æ–Ω (–≤—Å–ø–ª–µ—Å–∫, –∑–∞—Ç—É—Ö–∞–Ω–∏–µ, –æ—Å—Ü–∏–ª–ª—è—Ü–∏—é –∏ —Ç.–¥.), —á–µ–≥–æ –Ω–µ —Å–ø–æ—Å–æ–±–µ–Ω —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π ReLU, –∏–≥–Ω–æ—Ä–∏—Ä—É—é—â–∏–π –ø—Ä–æ—à–ª–æ–µ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω –≤ CTM ‚Äì —ç—Ç–æ –Ω–µ–±–æ–ª—å—à–æ–π *–∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å –≤–æ –≤—Ä–µ–º–µ–Ω–∏*, –ø–æ–¥–æ–±–Ω–æ —É–ø—Ä–æ—â—ë–Ω–Ω–æ–º—É –∞–Ω–∞–ª–æ–≥—É –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å—É–º–º–æ–π –∏ –∑–∞–¥–µ—Ä–∂–∫–æ–π. –í–º–µ—Å—Ç–µ —Å —Ç–µ–º, —É—Ä–æ–≤–µ–Ω—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—Å–æ–∫ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏, —Ç.–∫. $M$ –æ–±—ã—á–Ω–æ –Ω–µ–≤–µ–ª–∏–∫, –∏ NLM ‚Äì —ç—Ç–æ –Ω–µ–±–æ–ª—å—à–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å. –í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ NLM –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç—Ä–æ–µ–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–µ—Ç–∏, –¥–µ–π—Å—Ç–≤—É—é—â–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –Ω–∞ –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω.

–ü–æ—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è $z^{t+1}$ –≤—Å–µ –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è —Å (–≤–Ω–µ—à–Ω–∏–º) –≤—ã—Ö–æ–¥–æ–º –≤–Ω–∏–º–∞–Ω–∏—è $o^t$ –∏ –ø–æ–¥–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫—É—é –º–æ–¥–µ–ª—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —Ç–∞–∫—Ç–µ, –∑–∞–º—ã–∫–∞—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–π —Ü–∏–∫–ª. –≠—Ç–∞ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è –ø–µ—Ç–ª—è –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ç–∏**, —Ç–æ –µ—Å—Ç—å –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –º–Ω–æ–≥–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–µ –Ω–∞–¥ –≤—Ö–æ–¥–æ–º.

### **6. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤**

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç–∏–∫–∞ $t$ CTM –æ–±–Ω–æ–≤–ª—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–æ–≤, –Ω–æ –∏ *—Å–≤–æ—ë –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –≤–Ω–µ—à–Ω–µ–º –º–∏—Ä–µ* —Å —É—á—ë—Ç–æ–º **–¥–∏–Ω–∞–º–∏–∫–∏ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏**. –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è ‚Äì –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å *—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é* –º–µ–∂–¥—É –Ω–µ–π—Ä–æ–Ω–∞–º–∏ –∫–∞–∫ –ø—Ä–∏–∑–Ω–∞–∫ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π.

**–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –∑–¥–µ—Å—å –æ–∑–Ω–∞—á–∞–µ—Ç —Å—Ç–µ–ø–µ–Ω—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∫–æ–ª–µ–±–∞–Ω–∏–π –≤ –∞–∫—Ç–∏–≤–∞—Ü–∏—è—Ö —Ä–∞–∑–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤. –î–ª—è –µ—ë –≤—ã—á–∏—Å–ª–µ–Ω–∏—è CTM —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –ø–æ—Å—Ç-–∞–∫—Ç–∏–≤–∞—Ü–∏–π *–∑–∞ –≤–µ—Å—å –ø—Ä–æ—à–µ–¥—à–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å*:

$$
Z^t \;=\; [\,z^1,\; z^2,\; \dots,\; z^t\,] \;\in\; \mathbb{R}^{D\times t}\,,
$$

–≥–¥–µ —Å—Ç–æ–ª–±—Ü—ã –º–∞—Ç—Ä–∏—Ü—ã ‚Äî —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –æ—Ç $1$ –¥–æ $t$. –≠—Ç–∞ –∏—Å—Ç–æ—Ä–∏—è $Z^t$ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞—Å—Ç—ë—Ç –ø–æ –º–µ—Ä–µ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ (—Ä–∞–∑–º–µ—Ä –≤—Ç–æ—Ä–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ä–∞–≤–µ–Ω —Ç–µ–∫—É—â–µ–º—É $t$).

**–ú–∞—Ç—Ä–∏—Ü–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** $S^t \in \mathbb{R}^{D\times D}$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –º–∞—Ç—Ä–∏—Ü–∞ —Å–∫–∞–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –≤—Å–µ—Ö –ø–∞—Ä –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–µ–π—Ä–æ–Ω–æ–≤:

$$
S^t \;=\; Z^t \cdot (Z^t)^\top \,.
$$

–≠–ª–µ–º–µ–Ω—Ç $S^t_{ij}$ —Ä–∞–≤–µ–Ω $\langle Z^t_{i,\cdot},\, Z^t_{j,\cdot}\rangle$, —Ç–æ –µ—Å—Ç—å —Å–∫–∞–ª—è—Ä–Ω–æ–º—É –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é –º–µ–∂–¥—É –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–π –Ω–µ–π—Ä–æ–Ω–∞ $i$ –∏ –Ω–µ–π—Ä–æ–Ω–∞ $j$ (–æ—Ç —à–∞–≥–∞ 1 –¥–æ $t$). –≠—Ç–∞ –≤–µ–ª–∏—á–∏–Ω–∞ –±—É–¥–µ—Ç –≤—ã—Å–æ–∫–æ–π, –µ—Å–ª–∏ –¥–≤–∞ –Ω–µ–π—Ä–æ–Ω–∞ –ø—Ä–æ—è–≤–ª—è–ª–∏ —Å—Ö–æ–¥–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ –∑–∞—Ç—É—Ö–∞–ª–∏), –∏ –Ω–∏–∑–∫–æ–π ‚Äî –µ—Å–ª–∏ –∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω—ã –º–∞–ª–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç –∏–ª–∏ —Å–¥–≤–∏–Ω—É—Ç—ã –≤–æ –≤—Ä–µ–º–µ–Ω–∏.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, $S^t$ –∫–æ–¥–∏—Ä—É–µ—Ç **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –Ω–µ–π—Ä–æ–Ω–æ–≤** –∫–∞–∫ –ø—Ä–∏–∑–Ω–∞–∫.

–û–¥–Ω–∞–∫–æ –ø–æ–ª–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $S^t$ –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä $D \times D$ (—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è, –±–µ–∑ —É—á—ë—Ç–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ ‚Äî $\frac{D(D-1)}{2}$ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Ä), —á—Ç–æ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–µ–π—Ä–æ–Ω–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ $D = 512$, —á–∏—Å–ª–æ –ø–∞—Ä —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–∫–æ–ª–æ 130 —Ç—ã—Å—è—á.

–ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º, –∞–≤—Ç–æ—Ä—ã –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –≤–∑—è—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ $S^t$ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –û–Ω–∏ –≤—ã–±–∏—Ä–∞—é—Ç –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ –ø–∞—Ä –∏–Ω–¥–µ–∫—Å–æ–≤ $(i,j)$ –∑–∞—Ä–∞–Ω–µ–µ, —Ä–∞–∑–º–µ—Ä–æ–º $D_{\text{out}}$ –∏ $D_{\text{action}}$ –∫–∞–∂–¥—ã–π. –ü–µ—Ä–≤—ã–π –Ω–∞–±–æ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∞–º –¥–ª—è **–≤—ã—Ö–æ–¥–∞ –º–æ–¥–µ–ª–∏**, –≤—Ç–æ—Ä–æ–π ‚Äî –¥–ª—è **–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤—Ö–æ–¥–æ–º**.

–¢–æ –µ—Å—Ç—å, –∏–∑ –≤—Å–µ–π –º–∞—Ç—Ä–∏—Ü—ã $S^t$ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è $D_{\text{out}} + D_{\text{action}}$ –∑–Ω–∞—á–µ–Ω–∏–π, –æ–±—Ä–∞–∑—É—é—â–∏—Ö –¥–≤–∞ –≤–µ–∫—Ç–æ—Ä–∞:

- $S_{\text{out}}^t \in \mathbb{R}^{D_{\text{out}}}$ ‚Äî –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—ã—Ö–æ–¥–∞,
- $S_{\text{action}}^t \in \mathbb{R}^{D_{\text{action}}}$ ‚Äî –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω–∏–º–∞–Ω–∏—è).

–≠—Ç–∏ –≤–µ–∫—Ç–æ—Ä—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π **—Å–∂–∞—Ç–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤**, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –¥–∞–ª–µ–µ –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ $S^t$. –í –≤—ã–±–æ—Ä–µ –ø–∞—Ä –Ω–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ ‚Äî –æ–Ω–∏ –∑–∞–¥–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏, –∞ –æ–±—É—á–µ–Ω–∏–µ —Å–∞–º–æ –Ω–∞–π–¥—ë—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã.

–ó–∞–º–µ—Ç—å—Ç–µ: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Ä–∞—Å—Ç—ë—Ç –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —á–∏—Å–ª–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤ ($\sim D^2/2$), —á—Ç–æ –¥–∞—ë—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –±–µ–∑ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∏—Å–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ (–≤–µ–¥—å –≤–µ—Å–æ–≤—ã–µ –º–∞—Ç—Ä–∏—Ü—ã $W_{\text{out}}, W_{\text{in}}$ –ø—Ä–æ–µ—Ü–∏—Ä—É—é—Ç –≤ —ç—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏). –ê–≤—Ç–æ—Ä—ã –æ—Ç–º–µ—á–∞—é—Ç, —á—Ç–æ —ç—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—É—Ç—å –∫ –±–æ–ª–µ–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ —à–∏—Ä–∏–Ω—ã –º–æ–¥–µ–ª–∏.

–î–≤–∞ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –≤—ã—Ö–æ–¥—ã –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ –æ–±—É—á–∞–µ–º—ã–µ **–ª–∏–Ω–µ–π–Ω—ã–µ —Å–ª–æ–∏** (–º–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤): $W_{\text{out}}$ –∏ $W_{\text{in}}$. –ü—Ä–æ–µ–∫—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ-–≤–µ–∫—Ç–æ—Ä–∞ –Ω–∞ –≤—ã—Ö–æ–¥ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∫–∞–∫:

$$
y^t \;=\; W_{\text{out}} \, S_{\text{out}}^t\,,
$$

–≥–¥–µ $y^t$ ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä –º–æ–¥–µ–ª–∏ –Ω–∞ —à–∞–≥–µ $t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ç—ã –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º).

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –¥—Ä—É–≥–æ–π –ø—Ä–æ–µ–∫—Ü–∏–µ–π –ø–æ–ª—É—á–∞—é—Ç –≤–µ–∫—Ç–æ—Ä –¥–ª—è *–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏*. –ï–≥–æ –º–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ ¬´–Ω–∞–º–µ—Ä–µ–Ω–∏–µ¬ª –º–æ–¥–µ–ª–∏ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –≤—Ö–æ–¥—É. –í CTM –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ **–∑–∞–ø—Ä–æ—Å –≤–Ω–∏–º–∞–Ω–∏—è** (*attention query*) –∫ –≤–Ω–µ—à–Ω–∏–º –¥–∞–Ω–Ω—ã–º:

$$
q^t \;=\; W_{\text{in}} \, S_{\text{action}}^t\,.
$$

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å $q^t$ —Å–ª—É–∂–∏—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –º–µ—Ö–∞–Ω–∏–∑–º–∞ **–∫—Ä–æ—Å—Å-–≤–Ω–∏–º–∞–Ω–∏—è**. –¢–æ –µ—Å—Ç—å CTM —Ä–µ—à–∞–µ—Ç, –Ω–∞ —á—Ç–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, *–Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–≤–æ–∏—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤*.

–í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–¥—É–ª—å –≤–Ω–∏–º–∞–Ω–∏—è: $q^t$ ‚Äî –∑–∞–ø—Ä–æ—Å, –∞ *–∫–ª—é—á–∏* $K$ –∏ *–∑–Ω–∞—á–µ–Ω–∏—è* $V$ –ø–æ–ª—É—á–∞—é—Ç—Å—è –ø—É—Ç—ë–º –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤–æ–π —ç–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ResNet –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π). –¢–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è **–≤—ã—Ö–æ–¥ –≤–Ω–∏–º–∞–Ω–∏—è** $o^t$:

$$
o^t \;=\; \text{Attention}\!\big(Q = q^t,\; K=F(x),\; V=F(x)\big)\,,
$$

–≥–¥–µ $F(x)$ ‚Äî –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö $x$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—å–Ω–æ–≥–æ —É—á–∞—Å—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è).

–í—ã—Ö–æ–¥ –≤–Ω–∏–º–∞–Ω–∏—è $o^t$ ‚Äî —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã (–æ–±—ã—á–Ω–æ —Ä–∞–≤–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ $z^t$), —Å–æ–¥–µ—Ä–∂–∞—â–∏–π ‚Äú–≤—Ä–µ–∑–∞–Ω–Ω—É—é‚Äù –∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é —Ç–µ–∫—É—â–µ–º—É –∑–∞–ø—Ä–æ—Å—É $q^t$. –í –ø—Ä–æ—Å—Ç–µ–π—à–µ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å $o^t$ –∫–∞–∫ –≤–∑–≤–µ—à–µ–Ω–Ω—É—é —Å—É–º–º—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Ö–æ–¥–∞, –≥–¥–µ –≤–µ—Å–∞ ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤–Ω–∏–º–∞–Ω–∏—è, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç $q^t$.

–≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä $o^t$ –∑–∞—Ç–µ–º, –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ, **–ø–æ–¥–∞—ë—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å–∏–Ω–∞–ø—Ç–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ** (–∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—è—Å—å —Å $z^t$).

–¢–µ–º —Å–∞–º—ã–º, CTM –Ω–∞ –∫–∞–∂–¥–æ–º —Ç–∏–∫–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–æ—ë –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ($z$) *–∏* –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç —Å–≤–æ—ë –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ($o$) –ø–æ–¥ —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ –º–æ–∑–≥ –º–æ–∂–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å, –Ω–∞ —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∏–ª–∏ –¥—É–º–∞—Ç—å –¥–∞–ª—å—à–µ.

–í —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏, –æ–ø–∏—Å–∞–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **–¥–∏–Ω–∞–º–∏–∫—É –º–æ–¥–µ–ª–∏ CTM**. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ CTM –º–æ–∂–µ—Ç –Ω–µ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ $T$ —à–∞–≥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ ‚Äî –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º —Å–º. –≤ —Ä–∞–∑–¥–µ–ª–µ –æ –º–µ—Ö–∞–Ω–∏–∑–º–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ—Å—Ç–∞–Ω–æ–≤–∞.

–û–±—Ä–∞—Ç–∏–º –≤–Ω–∏–º–∞–Ω–∏–µ: **CTM –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ –æ—Å–æ–±—ã–π –≤–∏–¥ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏**. –í–µ–∫—Ç–æ—Ä $z^t$ –∏–≥—Ä–∞–µ—Ç —Ä–æ–ª—å —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –≤–æ –≤—Ä–µ–º–µ–Ω–∏, –∞ —á–µ—Ä–µ–∑ $y^t$ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –û–¥–Ω–∞–∫–æ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö RNN, –∑–¥–µ—Å—å —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–ª–æ–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º: —Å —É—á–∞—Å—Ç–∏–µ–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö –¥–∏–Ω–∞–º–∏–∫ (NLM) –∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ cross-attention –∫ –≤–Ω–µ—à–Ω–∏–º –¥–∞–Ω–Ω—ã–º.

**"–ú—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å" CTM** ‚Äî —ç—Ç–æ —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (—á–µ—Ä–µ–∑ $f_{\text{syn}}$ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é) –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (—á–µ—Ä–µ–∑ $q^t$ –∏ $o^t$). –¢–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –±–æ–≥–∞—Ç–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã, –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –ª–∞–±–∏—Ä–∏–Ω—Ç–æ–≤ CTM –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ "—Ä–∏—Å—É–µ—Ç" –ø—É—Ç—å –≤ –ª–∞–±–∏—Ä–∏–Ω—Ç–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è.

### **7. –§–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å**

**–û–±—É—á–µ–Ω–∏–µ CTM** –æ—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –º–æ–¥–µ–ª—å –≤—ã–¥–∞—ë—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —à–∞–≥–µ. –í–æ–∑–Ω–∏–∫–∞–µ—Ç –≤–æ–ø—Ä–æ—Å: –∫–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç—å –æ—à–∏–±–∫—É –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤–µ—Å–∞, —É—á–∏—Ç—ã–≤–∞—è –≤—Å—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É?

–ê–≤—Ç–æ—Ä—ã –≤–≤–æ–¥—è—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, —Å—Ç–∏–º—É–ª–∏—Ä—É—é—â—É—é –º–æ–¥–µ–ª—å —É—á–∏—Ç—å—Å—è —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ (–∑–∞ –º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ —Ç–∏–∫–æ–≤), –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å—é –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö.

–ü—É—Å—Ç—å $y^t$ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —à–∞–≥–µ $t$ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –∫–ª–∞—Å—Å–∞–º), –∞ $y_{\text{true}}$ ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–∫–∞ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å $L^t$, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏—é –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

$$
L^t = \text{CrossEntropy}(y^t,\; y_{\text{true}})\,.
$$

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–º–µ—Ä–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏** –º–æ–¥–µ–ª–∏ –Ω–∞ —à–∞–≥–µ $t$. –ê–≤—Ç–æ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ—Å—Ç—É—é –º–µ—Ç—Ä–∏–∫—É —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ $C^t = 1 - H^t$, –≥–¥–µ $H^t$ ‚Äî –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è $y^t$. –ó–Ω–∞—á–µ–Ω–∏–µ $C^t$ –±–ª–∏–∑–∫–æ –∫ 1, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å —É–≤–µ—Ä–µ–Ω–∞ (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ $y^t$ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–æ –Ω–∞ –æ–¥–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ), –∏ –±–ª–∏–∑–∫–æ –∫ 0, –∫–æ–≥–¥–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–æ—Å–∫–æ–µ (–Ω–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å).

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $t$ –∏–º–µ–µ–º –ø–∞—Ä—É $(L^t, C^t)$.

–ß—Ç–æ–±—ã —Å–≤–µ—Å—Ç–∏ —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∫ –µ–¥–∏–Ω–æ–º—É —Å–∫–∞–ª—è—Ä–Ω–æ–º—É –ª–æ—Å—Å—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –¥–≤–∞ –æ—Å–æ–±—ã—Ö –º–æ–º–µ–Ω—Ç–∞ –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –¥–∏–Ω–∞–º–∏–∫–µ:

- $t_1$ ‚Äî —à–∞–≥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–∏:  
  $$
  t_1 = \arg\min_{t} L^t
  $$  
  –≠—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–∏–∫, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º–æ–¥–µ–ª—å –Ω–∞–∏–±–æ–ª–µ–µ –±–ª–∏–∑–∫–æ –ø–æ–¥–æ—à–ª–∞ –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –æ—Ç–≤–µ—Ç—É (–≤–æ–∑–º–æ–∂–Ω–æ, –≤–ø–µ—Ä–≤—ã–µ —É–≥–∞–¥–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ).

- $t_2$ ‚Äî —à–∞–≥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:  
  $$
  t_2 = \arg\max_{t} C^t
  $$  
  –≠—Ç–æ—Ç —Ç–∏–∫ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –Ω–∞–∏–±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–∞ –≤ —Å–≤–æ—ë–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏.

–ò—Ç–æ–≥–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –Ω–∞ —ç—Ç–∏—Ö –¥–≤—É—Ö —à–∞–≥–∞—Ö, –ø—Ä–∏—á—ë–º —à–∞–≥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å —É–¥–≤–æ–µ–Ω–Ω—ã–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º:

$$
L_{\text{final}} = 2 \cdot L^{t_1} + L^{t_2}\,.
$$

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

- –£–ª—É—á—à–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å *–≤–ø–µ—Ä–≤—ã–µ* –ø–æ–ª—É—á–∞–µ—Ç —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ($L^{t_1}$),
- –ü–æ–≤—ã—à–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –∫–æ–≥–¥–∞ –æ–Ω–∞ —É–∂–µ —Å—á–∏—Ç–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º ($L^{t_2}$).

–≠—Ç–∞ —Å—Ö–µ–º–∞ –æ–±–ª–∞–¥–∞–µ—Ç —Ä—è–¥–æ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤:

1. –ú–æ–¥–µ–ª—å –Ω–µ –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —à–∞–≥ $T$: –µ–π –≤—ã–≥–æ–¥–Ω–æ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É —Ä–∞–Ω—å—à–µ, –µ—Å–ª–∏ –º–æ–∂–µ—Ç (–∏–Ω–∞—á–µ $L^{t_1}$ –±—É–¥–µ—Ç –≤–µ–ª–∏–∫ –∏ –¥–∞—Å—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥).
2. –ï—Å–ª–∏ –Ω–∞ –∫–∞–∫–æ–º-—Ç–æ —à–∞–≥–µ –º–æ–¥–µ–ª—å —É–∂–µ —É–≤–µ—Ä–µ–Ω–Ω–æ –ø—Ä–∞–≤–∞, –æ—à–∏–±–∫–∞ –Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ –æ—á–µ–Ω—å –º–∞–ª–∞, –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ª–æ—Å—Å —Ç–æ–∂–µ —Å–Ω–∏–∂–∞–µ—Ç—Å—è ‚Äî —Ç–æ –µ—Å—Ç—å –º–æ–¥–µ–ª—å –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–∞–µ—Ç—Å—è –∑–∞ *—Ä–∞–Ω–Ω–µ–µ —É–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ*.
3. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —Å–ª–æ–∂–Ω–∞—è –∏ —Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ—Ö $T$ —à–∞–≥–æ–≤ —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è, –º–æ–¥–µ–ª—å –≤—Å—ë —Ä–∞–≤–Ω–æ –º–æ–∂–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å–Ω–∏–∂–∞—Ç—å –æ—à–∏–±–∫—É –∫ –∫–æ–Ω—Ü—É –∏ –ø–æ–≤—ã—à–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å. –¢–æ–≥–¥–∞ –æ–±–∞ —Ç–µ—Ä–º–∏–Ω–∞ $t_1$ –∏ $t_2$ —Å–æ–≤–ø–∞–¥—É—Ç —Å $T$, –∏ —à—Ç—Ä–∞—Ñ –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω $2L^T + L^T = 3L^T$. –≠—Ç–æ —Å—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å —É–ª—É—á—à–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —à–∞–≥–µ, –Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å —É—Å–ø–µ—Ö –Ω–∞ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏–µ —à–∞–≥–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç—Ä–æ–µ–Ω–∏—è –æ—à–∏–±–∫–∏ –Ω–∞ –∫–æ–Ω—Ü–µ.

### **8. –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è**

–≠—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—É—á–µ–Ω–∏—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π**:

- –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã –º–æ–¥–µ–ª—å –Ω–∞—É—á–∞–µ—Ç—Å—è —Ä–µ—à–∞—Ç—å –∑–∞ –º–∞–ª–æ–µ —á–∏—Å–ª–æ —Ç–∏–∫–æ–≤, –≤–µ–¥—å –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –Ω–∏–∑–∫–∏–π $L^t$ –∏ –≤—ã—Å–æ–∫–∏–π $C^t$ –∑–∞–¥–æ–ª–≥–æ –¥–æ $T$.
- –°–ª–æ–∂–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —à–∞–≥–æ–≤, –∏ –º–æ–¥–µ–ª—å –≤—ã–Ω—É–∂–¥–µ–Ω–Ω–æ ¬´–¥—É–º–∞–µ—Ç –¥–æ–ª—å—à–µ¬ª.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ CTM –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å **Adaptive Compute**: –æ–Ω–∞ —Å–∞–º–∞ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç, —Å–∫–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤.

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ CTM –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø–æ—Ä–æ–≥ –ø–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–∏–∫–ª, –∫–∞–∫ —Ç–æ–ª—å–∫–æ $C^t$ –ø—Ä–µ–≤—ã—Å–∏–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä, 0.8 –∏–ª–∏ 0.9. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:

- –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–º –ø–æ—Ä–æ–≥–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å) –º–æ–¥–µ–ª—å –∑–∞—á–∞—Å—Ç—É—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ —à–∞–≥–æ–≤.
- –ü—Ä–∏ –Ω–∏–∑–∫–æ–º –ø–æ—Ä–æ–≥–µ ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ.
- –ò –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, **–º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –æ–± –æ—Å—Ç–∞–Ω–æ–≤–µ** —É CTM –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –µ—ë —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏. –≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ç–æ, –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –æ–±–¥—É–º—ã–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏, –∫–æ–≥–¥–∞ —É–≤–µ—Ä–µ–Ω –≤ —Ä–µ—à–µ–Ω–∏–∏.

–í —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö –Ω–∞ ImageNet –∞–≤—Ç–æ—Ä—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç, —á—Ç–æ CTM –ø—Ä–∏ –ø–æ—Ä–æ–≥–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ 0.9 –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –ø–æ—á—Ç–∏ —Ç–æ–π –∂–µ —Ç–æ—á–Ω–æ—Å—Ç–∏, —á—Ç–æ –∏ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ —à–∞–≥–æ–≤, –Ω–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º–µ–Ω—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –∫–ª–∞—Å—Å–∞—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ CTM —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É—á–∏—Ç—Å—è –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—å "–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã" —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ, –∏ –Ω–∞–ø—Ä–æ—Ç–∏–≤, –∑–∞–¥–µ–π—Å—Ç–≤—É–µ—Ç –±–æ–ª—å—à–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è —Ç—Ä—É–¥–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏

–°—Ç–æ–∏—Ç –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å, —á—Ç–æ –≤—ã—à–µ–æ–ø–∏—Å–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî –ª–∏—à—å –æ–¥–∏–Ω –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏, –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –≤—ã—Ö–æ–¥–µ $y^T$, –ª–∏–±–æ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤—Å–µ—Ö —à–∞–≥–æ–≤. –û–¥–Ω–∞–∫–æ:

- –ü–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∏–≤—ë–ª –±—ã –∫ —Ç–æ–º—É, —á—Ç–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —à–∞–≥–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ—É—á–µ–Ω—ã–º–∏ (–º–æ–¥–µ–ª—å –º–æ–≥–ª–∞ –±—ã –ø—Ä–æ—Å—Ç–æ "–∂–¥–∞—Ç—å" –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞, —á—Ç–æ–±—ã –≤—ã–¥–∞—Ç—å –æ—Ç–≤–µ—Ç).
- –í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç (—É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º $t$) –º–æ–≥ –±—ã –º–µ—à–∞—Ç—å –º–æ–¥–µ–ª–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–Ω–Ω–∏–µ vs –ø–æ–∑–¥–Ω–∏–µ —à–∞–≥–∏.

–í—ã–±—Ä–∞–Ω–Ω–∞—è –∂–µ —Å—Ö–µ–º–∞ —Å $t_1$ –∏ $t_2$ –¥–∞—ë—Ç —Å–≤–æ–µ–æ–±—Ä–∞–∑–Ω—ã–π **self-curriculum**:

- –ú–æ–¥–µ–ª—å —Å–Ω–∞—á–∞–ª–∞ —É—á–∏—Ç—Å—è —Ö–æ—Ç—è –±—ã –∫ –∫–æ–Ω—Ü—É —Å–µ—Ä–∏–∏ —Ç–∏–∫–æ–≤ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É,
- –ó–∞—Ç–µ–º —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –¥–æ—Å—Ç–∏—á—å —ç—Ç–æ–≥–æ —Ä–∞–Ω—å—à–µ, –ø–æ–≤—ã—à–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —É–º–µ–Ω—å—à–∞—è –ª–æ—Å—Å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —à–∞–≥–æ–≤.
- –≠—Ç–æ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–≤–∏–∂–µ—Ç —Ä–µ—à–µ–Ω–∏–µ ¬´–≤–ª–µ–≤–æ¬ª –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ –Ω–µ —Å—Ç—Ä–æ–≥–∏–º –ø—Ä–∏–Ω—É–∂–¥–µ–Ω–∏–µ–º, –∞ –º—è–≥–∫–æ ‚Äî –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –≤—Ä–µ–º—è CTM —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º:

> *–†–∞–Ω–Ω–∏–µ —Ç–∏–∫–∏ —É—á–∞—Ç—Å—è —Ä–µ—à–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∑–∞–¥–∞—á–∏, –ø–æ–∑–¥–Ω–∏–µ ‚Äî –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ, –ª–∏–±–æ –¥–æ–≤–æ–¥–∏—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–æ –Ω—É–∂–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è.*

---

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Continuous Thought Machine –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç –≤–∞–∂–Ω—ã–π —à–∞–≥ –∫ —Å–±–ª–∏–∂–µ–Ω–∏—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π. –ï–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –º—ã—à–ª–µ–Ω–∏—é, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–º—É –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤ –∏ —è–≤–Ω–æ–º –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –ò–ò. –û–¥–Ω–∞–∫–æ, –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –µ–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.


**–ß—Ç–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å:**

- **–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω–æ—Å—Ç—å** - CTM —è–≤–Ω–æ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –≤–∞–∂–Ω—ã–µ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–∞—è –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å–ø–∞–π–∫–æ–≤–∞—è –ø–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å (STDP) –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ–π—Ä–æ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–µ –±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ–π –Ω–∞ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–æ–∑–≥.

- **–ù–æ–≤–∏–∑–Ω–∞ –ø–æ–¥—Ö–æ–¥–∞** - –≤–≤–µ–¥–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ–π—Ä–æ–Ω–æ–≤ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –≤ –æ–±–ª–∞—Å—Ç–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.


**–ß—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–º–Ω–µ–Ω–∏—è:**

- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏, –±—ã–ª–æ –±—ã –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –∫–µ–π—Å–∞—Ö.

- **–ù–µ–æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–∞—Ä –Ω–µ–π—Ä–æ–Ω–æ–≤** - –º–µ—Ç–æ–¥ –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ –ø–∞—Ä –Ω–µ–π—Ä–æ–Ω–æ–≤ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏. –°–≤—è—Ç–æ–π —Ä–∞–Ω–æ–¥–æ–º...

- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏** - –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, –∫–∞–∫ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤ –∏–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á.