# Evo-2: модель для генерации генома, которая знает все древо жизни.

![Table_1](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-10/assets/Figure_1.png)

1. **Введение и мотивация**

   Прогресс в области методов секвенирования и редактирования ДНК в течение последних десятилетий трансформировал анализ геномных данных в один из фундаментальных инструментов современной биологии. Однако для комплексного анализа последовательностей ДНК, включающего предсказание функциональных эффектов мутаций и рациональное проектирование новых биологических систем, необходимо разработать высокоэффективные методы машинного представления данных. В настоящей работе представлена модель **Evo 2** — крупномасштабная языковая модель (Large Language Model), обученная на корпусе из 9 триллионов токенов геномных последовательностей, охватывающих все домены жизни (бактерии, археи, эукариоты, вирусы бактериофагов и прочие).

   Концептуальная основа исследования заключается в применении принципов авторегрессионных языковых моделей (по аналогии с методами обработки естественного языка) к символам нуклеотидного алфавита: аденин (A), цитозин (C), гуанин (G) и тимин (T). Результаты демонстрируют, что модель Evo 2 с оптимизированной масштабной архитектурой и репрезентативным набором данных способна выявлять фундаментальные статистические закономерности в последовательностях ДНК, что позволяет эффективно решать следующие задачи: 
   - Предсказание функциональной значимости генетических вариантов (Variant Effect Prediction, VEP)
   - Генерация реалистичных геномных последовательностей с возможностью масштабирования до уровня полного генома
   - Оптимизация эпигеномных паттернов, включая моделирование локусов с повышенной доступностью хроматина

2. **Данные и процесс обучения**

   - **Корпус данных (OpenGenome2):** Фундаментальной основой для обучения модели послужил открытый репозиторий **OpenGenome2**, интегрирующий разнообразные типы последовательностей ДНК (бактериальные и эукариотические геномы, метагеномные данные, последовательности органелл, матричные РНК, некодирующие РНК и другие геномные элементы). Совокупный объем корпуса составляет более 9 триллионов нуклеотидов.

   - **Параметрическое масштабирование:** Разработаны две версии модели Evo 2, дифференцированные по количеству параметров — **7 миллиардов** и **40 миллиардов** соответственно. Архитектурная оптимизация позволила достичь возможности обработки контекстуального окна размером до **1 миллиона пар оснований** (base pairs, bp).

   - **Стратифицированная методология обучения:** 
     1. **Предварительное обучение (Pretraining):** Инициальная фаза с ограниченным контекстуальным окном (8–16 тысяч пар оснований) для идентификации локальных геномных особенностей, включая кодирующие области, регуляторные элементы и функциональные мотивы. 
     2. **Промежуточное обучение (Midtraining):** Инкрементальное расширение контекстуального окна до 1 миллиона пар оснований, обеспечивающее идентификацию дальнодействующих зависимостей и макроструктурных геномных элементов, таких как оперонная организация у бактерий или сложные интрон-экзонные архитектуры эукариотических генов.

   - **Архитектура StripedHyena 2:** В отличие от традиционных моделей на основе Transformers, архитектура Evo 2 реализована на базе оптимизированного гибридного свёрточно-аттенционного механизма **StripedHyena 2**, демонстрирующего повышенную вычислительную эффективность при масштабировании контекстуального окна.

   - **Алгоритмы коррекции репрезентативности (Repeat Down Weighting):** Имплементирована система дифференциального взвешивания повторяющихся геномных элементов (тандемных повторов, дупликаций) и интеграция филогенетических маркеров для обеспечения таксономической стратификации последовательностей при обучении модели.

**2.1. Архитектурные особенности Evo 2, методология обучения и структура датасета**

В рамках настоящего исследования разработана инновационная модель Evo 2, обеспечивающая высокоэффективное моделирование геномных последовательностей всех таксономических доменов. Схематическое представление, иллюстрируемое на **Рисунке 1**, демонстрирует интегральную архитектуру модели, стратифицированные этапы обучения и структуру используемых наборов данных.

![Table_2](https://raw.githubusercontent.com/Verbasik/Weekly-arXiv-ML-AI-Research-Review/refs/heads/develop/2025/week-10/assets/Figure_2.png)

Как показано на **Рисунке 1А**, модель Evo 2 концептуализируется как комплексная система интерпретации «нуклеотидного языка», применимая для решения задач различного масштаба: от молекулярного до организменного уровня. Архитектура модели оптимизирована для идентификации структурных особенностей кодирующих и некодирующих регионов, моделирования протеин-нуклеиновых взаимодействий, а также анализа высокоуровневых геномных и эпигеномных паттернов.

**Рисунок 1B** представляет проекцию геномных последовательностей из обучающего корпуса в двумерное пространство с использованием алгоритма UMAP. Дискретные кластеры точек соответствуют различным доменам и таксономическим группам организмов, дифференцированным по цвету в соответствии с их филогенетической классификацией. Данная визуализация наглядно демонстрирует гетерогенность обучающего корпуса и обосновывает необходимость разработки универсальной модели, способной к эффективной генерализации для всех доменов жизни.

**Рисунки 1C–D** иллюстрируют бифазную стратегию обучения: 
1. Предварительная фаза (pretraining), фокусирующаяся на локальных последовательностных закономерностях и крупных функциональных элементах.  
2. Промежуточная фаза (midtraining), характеризующаяся инкрементальным увеличением контекстуального окна до 1 миллиона пар оснований для идентификации глобальных геномных паттернов.  

В процессе обучения имплементирован комплекс специализированных методологий, включая дифференциальное взвешивание повторяющихся элементов и оптимизацию батч-распределения данных, направленных на повышение качественных характеристик обучения при работе с протяженными последовательностями и обеспечение репрезентативного покрытия различных функциональных доменов генома.

**Рисунок 1E** демонстрирует статистическое распределение токенов, использованных на каждой стадии обучения для моделей Evo 2 с 40 и 7 миллиардами параметров соответственно. Очевидно превалирование объема данных на этапе промежуточного обучения с расширенным контекстуальным окном, что обеспечивает оптимальную аппроксимацию к реальным геномным масштабам.

**Рисунок 1F** представляет схематическую визуализацию архитектуры StripedHyena 2, имплементированной в Evo 2, с тремя дифференцированными типами блоков (SE, MR и LI), структурированными для максимизации эффективности свёрточных и аттенционных операций на масштабных входных последовательностях. **Рисунок 1G** демонстрирует сравнительный анализ производительности StripedHyena 2 относительно предшествующих версий (StripedHyena 1) и классического Transformer при обучении на 1024 GPU, с очевидным превосходством новой архитектуры в аспекте вычислительной эффективности.

**Рисунок 1H** отображает результаты валидации модели при вариабельных параметрах длины контекста и масштаба (количества параметров), иллюстрируя положительную корреляцию между расширением контекстуального окна, увеличением параметрического объема модели и улучшением финальных метрик (включая снижение perplexity). В заключение, **Рисунок 1I** содержит методологическое описание модифицированной задачи «иголка в стоге сена» — специализированного теста на способность Evo 2 к извлечению релевантной информации из контекста протяженностью до 1 миллиона пар оснований. Полученные результаты подтверждают эффективную способность модели к ретенции информации в экстенсивном контексте, что является критически важным параметром при работе с полногеномными последовательностями.

Таким образом, схематическое представление на **Рисунке 1** интегрирует ключевые аспекты архитектуры, структуры данных и методологии обучения Evo 2, демонстрируя универсальную применимость модели на всех уровнях биологической организации — от индивидуальных генов до полногеномных последовательностей.

3. **Предсказание эффектов мутаций (Variant Effect Prediction, VEP)**

   Одной из фундаментальных задач современной геномики является прогнозирование функциональных последствий (патогенных или нейтральных) генетических вариаций. Модель Evo 2 реализует подход без предварительного дообучения (zero-shot), основанный на количественной оценке отношения правдоподобия между мутантной и референсной последовательностями:

   - **Анализ патогенных вариантов ClinVar:** Модель демонстрирует превосходную точность в идентификации патогенности мутаций, включая некодирующие варианты и структурные перестройки (инсерции/делеции), превосходя существующие инструменты в режиме без предварительного дообучения. Для специализированных аналитических задач авторы также разработали компактные классификаторы на основе векторных представлений Evo 2, достигающие передовых результатов в прогнозировании вариантов генов BRCA1 и BRCA2, ассоциированных с онкологическими заболеваниями.

   - **Анализ вариаций сплайсинга (SpliceVarDB):** Модель Evo 2 эффективно дифференцирует варианты, нарушающие процесс сплайсинга, в экзонных и интронных областях. Примечательно, что в отличие от традиционных методов предсказания эффектов вариантов, Evo 2 не требует множественных выравниваний последовательностей, но при этом обеспечивает высокую прогностическую точность.

   - **Анализ некодирующих регионов:** В дополнение к однонуклеотидным вариантам (SNV) в белок-кодирующих последовательностях, модель демонстрирует высокую эффективность в прогнозировании патогенности вариантов в некодирующих и сплайс-регуляторных элементах, а также в других функциональных геномных компонентах.

4. **Генерация геномных последовательностей**

   В отличие от узкоспециализированных аналитических инструментов, Evo 2 представляет собой **генеративную** модель, функционирующую на основе авторегрессионного принципа формирования нуклеотидных последовательностей. Экспериментальная валидация модели включала генерацию нескольких типов геномных последовательностей:

   - **Митохондриальные геномы человека:** Генерация полномасштабных последовательностей протяженностью приблизительно 16 тысяч пар оснований, с корректной реконструкцией функциональных элементов, включая транспортные РНК (tRNA), рибосомальные РНК (rRNA) и консервативные белок-кодирующие гены. Сгенерированные последовательности демонстрируют высокую степень консервации геномной организации (синтении) при одновременной вариабельности на уровне аминокислотных последовательностей.

   - **Геном модельного микроорганизма Mycoplasma genitalium:** Благодаря расширенному контекстуальному окну (до 1 миллиона пар оснований) модель Evo 2 способна экстраполировать и реконструировать протяженные последовательности (порядка 580 тысяч пар оснований). Сгенерированные геномные последовательности характеризуются сохранением структурной гомологии с известными белковыми доменами (подтверждено анализом с использованием базы данных Pfam) при одновременной дивергенции на уровне первичной структуры, что открывает потенциальные возможности для идентификации новых функциональных вариантов белков.

   - **Хромосомы дрожжей Saccharomyces cerevisiae:** Продемонстрирована успешная генерация протяженных геномных фрагментов порядка сотен тысяч пар оснований, с корректной реконструкцией функциональных элементов, включая транспортные РНК, интрон-экзонные структуры и регуляторные промоторные области.

5. **Оптимизация эпигеномных паттернов**

   К категории более сложных аналитических задач относится генерация последовательностей, соответствующих заданным критериям по эпигеномным характеристикам, в частности, локальной доступности хроматина. Для реализации данного подхода авторы имплементировали методологию поиска в процессе инференса (**inference-time search**):

   - **Интеграция предикторных моделей (Enformer, Borzoi):** Данные вспомогательные модели осуществляют количественное прогнозирование степени доступности хроматина (открытой конформации) для связывания регуляторных факторов в специфических клеточных типах на основе нуклеотидной последовательности. 

   - **Алгоритм лучевого поиска (beam search):** Процесс генерации осуществляется инкрементально по фрагментам длиной 128 пар оснований, при этом модель Evo 2 генерирует множественные варианты кандидатных последовательностей, а Enformer/Borzoi проводят аналитическую оценку соответствующих эпигеномных профилей. В процессе селективного отбора сохраняются только последовательности, демонстрирующие максимальную конвергенцию с заданным эталонным паттерном, что обеспечивает поэтапное формирование целевой последовательности требуемой протяженности.

   - **Экспериментальная демонстрация:** Исследователи, моделируя дифференциальные паттерны открытых и компактизированных хроматиновых регионов, продемонстрировали возможность кодирования информационных паттернов, аналогичных коду Морзе (система точек и тире), в виде дискретных эпигеномных пиков.

   Существенно отметить, что качественные характеристики генерируемых паттернов демонстрируют позитивную корреляцию с увеличением вычислительных ресурсов (расширение пула кандидатных последовательностей на каждом этапе генерации). Данный феномен иллюстрирует принцип масштабирования вычислительных ресурсов в процессе инференса (inference-time scaling) применительно к биологическим моделям.

6. **Интерпретация внутренних представлений (Sparse Autoencoders)**

   Учитывая возрастающую сложность и масштабируемость языковых моделей, авторы исследования акцентировали внимание на механистической интерпретируемости. Для этой цели были разработаны и обучены **разреженные автоэнкодеры (Sparse Autoencoders, SAE)** на основе анализа внутренних активаций Evo 2, с целью идентификации латентных признаков (features), демонстрирующих прямую корреляцию с функциональными биологическими элементами:

   - **Регуляторные элементы генной экспрессии:** Фильтры разреженных автоэнкодеров эффективно идентифицируют специфические последовательностные мотивы, включая элементы корового промотора (TATA-бокс) и сайты связывания транскрипционных факторов.

   - **Структурные элементы белков:** В активационных паттернах выявляются характерные признаки, соответствующие основным элементам вторичной структуры белков (α-спирали и β-листы).

   - **Профаговые интеграционные сайты и мобильные генетические элементы:** Модель демонстрирует способность к автоматической аннотации фаговых инсерций, сайтов CRISPR-спейсеров и других мобильных элементов без эксплицитного обучения на маркированных данных.

   - **Структурная организация генов:** Определенные латентные признаки коррелируют с экзон-интронной архитектурой, что позволяет идентифицировать структурные компоненты даже в сложноорганизованных генах высших эукариот, включая человека.

   Имплементация данных методологических подходов обеспечивает углубленное понимание биологических концептов, выявленных моделью Evo 2 в процессе обучения, и создает основу для высокоточной аннотации неизученных геномов, включая палеогеномные данные (например, геном шерстистого мамонта).

7. **Заключение и перспективы**

   Представленное исследование позиционирует модель **Evo 2** как универсальную платформу для комплексного анализа и рационального дизайна геномных последовательностей. Ключевые результаты исследования могут быть суммированы следующим образом:

   - **Таксономическая универсальность:** Модель демонстрирует эффективную генерализацию на все три домена жизни, экстраполируя методологию языкового моделирования на структурно и функционально сложные эукариотические геномы.

   - **Прогнозирование эффектов вариантов без предварительного обучения (Zero-shot VEP):** Evo 2 демонстрирует превосходство над существующими алгоритмами в аспекте прогнозирования функциональных последствий некодирующих и структурных вариантов, функционируя как метод, независимый от множественных выравниваний последовательностей (alignment-free).

   - **Полногеномная генерация:** Авторы впервые продемонстрировали авторегрессионный подход к реконструкции митохондриальных, бактериальных и эукариотических геномов с интеграцией фрагментов в протяженные контексты порядка сотен тысяч пар оснований.

   - **Проектирование эпигеномных ландшафтов:** Интеграция вспомогательных предикторных моделей обеспечивает динамическую оптимизацию генерируемых последовательностей в соответствии с заданными эпигеномными паттернами.

   - **Доступность и репродуцируемость:** Репозиторий данных (OpenGenome2), программный код и параметрические модели (7 и 40 миллиардов параметров) находятся в открытом доступе, что позиционирует Evo 2 как один из наиболее масштабных открытых проектов на пересечении искусственного интеллекта и молекулярной биологии.

   Таким образом, модель **Evo 2** устанавливает новый методологический стандарт в области фундаментальных биологических моделей, демонстрируя потенциал крупномасштабных языковых моделей в эффективном анализе и моделировании нуклеотидных последовательностей с высокой степенью детализации (от мутационного анализа до геномной архитектуры) на уровне целых хромосом. Перспективные направления развития включают оптимизацию методологий управления инференсом (inference-time steering), интеграцию пространственных 3D-структур хроматина и синергию с экспериментальными методами геномного редактирования, что создаст основу для трансляции парадигмы генеративной биологии в практические приложения — от молекулярной диагностики до синтетической биологии.